import{d as ne,j as K,c as v,y as $e,g as r,_ as ie,n as J,p as de,b as G,z as Ee,i as Ve,k as ye,r as x,l as ae,m as xe,A as Le,w as Q,e as g,v as Ce,q as c,x as M,T as Pe,a as e,t as B,B as we,C as mt,s as gt,D as ht,h as Be,E as Yt,G as at,F as X,f as re,H as W,I as qt,J as Me,K as Lt,L as Te,M as Xt,N as jt,O as Ot,P as Ft,Q as Jt,R as bt,S as Pt,U as Kt,V as Zt,W as Qt,X as es,Y as Fe,Z as Ke,u as ts,$ as ss,a0 as ns,a1 as os,a2 as as,a3 as ls,a4 as De,a5 as it,a6 as rs}from"./index-BtkkAI57.js";import{S as is,_ as cs}from"./StarField-pir-WA6x.js";const us=["innerHTML"],ds=ne({__name:"Icon",props:{icon:{type:String,default:"none"},size:{type:Number,default:18}},emits:["click"],setup(s,{emit:t}){const l=s,a=K(()=>n[l.icon]),n={none:"",character:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 20a6 6 0 0 0-12 0"/><circle cx="12" cy="10" r="4"/><circle cx="12" cy="12" r="10"/></svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"/><line x1="21" y1="6" x2="3" y2="6"/><line x1="21" y1="14" x2="3" y2="14"/><line x1="21" y1="18" x2="3" y2="18"/></svg>',background:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>',sound:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 10v3M6 7v9M10 4v15M14 7v9M18 10v3"/></svg>',history:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-history-icon lucide-history"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>',box:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="5" x="2" y="4" rx="2"/><path d="M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9"/><path d="M10 13h4"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play-icon lucide-play"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-marked-icon lucide-book-marked"><path d="M10 2v8l3-3 3 3V2"/><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"/></svg>',advance:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="4" y1="21" y2="14" /><line x1="4" x2="4" y1="10" y2="3" /><line x1="12" x2="12" y1="21" y2="12" /><line x1="12" x2="12" y1="8" y2="3" /><line x1="20" x2="20" y1="21" y2="16" /><line x1="20"x2="20" y1="12" y2="3" /><line x1="2" x2="6" y1="14" y2="14" /><line x1="10" x2="14" y1="8" y2="8" /><line x1="18" x2="22" y1="16" y2="16" /></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',schedule:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list-icon lucide-clipboard-list"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/></svg>',update:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rss-icon lucide-rss"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume2-icon lucide-volume-2"><path d="M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"/><path d="M16 9a5 5 0 0 1 0 6"/><path d="M19.364 18.364a9 9 0 0 0 0-12.728"/></svg>',clothes:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2"><title>clothes</title><g id="Layer_2" data-name="Layer 2"><g id="invisible_box" data-name="invisible box"></g><g id="icons_Q2" data-name="icons Q2"><path d="M45.2,12.9,37.1,4H10.9L2.8,12.9a3,3,0,0,0,.1,4.2l7.5,7.5V44H37.7V24.6l7.5-7.5A3,3,0,0,0,45.2,12.9Zm-8.4,6.8-3.1-2.9V40H14.3V16.8l-3.1,2.9L6.4,14.9,12.7,8h7.4a4,4,0,0,0,7.8,0h7.4l6.3,6.9Z"/></g></g></svg>',achievement:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trophy"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>',hand:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hand-icon lucide-hand"><path d="M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2"/><path d="M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2"/><path d="M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8"/><path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"/></svg>',setting:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>'};return(o,u)=>(r(),v("span",{innerHTML:a.value,style:$e(`width:${s.size}px, height:${s.size}px`),onClick:u[0]||(u[0]=m=>o.$emit("click"))},null,12,us))}}),Ue=ie(ds,[["__scopeId","data-v-023d8e1e"]]),ps=["disabled"],vs=ne({__name:"Button",props:{type:{},disabled:{type:Boolean},icon:{},icon_size:{}},emits:["click"],setup(s,{emit:t}){return(l,a)=>(r(),v("button",{class:J(s.type),disabled:s.disabled,onClick:a[0]||(a[0]=n=>l.$emit("click"))},[s.icon?(r(),de(Ue,{key:0,icon:s.icon,size:s.icon_size},null,8,["icon","size"])):G("",!0),Ee(l.$slots,"default",{},void 0,!0)],10,ps))}}),te=ie(vs,[["__scopeId","data-v-5b0678a1"]]),hs={class:"flex flex-col gap-3"},fs={key:0,class:"w-[260px] bg-[#12121c]/75 backdrop-blur-[20px] border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.4)] rounded-3xl p-6 text-white flex flex-col items-center box-border"},ms={class:"relative mb-6 outline-none"},gs={class:"w-[180px] h-[180px] relative outline-none border-none"},bs={class:"w-full h-full -rotate-90 outline-none overflow-visible block",viewBox:"0 0 100 100"},ys={class:"absolute inset-0 flex flex-col items-center justify-center z-10"},xs={key:0,class:"text-base font-medium tracking-wide opacity-90 group-hover:text-[#4facfe] transition-colors"},ws={class:"text-5xl font-bold leading-none tabular-nums my-1 drop-shadow-[0_4px_12px_rgba(0,0,0,0.3)]"},_s={class:"text-[13px] text-[#4facfe] font-semibold mb-0.5"},ks={class:"text-[11px] text-white/50"},Cs={class:"flex items-center justify-between w-40 mb-6"},$s={class:"flex justify-between w-full pt-4 border-t border-white/10"},Ss={class:"flex flex-col items-center flex-1"},Ms={class:"flex items-center justify-center relative h-6"},Is={class:"flex flex-col justify-center h-full gap-[2px]"},As={class:"flex flex-col items-center flex-1"},Ts={class:"flex items-center justify-center relative h-6"},Es={class:"flex flex-col justify-center h-full gap-[2px]"},Bs={class:"flex flex-col items-center flex-1"},Vs={class:"flex items-center justify-center relative h-6"},Rs={class:"flex flex-col justify-center h-full gap-[2px]"},wt="pomodoro_enabled",_t="pomodoro_remaining_ms",kt="pomodoro_running",Ct="pomodoro_mode",$t="pomodoro_cycle_idx",St="pomodoro_cycles_total",Mt="pomodoro_work_ms",It="pomodoro_break_ms",At="pomodoro_work_label",Xe=1500*1e3,ct=300*1e3,ut=2,zs=ne({__name:"PomodoroPanel",setup(s){const t=Ve(),l=ye(),a=x(!1),n=x(!1),o=x("work"),u=x("å·¥ä½œ"),m=x(!1),w=x(""),i=x(Xe),d=x(ct),$=x(ut),I=x(1),p=x(Xe);let h=null;const f=x(25),b=x(5),T=x(2),E=K(()=>o.value==="work"?i.value:d.value),V=K(()=>Math.floor(p.value/6e4).toString().padStart(2,"0")),A=K(()=>Math.floor(p.value%6e4/1e3).toString().padStart(2,"0")),S=2*Math.PI*45,z=K(()=>{const H=Math.max(1,E.value),j=1-p.value/H;return Math.min(1,Math.max(0,j))}),C=K(()=>({strokeDasharray:`${S}`,strokeDashoffset:`${(1-z.value)*S}`,transformOrigin:"50% 50%"})),_=K(()=>!n.value&&p.value===E.value&&I.value===1&&o.value==="work"||!n.value?"ç©ºé—²ä¸­":o.value==="work"?"ä¸“æ³¨ä¸­":"ä¼‘æ¯ä¸­"),k=x([]);function y(H){return Math.max(1,Math.round(H/6e4))}function F(H){const j=(H||"").trim();if(j){if(t.currentStatus!=="input"){k.value.push(j);return}t.currentStatus="thinking",t.appendGameMessage({type:"message",displayName:t.userName,content:j}),gt.sendMessage(j)}}function ce(){if(k.value.length===0||t.currentStatus!=="input")return;const H=k.value.shift();H&&F(H)}ae(()=>t.currentStatus,H=>{H==="input"&&ce()}),ae(()=>l.showSettings,H=>{H&&(a.value=!1)});function le(){localStorage.setItem(wt,JSON.stringify(a.value)),localStorage.setItem(_t,JSON.stringify(p.value)),localStorage.setItem(kt,JSON.stringify(n.value)),localStorage.setItem(Ct,o.value),localStorage.setItem($t,JSON.stringify(I.value)),localStorage.setItem(St,JSON.stringify($.value)),localStorage.setItem(Mt,JSON.stringify(i.value)),localStorage.setItem(It,JSON.stringify(d.value)),localStorage.setItem(At,u.value)}function N(){h&&(clearInterval(h),h=null)}function ue(){o.value;const H=I.value;p.value=Math.max(0,p.value-1e3),p.value===0&&(o.value==="work"?(o.value="break",p.value=d.value,F(`{ç•ªèŒ„é’Ÿæé†’ï¼šç¬¬${H}/${$.value}è½®ä¸“æ³¨ç»“æŸï¼Œå¼€å§‹ä¼‘æ¯ ${y(d.value)} åˆ†é’Ÿã€‚}`)):I.value<$.value?(I.value+=1,o.value="work",p.value=i.value,F(`{ç•ªèŒ„é’Ÿæé†’ï¼šä¼‘æ¯ç»“æŸï¼Œå¼€å§‹ç¬¬${I.value}/${$.value}è½®ä¸“æ³¨ï¼ˆ${u.value}ï¼‰ï¼Œæ—¶é•¿ ${y(i.value)} åˆ†é’Ÿ}`)):(N(),n.value=!1,F(`{ç•ªèŒ„é’Ÿæé†’ï¼šæœ¬æ¬¡ç•ªèŒ„é’Ÿå·²å®Œæˆï¼ˆä¸“æ³¨ ${y(i.value)} åˆ†é’Ÿ + ä¼‘æ¯ ${y(d.value)} åˆ†é’Ÿ Ã— ${$.value} è½®ï¼‰ã€‚}`))),le()}function pe(){if(n.value)return;p.value<=0&&(p.value=E.value),n.value=!0,N(),h=window.setInterval(ue,1e3),le();const H=o.value==="work"?`å¼€å§‹ä¸“æ³¨ï¼ˆ${u.value}ï¼‰`:"å¼€å§‹ä¼‘æ¯";F(`{æˆ‘å¯åŠ¨äº†ç•ªèŒ„é’Ÿï¼šä¸“æ³¨ ${y(i.value)} åˆ†é’Ÿï¼Œä¼‘æ¯ ${y(d.value)} åˆ†é’Ÿï¼Œå…± ${$.value} è½®ã€‚ç°åœ¨${H}ï¼Œè¿™æ˜¯ç¬¬${I.value}/${$.value}è½®ã€‚}`)}function Y(){n.value&&(n.value=!1,N(),le())}function q(){o.value="work",I.value=1,p.value=i.value,n.value=!1,N(),le()}function fe(){a.value=!a.value}function Ie(){m.value=!0,w.value=u.value}function je(){const H=w.value.trim();u.value=H||"å·¥ä½œ",m.value=!1,le()}function Ne(){let H=f.value;(!H||H<1)&&(H=1),f.value=H,i.value=H*60*1e3,o.value==="work"&&!n.value&&(p.value=i.value),le()}function He(){let H=b.value;(!H||H<1)&&(H=1),b.value=H,d.value=H*60*1e3,o.value==="break"&&!n.value&&(p.value=d.value),le()}function We(){let H=T.value;(!H||H<1)&&(H=1),T.value=H,$.value=H,I.value>$.value&&(I.value=$.value),le()}function Ge(H){f.value+=H,Ne()}function tt(H){b.value+=H,He()}function Ye(H){T.value+=H,We()}return ae(a,H=>{H||(N(),n.value=!1),le()}),xe(()=>{try{const H=JSON.parse(localStorage.getItem(wt)||"false"),j=JSON.parse(localStorage.getItem(_t)||String(Xe)),_e=JSON.parse(localStorage.getItem(kt)||"false"),lt=localStorage.getItem(Ct)||"work",R=JSON.parse(localStorage.getItem($t)||"1"),O=JSON.parse(localStorage.getItem(St)||String(ut)),L=JSON.parse(localStorage.getItem(Mt)||String(Xe)),U=JSON.parse(localStorage.getItem(It)||String(ct)),ee=localStorage.getItem(At)||"å·¥ä½œ";a.value=!!H,i.value=Number.isFinite(L)?L:Xe,d.value=Number.isFinite(U)?U:ct,$.value=Number.isFinite(O)?O:ut,I.value=Number.isFinite(R)?R:1,o.value=lt==="break"?"break":"work",p.value=Number.isFinite(j)?j:i.value,u.value=ee||"å·¥ä½œ",n.value=!!_e&&a.value&&j>0,f.value=i.value/6e4,b.value=d.value/6e4,T.value=$.value,n.value&&(N(),h=window.setInterval(ue,1e3))}catch{}}),Le(()=>{N()}),(H,j)=>(r(),v("div",hs,[Q(g(te,{type:"nav",class:J(["flex items-center gap-2 px-4 py-2 transition-colors",a.value?"text-[#4facfe]":"text-white"]),onClick:fe},{default:M(()=>[...j[10]||(j[10]=[e("span",{class:"text-xl"},"ğŸ…",-1),e("h3",{class:"text-lg font-bold m-0"},"ç•ªèŒ„é’Ÿ",-1)])]),_:1},8,["class"]),[[Ce,!c(l).showSettings]]),g(Pe,{"enter-active-class":"transition-all duration-300 cubic-bezier(0.2, 0.8, 0.2, 1)","leave-active-class":"transition-all duration-300 cubic-bezier(0.2, 0.8, 0.2, 1)","enter-from-class":"opacity-0 -translate-y-2","leave-to-class":"opacity-0 -translate-y-2"},{default:M(()=>[a.value?(r(),v("div",fs,[e("div",ms,[e("div",gs,[(r(),v("svg",bs,[j[11]||(j[11]=e("defs",null,[e("linearGradient",{id:"gradient-ring",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#4facfe"}),e("stop",{offset:"100%","stop-color":"#00f2fe"})])],-1)),j[12]||(j[12]=e("circle",{class:"fill-none stroke-white/10 stroke-[4]",cx:"50",cy:"50",r:"45"},null,-1)),e("circle",{class:"fill-none stroke-[url(#gradient-ring)] stroke-[4] stroke-round transition-[stroke-dashoffset] duration-1000 ease-linear drop-shadow-[0_0_4px_rgba(79,172,254,0.5)]",cx:"50",cy:"50",r:"45",style:$e(C.value)},null,4)])),e("div",ys,[e("div",{class:"h-6 flex items-center justify-center mb-1 cursor-pointer group",onClick:Ie,title:"ç‚¹å‡»ä¿®æ”¹åç§°"},[m.value?Q((r(),v("input",{key:1,"onUpdate:modelValue":j[0]||(j[0]=_e=>w.value=_e),class:"w-[120px] bg-transparent border-0 border-b border-[#4facfe] text-white text-center text-base outline-none p-0 focus:ring-0",onBlur:je,onKeyup:mt(je,["enter"]),autofocus:""},null,544)),[[we,w.value]]):(r(),v("span",xs,B(u.value),1))]),e("div",ws,B(V.value)+":"+B(A.value),1),e("div",_s,B(_.value),1),e("div",ks," ç¬¬ "+B(I.value)+" / "+B($.value)+" è½® ",1)])])]),e("div",Cs,[e("div",{class:J(["w-12 h-12 rounded-full bg-white/10 flex items-center justify-center cursor-pointer transition-all duration-200 text-white hover:bg-white/20 hover:scale-105 active:scale-95",{"opacity-30 pointer-events-none bg-transparent shadow-none":n.value}]),onClick:pe,title:"å¼€å§‹"},[...j[13]||(j[13]=[e("svg",{viewBox:"0 0 24 24",width:"28",height:"28",fill:"currentColor"},[e("path",{d:"M8 5v14l11-7z"})],-1)])],2),e("div",{class:J(["w-12 h-12 rounded-full bg-white/10 flex items-center justify-center cursor-pointer transition-all duration-200 text-white hover:bg-white/20 hover:scale-105 active:scale-95",{"opacity-30 pointer-events-none bg-transparent shadow-none":!n.value}]),onClick:Y,title:"æš‚åœ"},[...j[14]||(j[14]=[e("svg",{viewBox:"0 0 24 24",width:"28",height:"28",fill:"currentColor"},[e("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})],-1)])],2),e("div",{class:"w-12 h-12 rounded-full bg-white/10 flex items-center justify-center cursor-pointer transition-all duration-200 text-white hover:bg-white/20 hover:scale-105 active:scale-95",onClick:q,title:"é‡ç½®"},[...j[15]||(j[15]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor"},[e("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})],-1)])])]),e("div",$s,[e("div",Ss,[j[19]||(j[19]=e("span",{class:"text-[11px] text-white/50 mb-1.5"},"ä¸“æ³¨",-1)),e("div",Ms,[Q(e("input",{type:"number",class:"no-spin w-8 bg-transparent border-none text-white text-right font-medium text-[15px] outline-none p-0 appearance-none","onUpdate:modelValue":j[1]||(j[1]=_e=>f.value=_e),onChange:Ne},null,544),[[we,f.value,void 0,{number:!0}]]),j[18]||(j[18]=e("span",{class:"text-[11px] text-white/50 pointer-events-none ml-0.5 mr-1"},"m",-1)),e("div",Is,[e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[2]||(j[2]=_e=>Ge(1))},[...j[16]||(j[16]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 14l5-5 5 5z"})],-1)])]),e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[3]||(j[3]=_e=>Ge(-1))},[...j[17]||(j[17]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 10l5 5 5-5z"})],-1)])])])])]),e("div",As,[j[23]||(j[23]=e("span",{class:"text-[11px] text-white/50 mb-1.5"},"ä¼‘æ¯",-1)),e("div",Ts,[Q(e("input",{type:"number",class:"no-spin w-8 bg-transparent border-none text-white text-right font-medium text-[15px] outline-none p-0 appearance-none","onUpdate:modelValue":j[4]||(j[4]=_e=>b.value=_e),onChange:He},null,544),[[we,b.value,void 0,{number:!0}]]),j[22]||(j[22]=e("span",{class:"text-[11px] text-white/50 pointer-events-none ml-0.5 mr-1"},"m",-1)),e("div",Es,[e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[5]||(j[5]=_e=>tt(1))},[...j[20]||(j[20]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 14l5-5 5 5z"})],-1)])]),e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[6]||(j[6]=_e=>tt(-1))},[...j[21]||(j[21]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 10l5 5 5-5z"})],-1)])])])])]),e("div",Bs,[j[27]||(j[27]=e("span",{class:"text-[11px] text-white/50 mb-1.5"},"å¾ªç¯",-1)),e("div",Vs,[Q(e("input",{type:"number",class:"no-spin w-8 bg-transparent border-none text-white text-right font-medium text-[15px] outline-none p-0 appearance-none","onUpdate:modelValue":j[7]||(j[7]=_e=>T.value=_e),onChange:We},null,544),[[we,T.value,void 0,{number:!0}]]),j[26]||(j[26]=e("span",{class:"text-[11px] text-white/50 pointer-events-none ml-0.5 mr-1"},"æ¬¡",-1)),e("div",Rs,[e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[8]||(j[8]=_e=>Ye(1))},[...j[24]||(j[24]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 14l5-5 5 5z"})],-1)])]),e("div",{class:"flex items-center justify-center cursor-pointer opacity-60 hover:opacity-100 h-2.5 active:scale-90 transition-transform",onClick:j[9]||(j[9]=_e=>Ye(-1))},[...j[25]||(j[25]=[e("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[e("path",{d:"M7 10l5 5 5-5z"})],-1)])])])])])])])):G("",!0)]),_:1})]))}}),Ds=ie(zs,[["__scopeId","data-v-167ab48f"]]);const Tt=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ls=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,l,a)=>a?a.toUpperCase():l.toLowerCase()),js=s=>{const t=Ls(s);return t.charAt(0).toUpperCase()+t.slice(1)},Os=(...s)=>s.filter((t,l,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===l).join(" ").trim(),Et=s=>s==="";var Je={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const Fs=({name:s,iconNode:t,absoluteStrokeWidth:l,"absolute-stroke-width":a,strokeWidth:n,"stroke-width":o,size:u=Je.width,color:m=Je.stroke,...w},{slots:i})=>ht("svg",{...Je,...w,width:u,height:u,stroke:m,"stroke-width":Et(l)||Et(a)||l===!0||a===!0?Number(n||o||Je["stroke-width"])*24/Number(u):n||o||Je["stroke-width"],class:Os("lucide",w.class,...s?[`lucide-${Tt(js(s))}-icon`,`lucide-${Tt(s)}`]:["lucide-icon"])},[...t.map(d=>ht(...d)),...i.default?[i.default()]:[]]);const he=(s,t)=>(l,{slots:a,attrs:n})=>ht(Fs,{...n,...l,iconNode:t,name:s},a);const Ps=he("arrow-big-left",[["path",{d:"M13 9a1 1 0 0 1-1-1V5.061a1 1 0 0 0-1.811-.75l-6.835 6.836a1.207 1.207 0 0 0 0 1.707l6.835 6.835a1 1 0 0 0 1.811-.75V16a1 1 0 0 1 1-1h6a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1z",key:"aztept"}]]);const Us=he("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const Ns=he("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const Hs=he("cat",[["path",{d:"M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z",key:"x6xyqk"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M11.25 16.25h1.5L12 17l-.75-.75Z",key:"12kq1m"}]]);const Ws=he("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Gs=he("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Ut=he("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const ft=he("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Ys=he("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const qs=he("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Xs=he("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Js=he("earth",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const Ks=he("folder-kanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);const Zs=he("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);const Qs=he("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);const en=he("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);const tn=he("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const sn=he("rss",[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);const nn=he("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const on=he("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);const ot=he("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const Nt=he("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);const Ht=he("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),yt=async()=>{try{return await Be.get("/v1/chat/schedule/get_schedules")}catch(s){throw console.error("è·å–æ—¥ç¨‹ä¿¡æ¯é”™è¯¯:",s.message),s}},xt=async s=>{try{await Be.post("/v1/chat/schedule/save_schedules",s)}catch(t){throw console.error("ä¿å­˜æ—¥ç¨‹ä¿¡æ¯é”™è¯¯:",t.message),t}},an={key:0,class:"fixed inset-0 z-9999 flex items-center justify-center p-4"},ln={class:"relative z-10 bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl p-8"},rn={class:"flex justify-between items-center mb-6"},cn={class:"text-xl font-black text-slate-800 tracking-tight"},un={class:"space-y-4"},dn={class:"mt-8"},Wt=ne({__name:"BaseModal",props:{show:{type:Boolean},title:{}},emits:["close","confirm"],setup(s,{emit:t}){const l=t,a=()=>{l("close")};return(n,o)=>(r(),de(Yt,{to:"body"},[g(Pe,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 scale-100","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-100"},{default:M(()=>[s.show?(r(),v("div",an,[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:a}),e("div",ln,[e("div",rn,[e("h3",cn,B(s.title),1),e("button",{onClick:a,class:"text-slate-400 hover:text-slate-600 transition-colors p-1"},[...o[1]||(o[1]=[e("span",{class:"text-2xl font-bold leading-none"},"Ã—",-1)])])]),e("div",un,[Ee(n.$slots,"default")]),e("div",dn,[e("button",{onClick:o[0]||(o[0]=u=>n.$emit("confirm")),class:"w-full py-4 bg-cyan-500 text-white font-black rounded-2xl shadow-lg hover:bg-cyan-600 active:scale-95 transition-all"}," ç¡®è®¤åˆ›å»º ")])])])):G("",!0)]),_:3})]))}}),pn={key:0,class:"space-y-8"},vn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},hn=["onClick"],fn={class:"flex items-center space-x-4"},mn={class:"w-10 h-10 bg-cyan-500 rounded-xl flex items-center justify-center text-cyan-50 group-hover:bg-cyan-50 group-hover:text-cyan-500 transition-all"},gn={class:"font-bold text-brand"},bn={class:"text-[10px] text-white uppercase font-bold"},yn={class:"space-y-4"},xn={class:"text-xs font-black text-slate-50 uppercase tracking-[0.2em] flex items-center"},wn={key:0,class:"text-center py-10 rounded-3xl border border-dashed border-slate-200 text-brand text-xl font-blod"},_n=["onClick"],kn={class:"flex-1"},Cn={class:"flex items-center space-x-2"},$n={class:"text-[11px] bg-white/80 text-cyan-500 px-1.5 py-0.5 rounded font-bold"},Sn={class:"font-bold text-cyan-50"},Mn={class:"flex items-center mt-1"},In={key:0,class:"space-y-3"},An={class:"text-[10px] font-black uppercase tracking-widest"},Tn={key:0,class:"space-y-2"},En={class:"flex-1"},Bn={class:"flex items-center space-x-2"},Vn={class:"text-[9px] border border-slate-200 text-brand px-1.5 py-0.5 rounded"},Rn={class:"text-gray-200 line-through text-sm"},zn=["onClick"],Dn={key:1,class:"max-w-2xl mx-auto space-y-4"},Ln={key:0,class:"text-center py-20 text-slate-300"},jn=["onClick"],On={class:"flex-1"},Fn={class:"flex items-center mt-1"},Pn=["onClick"],Un={class:"flex items-center space-x-3 p-2 bg-slate-50 rounded-2xl"},Nn=["onClick"],Hn=ne({__name:"TodoPage",setup(s,{expose:t}){const l=ye(),a=x(!1),n=x(null),o=x({}),u=async()=>{try{const V=await yt();V&&V.todoGroups&&(o.value=V.todoGroups)}catch(V){console.error("Failed to load todos",V)}};ae(o,async V=>{try{await xt({todoGroups:V})}catch(A){console.error("Failed to save todos",A)}},{deep:!0}),xe(()=>{u()});const m=K(()=>n.value?o.value[n.value]||{todos:[]}:{todos:[]}),w=K(()=>{const V=[];return Object.keys(o.value).forEach(A=>{const S=o.value[A];S&&S.todos.forEach(z=>{z.completed||V.push({...z,groupTitle:S.title,gid:A})})}),V.sort((A,S)=>S.priority-A.priority)}),i=K(()=>{const V=[];return Object.keys(o.value).forEach(A=>{const S=o.value[A];S&&S.todos.forEach(z=>{z.completed&&V.push({...z,groupTitle:S.title,gid:A})})}),V}),d=V=>{V.completed=!0},$=V=>{V.completed=!1},I=V=>{m.value.todos.splice(V,1)},p=V=>{n.value=V,l.scheduleView="todo_detail"},h=x(!1),f=at({groupTitle:"",todoText:"",priority:1}),b=K(()=>l.scheduleView==="todo_groups"?"æ–°å»ºä»»åŠ¡ç»„":"æ–°å»ºå¾…åŠä»»åŠ¡"),T=()=>{f.groupTitle="",f.todoText="",f.priority=1,h.value=!0},E=()=>{if(l.scheduleView==="todo_groups"){const V="t"+Date.now();o.value[V]={title:f.groupTitle,todos:[]}}else if(n.value){const V=o.value[n.value];V&&V.todos.push({id:Date.now(),text:f.todoText,priority:f.priority,completed:!1})}h.value=!1};return t({handleCreate:T}),(V,A)=>(r(),v(X,null,[c(l).scheduleView==="todo_groups"?(r(),v("div",pn,[e("div",vn,[(r(!0),v(X,null,re(o.value,(S,z)=>(r(),v("div",{key:"group-"+z,onClick:C=>p(z),class:"glass-effect p-5 rounded-2xl border border-slate-100 shadow-sm hover:border-cyan-200 cursor-pointer flex items-center justify-between group transition-all"},[e("div",fn,[e("div",mn,[g(c(Zs))]),e("div",null,[e("h4",gn,B(S.title),1),e("p",bn,B(S.todos.length)+" é¡¹ä»»åŠ¡ ",1)])]),g(c(ft),{class:"text-slate-200 group-hover:text-cyan-500"})],8,hn))),128))]),e("div",yn,[e("h3",xn,[g(c(Ht),{class:"w-3 h-3 mr-2 text-amber-400"}),A[4]||(A[4]=W(" å…¨å±€è¿›è¡Œä¸­ (æŒ‰ä¼˜å…ˆçº§) ",-1))]),w.value.length===0?(r(),v("div",wn," æš‚æ—¶æ²¡æœ‰è¿›è¡Œä¸­çš„ä»»åŠ¡ ")):G("",!0),(r(!0),v(X,null,re(w.value,S=>(r(),v("div",{key:"global-"+S.id,class:"glass-effect p-4 rounded-2xl border-l-4 border-l-cyan-500 shadow-sm flex items-center space-x-4"},[e("button",{onClick:Me(z=>d(S),["stop"]),class:"w-6 h-6 border-2 border-cyan-100 rounded-lg hover:border-cyan-500 transition-all"},null,8,_n),e("div",kn,[e("div",Cn,[e("span",$n,B(S.groupTitle),1),e("p",Sn,B(S.text),1)]),e("div",Mn,[(r(),v(X,null,re(5,z=>g(c(ot),{key:"star-global-"+S.id+"-"+z,class:J(["w-3 h-3",z<=S.priority?"text-amber-400 fill-amber-400":"text-slate-100"])},null,8,["class"])),64))])])]))),128))]),i.value.length>0?(r(),v("div",In,[e("button",{onClick:A[0]||(A[0]=S=>a.value=!a.value),class:"flex items-center space-x-2 text-slate-400 hover:text-cyan-600 transition-colors px-1"},[(r(),de(qt(a.value?c(Gs):c(ft)),{class:"w-4 h-4"})),e("span",An,"å·²å®Œæˆå†å² ("+B(i.value.length)+")",1)]),a.value?(r(),v("div",Tn,[(r(!0),v(X,null,re(i.value,S=>(r(),v("div",{key:"done-"+S.id,class:"bg-slate-50/50 p-4 rounded-2xl border border-slate-100 flex items-center space-x-4 opacity-50"},[g(c(Ys),{class:"text-cyan-500 w-5 h-5"}),e("div",En,[e("div",Bn,[e("span",Vn,B(S.groupTitle),1),e("p",Rn,B(S.text),1)])]),e("button",{onClick:Me(z=>$(S),["stop"]),class:"text-[10px] text-cyan-600 font-bold hover:underline"}," æ’¤å› ",8,zn)]))),128))])):G("",!0)])):G("",!0)])):G("",!0),c(l).scheduleView==="todo_detail"?(r(),v("div",Dn,[m.value.todos.length===0?(r(),v("div",Ln,[g(c(Qs),{class:"w-10 h-10 mx-auto mb-4 opacity-20"}),A[5]||(A[5]=e("p",null,"è¿˜æ²¡æœ‰ä»»åŠ¡ï¼Œç‚¹å‡»å³ä¸Šè§’æ–°å»ºä¸€ä¸ªå§",-1))])):G("",!0),(r(!0),v(X,null,re(m.value.todos,(S,z)=>(r(),v("div",{key:"detail-todo-"+S.id,class:J(["glass-effect p-4 rounded-2xl border border-slate-100 shadow-sm flex items-center space-x-4 transition-all",S.completed?"opacity-50":""])},[e("button",{onClick:Me(C=>S.completed?$(S):d(S),["stop"]),class:J(["w-6 h-6 border-2 rounded-lg transition-all",S.completed?"bg-cyan-500 border-cyan-500":"border-slate-100 hover:border-cyan-500"])},[S.completed?(r(),de(c(Ws),{key:0,class:"text-white w-4 h-4"})):G("",!0)],10,jn),e("div",On,[e("p",{class:J(["font-medium text-white",S.completed?"line-through ":""])},B(S.text),3),e("div",Fn,[(r(),v(X,null,re(5,C=>g(c(ot),{key:"star-detail-"+S.id+"-"+C,class:J(["w-3 h-3",C<=S.priority?"text-amber-400 fill-amber-400":"text-slate-100"])},null,8,["class"])),64))])]),e("button",{onClick:Me(C=>I(z),["stop"]),class:"text-slate-200 hover:text-red-400 p-2"},[g(c(Nt))],8,Pn)],2))),128))])):G("",!0),g(Wt,{show:h.value,title:b.value,onClose:A[3]||(A[3]=S=>h.value=!1),onConfirm:E},{default:M(()=>[c(l).scheduleView==="todo_groups"?Q((r(),v("input",{key:0,"onUpdate:modelValue":A[1]||(A[1]=S=>f.groupTitle=S),placeholder:"é¡¹ç›®åç§° (ä¾‹å¦‚: å­¦æ ¡ä»»åŠ¡)",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512)),[[we,f.groupTitle]]):(r(),v(X,{key:1},[Q(e("input",{"onUpdate:modelValue":A[2]||(A[2]=S=>f.todoText=S),placeholder:"ä»»åŠ¡å†…å®¹",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,f.todoText]]),e("div",Un,[A[6]||(A[6]=e("span",{class:"text-xs font-bold text-slate-400 uppercase pl-2"},"ä¼˜å…ˆçº§:",-1)),(r(),v(X,null,re(5,S=>e("button",{key:"prio-"+S,onClick:z=>f.priority=S,class:"focus:outline-none transform active:scale-125 transition-transform"},[g(c(ot),{size:24,class:J([S<=f.priority?"text-amber-400 fill-amber-400":"text-slate-200"])},null,8,["class"])],8,Nn)),64))])],64))]),_:1},8,["show","title"])],64))}}),Wn={key:0,class:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-2 gap-6"},Gn=["onClick"],Yn={class:"w-12 h-12 bg-cyan-500 rounded-2xl flex items-center justify-center text-cyan-50 mb-4 group-hover:bg-cyan-50 group-hover:text-cyan-500 transition-colors"},qn={class:"font-bold text-lg text-brand"},Xn={class:"text-sm text-white mt-2 line-clamp-2"},Jn={class:"mt-6 pt-4 border-t border-slate-50 flex justify-between items-center text-xs font-bold text-brand"},Kn={key:1,class:"max-w-3xl mx-auto space-y-4"},Zn={class:"bg-cyan-500 text-white px-3 py-1 rounded-lg text-xs font-bold self-center"},Qn={class:"flex-1"},eo={class:"font-bold text-brand text-lg"},to={class:"text-sm text-white mt-1"},so=["onClick"],no=ne({__name:"SchedulePage",setup(s,{expose:t}){const l=ye(),a=x({}),n=async()=>{try{const h=await yt();h&&h.scheduleGroups&&(a.value=h.scheduleGroups)}catch(h){console.error("Failed to load schedules",h)}};ae(a,async h=>{try{await xt({scheduleGroups:h})}catch(f){console.error("Failed to save schedules",f)}},{deep:!0}),xe(()=>{n()});const o=K(()=>m.value?a.value[m.value]||{items:[]}:{items:[]}),u=h=>{o.value.items.splice(h,1)},m=x(null),w=h=>{m.value=h,l.scheduleView="schedule_detail"},i=x(!1),d=at({groupTitle:"",groupDesc:"",itemName:"",itemTime:"",itemContent:""}),$=K(()=>l.scheduleView==="schedule_groups"?"æ–°å»ºæ—¥ç¨‹ä¸»é¢˜":"æ–°å»ºå…·ä½“æ—¥ç¨‹"),I=()=>{d.groupTitle="",d.groupDesc="",d.itemName="",d.itemTime="",d.itemContent="",i.value=!0},p=()=>{if(l.scheduleView==="schedule_groups"){const h="g"+Date.now();a.value[h]={title:d.groupTitle,description:d.groupDesc,items:[]}}else if(m.value){const h=a.value[m.value];h&&h.items.push({name:d.itemName,time:d.itemTime,content:d.itemContent})}i.value=!1};return t({handleCreate:I}),(h,f)=>(r(),v(X,null,[c(l).scheduleView==="schedule_groups"?(r(),v("div",Wn,[(r(!0),v(X,null,re(a.value,(b,T)=>(r(),v("div",{key:T,onClick:E=>w(T),class:"group glass-effect p-6 rounded-3xl border border-brand shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all cursor-pointer"},[e("div",Yn,[g(c(Ks))]),e("h3",qn,B(b.title),1),e("p",Xn,B(b.description),1),e("div",Jn,[e("span",null,B(b.items.length)+" ä¸ªæ—¥ç¨‹",1),g(c(Us),{size:16})])],8,Gn))),128))])):G("",!0),c(l).scheduleView==="schedule_detail"?(r(),v("div",Kn,[(r(!0),v(X,null,re(o.value.items,(b,T)=>(r(),v("div",{key:T,class:"glass-effect p-5 rounded-2xl border border-slate-100 shadow-sm flex items-start space-x-4"},[e("div",Zn,B(b.time),1),e("div",Qn,[e("h4",eo,B(b.name),1),e("p",to,B(b.content),1)]),e("button",{onClick:E=>u(T),class:"text-slate-300 hover:text-red-400 p-1"},[g(c(Nt))],8,so)]))),128))])):G("",!0),g(Wt,{show:i.value,title:$.value,onClose:f[5]||(f[5]=b=>i.value=!1),onConfirm:p},{default:M(()=>[c(l).scheduleView==="schedule_groups"?(r(),v(X,{key:0},[Q(e("input",{"onUpdate:modelValue":f[0]||(f[0]=b=>d.groupTitle=b),placeholder:"ä¸»é¢˜åç§°",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,d.groupTitle]]),Q(e("textarea",{"onUpdate:modelValue":f[1]||(f[1]=b=>d.groupDesc=b),placeholder:"æè¿°...",rows:"3",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none resize-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,d.groupDesc]])],64)):(r(),v(X,{key:1},[Q(e("input",{"onUpdate:modelValue":f[2]||(f[2]=b=>d.itemName=b),placeholder:"æ´»åŠ¨åç§°",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,d.itemName]]),Q(e("input",{"onUpdate:modelValue":f[3]||(f[3]=b=>d.itemTime=b),type:"time",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,d.itemTime]]),Q(e("textarea",{"onUpdate:modelValue":f[4]||(f[4]=b=>d.itemContent=b),placeholder:"æŒ‡ä»¤è¯¦æƒ…...",rows:"2",class:"w-full px-5 py-4 rounded-2xl border-none bg-slate-100 outline-none resize-none focus:ring-2 focus:ring-cyan-500/50 transition-all"},null,512),[[we,d.itemContent]])],64))]),_:1},8,["show","title"])],64))}}),oo={key:0,class:"h-full flex items-center justify-center"},ao={class:"w-2/3 glass-effect rounded-xl border border-cyan-500 shadow-sm overflow-hidden flex flex-col"},lo={class:"p-4 flex justify-between items-center border-b border-cyan-500"},ro={class:"flex w-full justify-around items-center"},io={class:"text-lg font-bold text-brand"},co={class:"flex-1 flex flex-col"},uo={class:"calendar-grid border-b border-cyan-500 bg-slate-50/30 font-bold text-[10px] text-white text-center py-3 tracking-widest"},po={class:"calendar-grid flex-1"},vo=["onClick"],ho={class:"mt-1 space-y-1"},fo={class:"h-full w-1/3 pl-4"},mo={class:"glass-effect rounded-xl border border-cyan-500 shadow-sm p-4 h-full flex flex-col"},go={class:"flex-1 overflow-y-auto space-y-2"},bo=["onClick"],yo={class:"flex justify-between items-start"},xo={class:"flex-1"},wo={class:"font-medium text-brand"},_o={class:"text-xs text-white mt-1"},ko={key:0,class:"text-xs text-white mt-1"},Co=["onClick"],$o={key:0,class:"text-center py-8 text-gray-500"},So={class:"glass-effect rounded-xl border border-cyan-500 shadow-sm p-6 w-96"},Mo={class:"space-y-4"},Io={class:"flex justify-end space-x-2 mt-6"},Ao={class:"glass-effect rounded-xl border border-cyan-500 shadow-sm p-6 w-96"},To={class:"text-lg font-bold text-brand mb-4"},Eo={class:"space-y-2"},Bo={class:"text-sm"},Vo={key:0},Ro={class:"text-sm mt-1"},zo={key:1},Do={class:"text-sm"},Lo={class:"flex justify-end mt-6"},jo=ne({__name:"CalendarPage",setup(s,{expose:t}){const l=ye(),a=x([]),n=async()=>{try{const C=await yt();a.value=C.importantDays||[]}catch(C){console.error("Failed to load calendar events",C)}};ae(a,async C=>{try{await xt({importantDays:C})}catch(_){console.error("Failed to save calendar events",_)}},{deep:!0}),xe(()=>{n()});const o=x(new Date),u=K(()=>o.value.getFullYear()),m=K(()=>o.value.getMonth()),w=x(null),i=K(()=>{const C=[],_=new Date(u.value,m.value,1),k=new Date(u.value,m.value+1,0),y=new Date(u.value,m.value,0).getDate();for(let le=_.getDay();le>0;le--)C.push({date:y-le+1,month:m.value-1,year:u.value,currentMonth:!1});const F=new Date;for(let le=1;le<=k.getDate();le++)C.push({date:le,month:m.value,year:u.value,currentMonth:!0,today:F.getDate()===le&&F.getMonth()===m.value&&F.getFullYear()===u.value});const ce=42-C.length;for(let le=1;le<=ce;le++)C.push({date:le,month:m.value+1,year:u.value,currentMonth:!1});return C}),d=C=>{o.value=new Date(u.value,m.value+C,1)},$=C=>{w.value=C},I=C=>{const _=`${C.year}-${String(C.month+1).padStart(2,"0")}-${String(C.date).padStart(2,"0")}`;return a.value.filter(k=>k.date===_)},p=K(()=>[...a.value].sort((C,_)=>new Date(C.date).getTime()-new Date(_.date).getTime())),h=C=>{const _=new Date(C);return`${_.getFullYear()}å¹´${_.getMonth()+1}æœˆ${_.getDate()}æ—¥`},f=C=>({yearly:"æ¯å¹´",monthly:"æ¯æœˆ",weekly:"æ¯å‘¨"})[C]||C,b=x(!1),T=x(null),E=x({id:"",date:"",title:"",desc:"",cycle:""}),V=()=>{if(!E.value.title||!E.value.date)return;const C=Date.now().toString();a.value.push({...E.value,id:C}),E.value={id:"",date:"",title:"",desc:"",cycle:""},b.value=!1},A=C=>{a.value=a.value.filter(_=>_.id!==C)},S=C=>{T.value=C};return t({handleCreate:()=>{b.value=!0}}),(C,_)=>c(l).scheduleView==="calendar"?(r(),v("div",oo,[e("div",ao,[e("div",lo,[e("div",ro,[e("button",{onClick:_[0]||(_[0]=k=>d(-1)),class:"p-2 hover:bg-cyan-50 rounded-lg text-cyan-500 transition-all duration-300"},[g(c(Ut))]),e("h3",io,B(u.value)+"å¹´ "+B(m.value+1)+"æœˆ ",1),e("button",{onClick:_[1]||(_[1]=k=>d(1)),class:"p-2 hover:bg-cyan-50 rounded-lg text-cyan-500 transition-all duration-300"},[g(c(ft))])])]),e("div",co,[e("div",uo,[(r(),v(X,null,re(["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],k=>e("div",{key:k},B(k),1)),64))]),e("div",po,[(r(!0),v(X,null,re(i.value,(k,y)=>(r(),v("div",{key:"day-"+y,onClick:F=>$(k),class:J(["day-cell p-2 border-r border-b border-cyan-500 transition-all cursor-pointer relative hover:bg-cyan-50/30",k.currentMonth?"":"bg-slate-50/20 opacity-30"])},[e("span",{class:J(["text-sm font-medium",k.today?"w-7 h-7 bg-cyan-500 text-white rounded-full flex items-center justify-center":"text-white"])},B(k.date),3),e("div",ho,[(r(!0),v(X,null,re(I(k),F=>(r(),v("div",{key:"event-"+F.id,class:"text-[9px] bg-cyan-100 text-cyan-700 px-1.5 py-0.5 rounded truncate font-bold"},B(F.title),1))),128))])],10,vo))),128))])])]),e("div",fo,[e("div",mo,[_[22]||(_[22]=e("h3",{class:"text-lg font-bold text-brand mb-4"},"é‡è¦æ—¥å­",-1)),e("button",{onClick:_[2]||(_[2]=k=>b.value=!0),class:"w-full bg-cyan-500 text-white rounded-lg py-2 px-4 mb-4 hover:bg-cyan-600 transition-all duration-300 flex items-center justify-center"},[..._[11]||(_[11]=[e("span",{class:"mr-2"},"+",-1),W(" æ·»åŠ é‡è¦æ—¥å­ ",-1)])]),e("div",go,[(r(!0),v(X,null,re(p.value,k=>(r(),v("div",{key:k.id,class:"p-3 bg-slate-50/30 rounded-lg border border-cyan-500/30 hover:bg-slate-50/50 transition-all duration-300 cursor-pointer",onClick:y=>S(k)},[e("div",yo,[e("div",xo,[e("h4",wo,B(k.title),1),e("p",_o,B(h(k.date)),1),k.desc?(r(),v("p",ko,B(k.desc),1)):G("",!0)]),e("button",{onClick:Me(y=>A(k.id),["stop"]),class:"text-red-500 hover:text-red-700 ml-2"},[..._[12]||(_[12]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Co)])],8,bo))),128)),p.value.length===0?(r(),v("div",$o," æš‚æ— é‡è¦æ—¥å­ ")):G("",!0)]),b.value?(r(),v("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:_[8]||(_[8]=Me(k=>b.value=!1,["self"]))},[e("div",So,[_[18]||(_[18]=e("h3",{class:"text-lg font-bold text-brand mb-4"},"æ·»åŠ é‡è¦æ—¥å­",-1)),e("div",Mo,[e("div",null,[_[13]||(_[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"æ ‡é¢˜",-1)),Q(e("input",{"onUpdate:modelValue":_[3]||(_[3]=k=>E.value.title=k),type:"text",class:"w-full px-3 py-2 border border-cyan-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"è¾“å…¥æ ‡é¢˜"},null,512),[[we,E.value.title]])]),e("div",null,[_[14]||(_[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"æ—¥æœŸ",-1)),Q(e("input",{"onUpdate:modelValue":_[4]||(_[4]=k=>E.value.date=k),type:"date",class:"w-full px-3 py-2 border border-cyan-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"},null,512),[[we,E.value.date]])]),e("div",null,[_[15]||(_[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"æè¿° (å¯é€‰)",-1)),Q(e("textarea",{"onUpdate:modelValue":_[5]||(_[5]=k=>E.value.desc=k),class:"w-full px-3 py-2 border border-cyan-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500",rows:"3",placeholder:"è¾“å…¥æè¿°"},null,512),[[we,E.value.desc]])]),e("div",null,[_[17]||(_[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"å‘¨æœŸ (å¯é€‰)",-1)),Q(e("select",{"onUpdate:modelValue":_[6]||(_[6]=k=>E.value.cycle=k),class:"w-full px-3 py-2 border border-cyan-500 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500"},[..._[16]||(_[16]=[e("option",{value:""},"æ— ",-1),e("option",{value:"yearly"},"æ¯å¹´",-1),e("option",{value:"monthly"},"æ¯æœˆ",-1),e("option",{value:"weekly"},"æ¯å‘¨",-1)])],512),[[Lt,E.value.cycle]])])]),e("div",Io,[e("button",{onClick:_[7]||(_[7]=k=>b.value=!1),class:"px-4 py-2 border border-cyan-500 text-cyan-500 rounded-lg hover:bg-cyan-50 transition-all duration-300"}," å–æ¶ˆ "),e("button",{onClick:V,class:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-all duration-300"}," æ·»åŠ  ")])])])):G("",!0),T.value?(r(),v("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:_[10]||(_[10]=Me(k=>T.value=null,["self"]))},[e("div",Ao,[e("h3",To,B(T.value.title),1),e("div",Eo,[e("div",null,[_[19]||(_[19]=e("span",{class:"text-sm font-medium text-gray-700"},"æ—¥æœŸï¼š",-1)),e("span",Bo,B(h(T.value.date)),1)]),T.value.desc?(r(),v("div",Vo,[_[20]||(_[20]=e("span",{class:"text-sm font-medium text-gray-700"},"æè¿°ï¼š",-1)),e("p",Ro,B(T.value.desc),1)])):G("",!0),T.value.cycle?(r(),v("div",zo,[_[21]||(_[21]=e("span",{class:"text-sm font-medium text-gray-700"},"å‘¨æœŸï¼š",-1)),e("span",Do,B(f(T.value.cycle)),1)])):G("",!0)]),e("div",Lo,[e("button",{onClick:_[9]||(_[9]=k=>T.value=null),class:"px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-all duration-300"}," å…³é—­ ")])])])):G("",!0)])])])):G("",!0)}}),Oo=ie(jo,[["__scopeId","data-v-117b5c92"]]),Fo={class:"w-full md:w-64 p-6 flex flex-col border-r border-cyan-300"},Po={class:"flex items-center space-x-3 text-base font-bold px-3.75 py-2.5 rounded-lg mb-8 text-brand inset_0_1px_1px_rgba(255,255,255,0.1)]"},Uo={class:"w-10 h-10 bg-cyan-500 rounded-xl flex items-center justify-center text-white shadow-lg"},No={class:"flex-1 space-y-2 w-full"},Ho={class:"w-full flex items-center space-x-6 px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold"},Wo={class:"flex-1 flex flex-col overflow-hidden w-2xl"},Go={class:"mt-2 p-6 flex justify-between items-center border-b border-cyan-300"},Yo={class:"flex items-center space-x-4 pl-4"},qo={class:"flex-1 overflow-y-auto p-6 custom-scrollbar"},Xo=ne({__name:"ScheduleContent",props:{variant:{default:"settings"}},setup(s){const t=s,l=x(),a=x(),n=x(),o=ye(),u=()=>{const i=o.scheduleView;i.startsWith("schedule")?l.value?.handleCreate():i.startsWith("todo")?a.value?.handleCreate():i==="calendar"&&n.value?.handleCreate()},m=i=>{o.scheduleView=i},w=K(()=>t.variant==="settings"?"h-[85vh] max-w-6xl md:w-[calc(100vw-4rem)]":"h-[70vh] w-[820px] max-w-[90vw]");return(i,d)=>(r(),v("div",{class:J(["w-full flex-1 glass-panel bg-white/10 rounded-2xl overflow-hidden flex flex-col md:flex-row",w.value])},[e("aside",Fo,[e("div",Po,[e("div",Uo,[g(c(on),{size:20})]),d[4]||(d[4]=e("h1",{class:"font-bold text-xl text-white tracking-tight"},"LingChat AI",-1))]),e("nav",No,[e("button",{class:"w-full flex items-center space-x-6 px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold",onClick:d[0]||(d[0]=$=>m("schedule_groups"))},[g(c(en),{size:18}),d[5]||(d[5]=e("span",null,"æ—¥ç¨‹ä¸»é¢˜",-1))]),e("button",{class:"w-full flex items-center space-x-6 px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold",onClick:d[1]||(d[1]=$=>m("todo_groups"))},[g(c(qs),{size:18}),d[6]||(d[6]=e("span",null,"å¾…åŠäº‹é¡¹",-1))]),e("button",{class:"w-full flex items-center space-x-6 px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold",onClick:d[2]||(d[2]=$=>m("calendar"))},[g(c(Ns),{size:18}),d[7]||(d[7]=e("span",null,"é‡è¦æ—¥å­",-1))]),e("button",Ho,[g(c(Hs),{size:18}),d[8]||(d[8]=e("span",null,"ä¸»åŠ¨å¯¹è¯",-1))])]),d[9]||(d[9]=e("div",{class:"mt-auto mb-6 p-4 bg-cyan-50/10 rounded-2xl border border-cyan-500/20"},[e("div",{class:"flex items-center text-brand font-bold text-xs mb-2"},[e("span",{class:"w-2 h-2 bg-cyan-500 rounded-full animate-pulse mr-2"}),W(" Ling Clock ")]),e("p",{class:"text-xs text-white italic leading-relaxed"},' "åœ¨è¿™é‡Œæ·»åŠ çš„ä¿¡æ¯å±å¹•åçš„é‚£ä¸ªtaä¹Ÿçœ‹å¾—åˆ°å“¦ï¼" ')],-1))]),e("main",Wo,[e("header",Go,[e("div",Yo,[Q(e("button",{onClick:d[3]||(d[3]=$=>c(o).scheduleView="schedule_groups"),class:"p-2 hover:bg-cyan-50 rounded-full text-cyan-600 transition-all"},[g(c(Ut))],512),[[Ce,c(o).scheduleView==="schedule_detail"]]),d[10]||(d[10]=e("div",null,[e("h2",{class:"text-2xl font-bold text-brand mb-2"},"å°çµé—¹é’Ÿ"),e("p",{class:"text-xs text-white mt-0.5 tracking-wide"},"ç•™ä¸‹éœ€è¦å¥¹æé†’ä½ çš„äº‹æƒ…å§")],-1))]),e("button",{onClick:u,class:"bg-cyan-500 hover:bg-cyan-600 text-white px-5 py-2.5 rounded-xl shadow-lg transition-all flex items-center space-x-2"},[g(c(tn)),d[11]||(d[11]=e("span",{class:"font-medium"},"æ–°å»º",-1))])]),e("div",qo,[g(no,{ref_key:"scheduleRef",ref:l},null,512),g(Hn,{ref_key:"todoRef",ref:a},null,512),g(Oo,{ref_key:"calendarRef",ref:n},null,512)])])],2))}}),Jo={class:"flex flex-col gap-3"},Ko={key:0,class:"bg-[#12121c]/75 backdrop-blur-[20px] border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.4)] rounded-3xl p-3 text-white box-border"},Zo=ne({__name:"SchedulePanel",setup(s){const t=ye(),l=x(!1);function a(){l.value=!l.value}return ae(()=>t.showSettings,n=>{n&&(l.value=!1)}),(n,o)=>(r(),v("div",Jo,[Q(g(te,{type:"nav",icon:"schedule",class:J(["flex items-center gap-2 px-4 py-2 transition-colors",l.value?"text-[#4facfe]":"text-white"]),onClick:a},{default:M(()=>[...o[0]||(o[0]=[e("h3",{class:"text-lg font-bold m-0"},"æ—¥ç¨‹",-1)])]),_:1},8,["class"]),[[Ce,!c(t).showSettings]]),g(Pe,{"enter-active-class":"transition-all duration-300 cubic-bezier(0.2, 0.8, 0.2, 1)","leave-active-class":"transition-all duration-300 cubic-bezier(0.2, 0.8, 0.2, 1)","enter-from-class":"opacity-0 -translate-y-2","leave-to-class":"opacity-0 -translate-y-2"},{default:M(()=>[l.value?(r(),v("div",Ko,[g(Xo,{variant:"popup"})])):G("",!0)]),_:1})]))}}),Qo={key:0,class:"fixed top-5 left-5 z-2000 flex items-start gap-3 transition-all ease-in-out duration-300"},ea=ne({__name:"FreeModeTools",setup(s){const t=Ve(),l=K(()=>!(t.runningScript&&t.runningScript.isRunning));return(a,n)=>l.value?(r(),v("div",Qo,[g(Ds),g(Zo)])):G("",!0)}}),ta={__name:"Rain",props:{enabled:{type:Boolean,default:!0},intensity:{type:Number,default:1,validator:s=>s>=0&&s<=2}},setup(s){const t=s,l=x(50),a=x(20),n=x([]),o=x(null),u=x(null),m=x(0),w=x(null);ae(()=>t.intensity,I=>{l.value=Math.max(10,100-I*45)},{immediate:!0});const i=()=>{t.enabled&&(clearInterval(o.value),o.value=setInterval(()=>{const I={top:-100,left:`${~~(Math.random()*100)}%`,speed:10+Math.random()*10*t.intensity,size:30+Math.random()*40*t.intensity,opacity:.2+Math.random()*.5};n.value.push(I)},l.value))},d=()=>{t.enabled&&(clearInterval(u.value),u.value=setInterval(()=>{const I=n.value.filter(p=>p.top<m.value);I.forEach(p=>{p.top+=p.speed}),n.value=I},a.value))},$=()=>{w.value&&w.value.parentElement?m.value=w.value.parentElement.clientHeight:m.value=window.innerHeight};return xe(()=>{Te(()=>{$(),t.enabled&&(i(),d())}),window.addEventListener("resize",$)}),Le(()=>{clearInterval(o.value),clearInterval(u.value),window.removeEventListener("resize",$)}),ae(()=>t.enabled,I=>{I?($(),i(),d()):(clearInterval(o.value),clearInterval(u.value),n.value=[])}),(I,p)=>(r(),v("div",{class:"rain-container",ref_key:"containerRef",ref:w},[(r(!0),v(X,null,re(n.value,(h,f)=>(r(),v("span",{class:"rain-item",key:f,style:$e({top:`${h.top}px`,left:h.left,height:`${h.size}px`,opacity:h.opacity})},null,4))),128))],512))}},sa=ie(ta,[["__scopeId","data-v-04812d89"]]),na=ne({__name:"Sakura",props:{enabled:{type:Boolean,default:!0},intensity:{default:1}},setup(s){const t=s,l=x([]),a=x(null),n=x(0),o=x(Math.floor(25*t.intensity)),u=()=>Math.random().toString(36).substr(2,9),m=()=>{const p=Math.random()*10+10,h=Math.random()*window.innerWidth,f=-30,b=Math.random()*10+15,T=Math.random()*10,E=Math.random()*.5+.4,V=Math.random()*10+320,A=Math.random()*100-50;return{id:u(),size:p,left:h,top:f,opacity:E,hue:V,duration:b,delay:T,horizontalMovement:A}},w=p=>{const h=document.createElement("style");document.head.appendChild(h);const f=`
  @keyframes fall-${p.id} {
    0% {
      transform: translate(0, 0) rotate(0deg);
      opacity: ${p.opacity};
    }
    25% {
      transform: translate(${p.horizontalMovement*.25}px, ${n.value*.25}px) 
                 rotate(${90+Math.random()*90}deg);
      opacity: ${p.opacity*.9};
    }
    50% {
      transform: translate(${p.horizontalMovement*.5}px, ${n.value*.5}px) 
                 rotate(${180+Math.random()*90}deg);
      opacity: ${p.opacity*.7};
    }
    75% {
      transform: translate(${p.horizontalMovement*.75}px, ${n.value*.75}px) 
                 rotate(${270+Math.random()*90}deg);
      opacity: ${p.opacity*.5};
    }
    100% {
      transform: translate(${p.horizontalMovement}px, ${n.value}px) 
                 rotate(${360+Math.random()*180}deg);
      opacity: 0;
    }
  }
`;h.innerHTML=f,p.styleSheet=h},i=p=>{for(let h=0;h<p;h++){const f=m();w(f),l.value.push(f)}},d=()=>{l.value.forEach(p=>{p.styleSheet&&p.styleSheet.parentNode&&p.styleSheet.parentNode.removeChild(p.styleSheet)}),l.value=[]},$=()=>{a.value&&a.value.parentElement?n.value=a.value.parentElement.clientHeight:n.value=window.innerHeight},I=()=>{d(),i(o.value)};return ae(()=>t.intensity,p=>{o.value=Math.floor(25*p),I()}),ae(()=>t.enabled,p=>{p?($(),i(o.value)):d()}),xe(()=>{Te(()=>{$(),t.enabled&&i(o.value)}),window.addEventListener("resize",()=>{$(),I()})}),Le(()=>{d(),window.removeEventListener("resize",$)}),(p,h)=>(r(),v("div",{class:"petal-container",ref_key:"containerRef",ref:a},[(r(!0),v(X,null,re(l.value,(f,b)=>(r(),v("div",{class:"petal",key:b,style:$e({width:`${f.size}px`,height:`${f.size}px`,left:`${f.left}px`,top:`${f.top}px`,opacity:f.opacity,background:`linear-gradient(135deg, hsl(${f.hue}, 100%, 85%), hsl(${f.hue}, 100%, 75%))`,animation:`fall-${f.id} ${f.duration}s linear ${f.delay}s infinite`})},null,4))),128))],512))}}),oa=ie(na,[["__scopeId","data-v-f258e642"]]),aa=ne({__name:"Snow",props:{enabled:{type:Boolean,default:!0},intensity:{default:1}},setup(s){const t=s,l=x([]),a=x(null),n=x(0),o=x(Math.floor(50*t.intensity)),u=["â„","â…","â†","â€¢","Â·"],m=()=>Math.random().toString(36).substr(2,9),w=()=>{const h=Math.random()*10+8,f=Math.random()*window.innerWidth,b=-30,T=Math.random()*15+20,E=Math.random()*10,V=Math.random()*.7+.3,A=Math.random()*100-50,S=u[Math.floor(Math.random()*u.length)]||"â„";return{id:m(),size:h,left:f,top:b,opacity:V,duration:T,delay:E,horizontalMovement:A,content:S}},i=h=>{const f=document.createElement("style");document.head.appendChild(f);const b=`
  @keyframes fall-${h.id} {
    0% {
      transform: translate(0, 0) rotate(0deg);
      opacity: ${h.opacity};
    }
    25% {
      transform: translate(${h.horizontalMovement*.25}px, ${n.value*.25}px) 
                 rotate(${Math.random()*90}deg);
      opacity: ${h.opacity*.95};
    }
    50% {
      transform: translate(${h.horizontalMovement*.5}px, ${n.value*.5}px) 
                 rotate(${Math.random()*180}deg);
      opacity: ${h.opacity*.9};
    }
    75% {
      transform: translate(${h.horizontalMovement*.75}px, ${n.value*.75}px) 
                 rotate(${Math.random()*270}deg);
      opacity: ${h.opacity*.8};
    }
    100% {
      transform: translate(${h.horizontalMovement}px, ${n.value}px) 
                 rotate(${Math.random()*360}deg);
      opacity: ${h.opacity*.4};;
    }
  }
`;f.innerHTML=b,h.styleSheet=f},d=h=>{for(let f=0;f<h;f++){const b=w();i(b),l.value.push(b)}},$=()=>{l.value.forEach(h=>{h.styleSheet&&h.styleSheet.parentNode&&h.styleSheet.parentNode.removeChild(h.styleSheet)}),l.value=[]},I=()=>{a.value&&a.value.parentElement?n.value=a.value.parentElement.clientHeight:n.value=window.innerHeight},p=()=>{$(),d(o.value)};return ae(()=>t.intensity,h=>{o.value=Math.floor(50*h),p()}),ae(()=>t.enabled,h=>{h?(I(),d(o.value)):$()}),xe(()=>{Te(()=>{I(),t.enabled&&d(o.value)}),window.addEventListener("resize",()=>{I(),p()})}),Le(()=>{$(),window.removeEventListener("resize",I)}),(h,f)=>(r(),v("div",{class:"snow-container",ref_key:"containerRef",ref:a},[(r(!0),v(X,null,re(l.value,(b,T)=>(r(),v("div",{class:"snowflake",key:T,style:$e({width:`${b.size}px`,height:`${b.size}px`,left:`${b.left}px`,top:`${b.top}px`,opacity:b.opacity,animation:`fall-${b.id} ${b.duration}s linear ${b.delay}s infinite`})},B(b.content),5))),128))],512))}}),la=ie(aa,[["__scopeId","data-v-fe4bda82"]]),ra={class:"fireworks-container"},ia=7680,ca=4320,ua=.9,da=60,pa=3,Bt="_INVISIBLE_",va=1e3,ha=ne({__name:"Fireworks",setup(s){const t=Math.PI*2,l=Math.PI*.5,a=1e3/da,n={Red:"#ff0043",Green:"#14fc56",Blue:"#1e7fff",Purple:"#e60aff",Gold:"#ffbf36",White:"#ffffff"},u=Object.keys(n).map(R=>n[R]),m=[...u,Bt],w=x(),i=x();let d=0,$=0,I=1,p=0,h=!1,f=0,b=!1,T=!1,E=!0,V=null,A=null,S=0;const z=[50,200];let C=0,_,k;const y={active:le(),_pool:[],drawWidth:3,airDrag:.98,airDragHeavy:.992,_new(){return{visible:!0,heavy:!1,x:0,y:0,prevX:0,prevY:0,color:"",speedX:0,speedY:0,life:0,fullLife:0,spinAngle:0,spinSpeed:.8,spinRadius:0,sparkFreq:0,sparkSpeed:1,sparkTimer:0,sparkColor:"",sparkLife:750,sparkLifeVariation:.25,strobe:!1,updateFrame:0,secondColor:void 0,transitionTime:0,colorChanged:!1}},add(R,O,L,U,ee,se,Z,oe){const P=this._pool.pop()||this._new();return P.visible=!0,P.heavy=!1,P.x=R,P.y=O,P.prevX=R,P.prevY=O,P.color=L,P.speedX=Math.sin(U)*ee+(Z||0),P.speedY=Math.cos(U)*ee+(oe||0),P.life=se,P.fullLife=se,P.spinAngle=Math.random()*t,P.spinSpeed=.8,P.spinRadius=0,P.sparkFreq=0,P.sparkSpeed=1,P.sparkTimer=0,P.sparkColor=L,P.sparkLife=750,P.sparkLifeVariation=.25,P.strobe=!1,P.updateFrame=0,P.secondColor=void 0,P.transitionTime=0,P.colorChanged=!1,this.active[L].push(P),P},returnInstance(R){R.onDeath&&R.onDeath(R),R.onDeath=void 0,R.secondColor=void 0,R.transitionTime=0,R.colorChanged=!1,this._pool.push(R)}},F={active:le(),_pool:[],drawWidth:2.5,airDrag:.95,_new(){return{x:0,y:0,prevX:0,prevY:0,color:"",speedX:0,speedY:0,life:0}},add(R,O,L,U,ee,se){const Z=this._pool.pop()||this._new();return Z.x=R,Z.y=O,Z.prevX=R,Z.prevY=O,Z.color=L,Z.speedX=Math.sin(U)*ee,Z.speedY=Math.cos(U)*ee,Z.life=se,this.active[L].push(Z),Z},returnInstance(R){this._pool.push(R)}},ce={active:[],_pool:[],_new(){return{x:0,y:0,radius:0}},add(R,O,L){const U=this._pool.pop()||this._new();return U.x=R,U.y=O,U.radius=L,this.active.push(U),U},returnInstance(R){this._pool.push(R)}};function le(){const R={};return m.forEach(O=>{R[O]=[]}),R}function N(){return u[Math.random()*u.length|0]}function ue(R,O,L,U,ee){const se=O/L,Z=R+O-se*.5;if(Z>R)for(let oe=R;oe<Z;oe=oe+se)ee(oe+Math.random()*se*U);else for(let oe=R;oe>Z;oe=oe+se)ee(oe+Math.random()*se*U)}function pe(R,O,L=0,U=t){const se=2*(.5*Math.sqrt(R/Math.PI))*Math.PI,Z=se/2;for(let oe=0;oe<=Z;oe++){const P=oe/Z*l,ge=Math.cos(P),D=se*ge,Ae=D*(U/t),ke=t/D,be=Math.random()*ke+L,Se=ke*.33;for(let qe=0;qe<Ae;qe++){const rt=Math.random()*Se;let Re=ke*qe+be+rt;O(Re,ge)}}}function Y(R){const O=Math.random()<.25,L=Math.random()<.72,U=L?N():[N(),N()],ee=L&&Math.random()<.42,se=ee&&q(U),Z=L&&(Math.random()<.2||U===n.White)?se||N():null,oe=!ee&&U!==n.White&&Math.random()<.42,P=O?1.1:1.25;return{shellSize:R,spreadSize:300+R*100,starLife:900+R*200,starDensity:P,color:U,secondColor:Z,glitter:O?"light":"",glitterColor:Math.random()<.5?n.Gold:n.White,pistil:ee,pistilColor:se,streamers:oe}}function q(R){return R===n.White||R===n.Gold?N():Math.random()<.5?n.Gold:n.White}class fe{starLifeVariation;color;glitterColor;starCount;spreadSize;starLife;glitter;secondColor;strobe;strobeColor;horsetail;ring;constructor(O){if(Object.assign(this,O),this.starLifeVariation=O.starLifeVariation||.125,this.color=O.color||N(),this.glitterColor=O.glitterColor||(typeof this.color=="string"?this.color:N()),!this.starCount){const L=O.starDensity||1,U=(this.spreadSize||300)/54;this.starCount=Math.max(6,U*U*L)}}launch(O,L){const U=d,ee=$,se=60,Z=50,P=ee-ee*.45,ge=O*(U-se*2)+se,D=ee,Ae=P-L*(P-Z),ke=D-Ae,be=Math.pow(ke*.04,.64),Se=y.add(ge,D,typeof this.color=="string"&&this.color!=="random"?this.color:n.White,Math.PI,be*(this.horsetail?1.2:1),be*(this.horsetail?100:400));Se.heavy=!0,Se.spinRadius=Math.random()*(.85-.32)+.32,Se.sparkFreq=32,Se.sparkLife=320,Se.sparkLifeVariation=3,Se.onDeath=()=>this.burst(Se.x,Se.y)}burst(O,L){const U=(this.spreadSize||0)/96;let ee=this.color,se=0,Z=0,oe=0,P=.25;this.glitter==="light"?(se=400,Z=.3,oe=600,P=2):this.glitter==="medium"?(se=200,Z=.44,oe=1400,P=2):this.glitter==="heavy"&&(se=80,Z=.8,oe=2800,P=2),se=se/1;const ge=(D,Ae)=>{const ke=(this.spreadSize||0)/1800,be=y.add(O,L,ee||N(),D,Ae*U,this.starLife+Math.random()*this.starLife*this.starLifeVariation,(this.horsetail,0),this.horsetail?0:-ke);this.secondColor&&(be.transitionTime=this.starLife*(Math.random()*.05+.32),be.secondColor=this.secondColor),this.strobe&&(be.transitionTime=this.starLife*(Math.random()*.08+.46),be.strobe=!0,this.strobeColor&&(be.secondColor=this.strobeColor)),this.glitter&&(be.sparkFreq=se,be.sparkSpeed=Z,be.sparkLife=oe,be.sparkLifeVariation=P,be.sparkColor=this.glitterColor,be.sparkTimer=Math.random()*be.sparkFreq)};if(typeof this.color=="string")if(this.color==="random"?ee=N():ee=this.color,this.ring){const D=Math.random()*Math.PI,Ae=Math.pow(Math.random(),2)*.85+.15;ue(0,t,this.starCount,0,ke=>{const be=Math.sin(ke)*U*Ae,Se=Math.cos(ke)*U,qe=Math.sqrt(be*be+Se*Se),rt=Math.atan2(Se,be)+D,Re=y.add(O,L,ee,rt,qe,this.starLife+Math.random()*this.starLife*this.starLifeVariation);this.glitter&&(Re.sparkFreq=se,Re.sparkSpeed=Z,Re.sparkLife=oe,Re.sparkLifeVariation=P,Re.sparkColor=this.glitterColor,Re.sparkTimer=Math.random()*Re.sparkFreq)})}else pe(this.starCount,ge);else if(Array.isArray(this.color))if(Math.random()<.5){const D=Math.random()*Math.PI,Ae=D+Math.PI,ke=Math.PI;ee=this.color[0],pe(this.starCount/2,ge,D,ke),ee=this.color[1],pe(this.starCount/2,ge,Ae,ke)}else ee=this.color[0],pe(this.starCount/2,ge),ee=this.color[1],pe(this.starCount/2,ge);ce.add(O,L,this.spreadSize/4)}}function Ie(){const R=window.innerWidth,O=window.innerHeight,L=Math.min(R,ia),U=R<=420?O:Math.min(O,ca);d=L,$=U,w.value&&i.value&&(w.value.width=L,w.value.height=U,i.value.width=L,i.value.height=U)}function je(R){T&&(We(R)?h=!0:Ge(R.clientX,R.clientY,!0))}function Ne(){h=!1}function He(R){T&&h&&We(R)}function We(R){if(h||R.clientY>=(i.value?.height||0)-44){const L=i.value?.width||0,U=(R.clientX-16)/(L-32);return I=Math.min(Math.max(U,0),1),f=1,!0}return!1}function Ge(R,O,L){const U=Date.now();if(U-S<va&&L)return;S=U,tt();const ee=new fe(Y(pa*(1+(Math.random()-.5)/2))),se=d,Z=$,oe=R/se,P=1-O/Z;ee.launch(oe,P)}async function tt(){try{if(V||(V=new(window.AudioContext||window.webkitAudioContext)),!A){const ee=await(await fetch("/audio/fireworks.mp3")).arrayBuffer();A=await V.decodeAudioData(ee)}const R=Math.random()*(z[1]-z[0])+z[0],O=V.createBufferSource();O.buffer=A,O.connect(V.destination);const L=V.currentTime+R/1e3;O.start(L)}catch(R){console.log("Audio playback failed:",R);const O=new Audio("/audio/fireworks.mp3");O.volume=.5,O.play().catch(L=>{console.log("HTML5 audio playback also failed:",L)})}}function Ye(){E=!document.hidden,E?b=!1:(b=!0,H())}function H(){for(m.forEach(R=>{const O=y.active[R];for(;O.length>0;){const L=O.pop();y.returnInstance(L)}}),m.forEach(R=>{const O=F.active[R];for(;O.length>0;){const L=O.pop();F.returnInstance(L)}});ce.active.length>0;){const R=ce.active.pop();ce.returnInstance(R)}}function j(){p++,h||(f-=1/30,f<0&&(f=0))}function _e(){if(!T)return;const R=16.6667*I,O=I,L=1-(1-y.airDrag)*O,U=1-(1-y.airDragHeavy)*O,ee=1-(1-F.airDrag)*O,se=R/1e3*ua;j(),m.forEach(Z=>{const oe=y.active[Z];for(let ge=oe.length-1;ge>=0;ge--){const D=oe[ge];if(D.updateFrame!==p)if(D.updateFrame=p,D.life-=R,D.life<=0)oe.splice(ge,1),y.returnInstance(D);else{const Ae=Math.pow(D.life/D.fullLife,.5),ke=1-Ae;if(D.prevX=D.x,D.prevY=D.y,D.x+=D.speedX*O,D.y+=D.speedY*O,D.heavy?(D.speedX*=U,D.speedY*=U):(D.speedX*=L,D.speedY*=L),D.speedY+=se,D.sparkFreq)for(D.sparkTimer-=R;D.sparkTimer<0;)D.sparkTimer+=D.sparkFreq*.75+D.sparkFreq*ke*4,F.add(D.x,D.y,D.sparkColor,Math.random()*t,Math.random()*D.sparkSpeed*Ae,D.sparkLife*.8+Math.random()*D.sparkLifeVariation*D.sparkLife);D.life<D.transitionTime&&(D.secondColor&&!D.colorChanged&&(D.colorChanged=!0,D.color=D.secondColor,oe.splice(ge,1),y.active[D.secondColor].push(D),D.secondColor===Bt&&(D.sparkFreq=0)),D.strobe&&(D.visible=Math.floor(D.life/D.strobeFreq)%3===0))}}const P=F.active[Z];for(let ge=P.length-1;ge>=0;ge--){const D=P[ge];D.life-=R,D.life<=0?(P.splice(ge,1),F.returnInstance(D)):(D.prevX=D.x,D.prevY=D.y,D.x+=D.speedX*O,D.y+=D.speedY*O,D.speedX*=ee,D.speedY*=ee,D.speedY+=se)}}),lt()}function lt(){const R=w.value,O=i.value;if(!R||!O)return;const L=R.getContext("2d"),U=O.getContext("2d");if(!L||!U)return;const ee=d,se=$;L.clearRect(0,0,ee,se),U.clearRect(0,0,ee,se),L.globalCompositeOperation="lighten",L.lineWidth=y.drawWidth,L.lineCap="round",U.strokeStyle="#fff",U.lineWidth=1,U.beginPath(),u.forEach(Z=>{const oe=y.active[Z];L.strokeStyle=Z,L.beginPath(),oe.forEach(P=>{P.visible&&(L.moveTo(P.x,P.y),L.lineTo(P.prevX,P.prevY),U.moveTo(P.x,P.y),U.lineTo(P.x-P.speedX*1.6,P.y-P.speedY*1.6))}),L.stroke()}),U.stroke(),L.lineWidth=F.drawWidth,L.lineCap="butt",u.forEach(Z=>{const oe=F.active[Z];L.strokeStyle=Z,L.beginPath(),oe.forEach(P=>{L.moveTo(P.x,P.y),L.lineTo(P.prevX,P.prevY)}),L.stroke()}),f&&(U.globalAlpha=f,U.fillStyle=n.Blue,U.fillRect(0,se-6,ee*I,6),U.globalAlpha=1)}return xe(async()=>{await Te(),Ie(),window.addEventListener("resize",Ie),window.addEventListener("pointerdown",je),window.addEventListener("pointerup",Ne),window.addEventListener("pointermove",He),document.addEventListener("visibilitychange",Ye),T=!0,b=!1,E=!document.hidden,k=setInterval(()=>{if(T&&!b&&E){const O=Math.random()<.7?1:Math.floor(Math.random()*5)+1;for(let L=0;L<O;L++)Ge(Math.random()*d,Math.random()*$*.5,!1)}},3e3);function R(O){const L=O-C;L>=a&&E&&(_e(),C=O-L%a),_=requestAnimationFrame(R)}C=performance.now(),_=requestAnimationFrame(R)}),Le(()=>{window.removeEventListener("resize",Ie),window.removeEventListener("pointerdown",je),window.removeEventListener("pointerup",Ne),window.removeEventListener("pointermove",He),document.removeEventListener("visibilitychange",Ye),cancelAnimationFrame(_),clearInterval(k)}),(R,O)=>(r(),v("div",ra,[e("canvas",{ref_key:"trailsCanvas",ref:w,class:"trails-canvas"},null,512),e("canvas",{ref_key:"mainCanvas",ref:i,class:"main-canvas"},null,512)]))}}),fa=ie(ha,[["__scopeId","data-v-5b839940"]]),ma=800,dt=50,pt=.4,ga={__name:"GameBackground",setup(s){const t=ye(),l=x(),a=x();let n=null;const o=x(!0),u=x(200),m=x(.4),w=x(["rgb(173, 216, 230)","rgb(176, 224, 230)","rgb(241, 141, 252)","rgb(176, 230, 224)","rgb(173, 230, 216)"]),i=x(!0),d=x(1),$=x(1.5),I=K(()=>({backgroundImage:t.currentBackground?`url(${t.currentBackground})`:"url(@/assets/images/default_bg.jpg)"})),p=f=>{console.debug("Starfield ready",f)},h=(f,b)=>{n&&(clearInterval(n),n=null);const T=pt/(ma/dt),E=()=>new Promise(A=>{if(f.paused||f.volume<=0){f.volume=0,A();return}n=setInterval(()=>{f.volume>0?f.volume=Math.max(0,f.volume-T):(clearInterval(n),n=null,f.pause(),A())},dt)}),V=()=>{f.src=b,f.load(),f.volume=0;const A=f.play();A!==void 0&&A.then(()=>{n=setInterval(()=>{f.volume<pt?f.volume=Math.min(pt,f.volume+T):(clearInterval(n),n=null)},dt)}).catch(S=>{console.error("èƒŒæ™¯éŸ³ä¹è‡ªåŠ¨æ’­æ”¾å¤±è´¥:",S)})};E().then(()=>{if(!b||b==="None"){f.src="";return}V()})};return ae(()=>t.currentSoundEffect,f=>{l.value&&f&&f!=="None"&&(l.value.src=f,l.value.load(),l.value.play())}),ae(()=>t.currentBackgroundMusic,f=>{console.log("è§¦å‘äº†æ–°çš„èƒŒæ™¯éŸ³ä¹ï¼šnewAudioUrl: ",f),a.value&&h(a.value,f)}),(f,b)=>(r(),v(X,null,[e("div",{class:"game-background",style:$e(I.value)},[c(t).currentBackgroundEffect==="StarField"?(r(),de(is,{key:0,ref:"starfieldRef",enabled:o.value,"star-count":u.value,"scroll-speed":m.value,colors:w.value,onReady:p},null,8,["enabled","star-count","scroll-speed","colors"])):G("",!0),c(t).currentBackgroundEffect==="Rain"?(r(),de(sa,{key:1,enabled:i.value,intensity:d.value},null,8,["enabled","intensity"])):G("",!0),c(t).currentBackgroundEffect==="Sakura"?(r(),de(oa,{key:2,enabled:!0,intensity:1.5})):G("",!0),c(t).currentBackgroundEffect==="Snow"?(r(),de(la,{key:3,intensity:$.value,enabled:!0},null,8,["intensity"])):G("",!0),c(t).currentBackgroundEffect==="Fireworks"?(r(),de(fa,{key:4,enabled:!0,intensity:1.5})):G("",!0)],4),e("audio",{ref_key:"soundEffectPlayer",ref:l},null,512),e("audio",{ref_key:"backgroundMusicPlayer",ref:a,loop:""},null,512)],64))}},ba=ie(ga,[["__scopeId","data-v-83caa056"]]),ya={name:"GlassInput",inheritAttrs:!1,props:{modelValue:{type:String,default:""}},emits:["update:modelValue"]},xa={class:"form-group"},wa=["value"];function _a(s,t,l,a,n,o){return r(),v("div",xa,[e("input",Xt({type:"text",class:"form-control",value:l.modelValue,onInput:t[0]||(t[0]=u=>s.$emit("update:modelValue",u.target.value))},s.$attrs),null,16,wa)])}const ka=ie(ya,[["render",_a],["__scopeId","data-v-5fc9dd1e"]]),Ca=["min","max","step"],$a=ne({__name:"Slider",props:{modelValue:{type:[Number,String],default:0},min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},step:{type:[Number,String],default:1},disabled:{type:Boolean,default:!1},accentColor:{type:String,default:"#4fc3f7"}},emits:["change","input"],setup(s,{emit:t}){const l=s,a=jt(),n=x(Number(l.modelValue)),o=K(()=>{if(a.default){const m=a.default();if(m&&m[0]&&typeof m[0].children=="string")return m[0].children.split("/")[0]||""}return""}),u=K(()=>{if(a.default){const m=a.default();if(m&&m[0]&&typeof m[0].children=="string")return m[0].children.split("/")[1]||""}return""});return(m,w)=>(r(),v("div",null,[e("span",null,[Ee(m.$slots,"left",{},()=>[W(B(o.value),1)],!0)]),Q(e("input",{type:"range",min:s.min,max:s.max,step:s.step,"onUpdate:modelValue":w[0]||(w[0]=i=>n.value=i),onChange:w[1]||(w[1]=i=>m.$emit("change",Number(n.value)))},null,40,Ca),[[we,n.value]]),e("span",null,[Ee(m.$slots,"right",{},()=>[W(B(u.value),1)],!0)])]))}}),Ze=ie($a,[["__scopeId","data-v-f434cf84"]]),Sa={__name:"Text",props:{speed:{type:Number,default:0}},setup(s){const t=s,l=x(),a=jt().default()[0].children;xe(()=>{o(t.speed)}),ae(()=>t.speed,()=>o(t.speed));let n;const o=u=>{clearInterval(n),l.value="";let m=0;const w=200,d=w-(u-1)/99*(w-10);n=setInterval(()=>{m<a.length?(l.value+=a.charAt(m),m++):(clearInterval(n),setTimeout(()=>{o(t.speed)},1e3))},d)};return(u,m)=>(r(),v("div",null,[e("p",null,B(l.value),1),m[0]||(m[0]=e("span",null,null,-1))]))}},Ma=ie(Sa,[["__scopeId","data-v-7409bb3c"]]),Ia=["id","checked"],Aa=["for"],Ta=ne({__name:"Toggle",props:{checked:{type:Boolean,default:!1}},emits:["change"],setup(s,{emit:t}){const l=x(),a=x();return xe(()=>{l.value=Math.random().toString(36).substring(2,9)}),(n,o)=>(r(),v("div",null,[Q(e("input",{type:"checkbox",id:l.value,checked:s.checked,onChange:o[0]||(o[0]=u=>n.$emit("change",a.value)),"onUpdate:modelValue":o[1]||(o[1]=u=>a.value=u)},null,40,Ia),[[Ot,a.value]]),e("label",{for:l.value},[Ee(n.$slots,"default",{},void 0,!0)],8,Aa)]))}}),Vt=ie(Ta,[["__scopeId","data-v-34dbb3da"]]);class Ea{element;timer=null;abortController;speed;isFinished;onFinishCallback;audioContext;soundBuffers;textBuffers;soundUrls;constructor(t){this.element=t,this.timer=null,this.abortController=null,this.speed=50,this.isFinished=!1,this.onFinishCallback=null,this.audioContext=null,this.soundBuffers=[],this.textBuffers="",this.soundUrls=["../audio_effects/å¯¹è¯.wav"]}async initAudio(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),await this.loadSounds()}catch(t){console.warn("éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥:",t);const l=ye();l.enableChatEffectSound=!1}}async loadSounds(){if(this.audioContext)try{const t=this.soundUrls.map(async l=>{const n=await(await fetch(l)).arrayBuffer();return this.audioContext.decodeAudioData(n)});this.soundBuffers=await Promise.all(t)}catch(t){console.warn("éŸ³æ•ˆåŠ è½½å¤±è´¥:",t)}}playRandomSound(){if(!ye().enableChatEffectSound||!this.audioContext||this.soundBuffers.length===0)return;const l=this.soundBuffers[Math.floor(Math.random()*this.soundBuffers.length)],a=this.audioContext.createBufferSource();l&&(a.buffer=l),a.playbackRate.value=1;const n=this.audioContext.createGain();n.gain.value=.8,a.connect(n),n.connect(this.audioContext.destination),a.start()}setSoundEnabled(t){const l=ye();l.enableChatEffectSound=t,t&&!this.audioContext&&this.initAudio()}async start(t,l){const a=ye();this.stop(),this.isFinished=!1,l!==void 0?this.speed=Number.isInteger(l)?l:Number.parseInt(l.toString(),10)||50:(console.warn("é€Ÿåº¦å€¼æœªå®šä¹‰ï¼Œå°†é‡‡ç”¨é»˜è®¤é€Ÿåº¦ã€‚"),this.speed=50),this.abortController=new AbortController;let n=0;this.textBuffers="",a.enableChatEffectSound&&!this.audioContext&&await this.initAudio();const o=()=>{if(!this.abortController?.signal.aborted)if(n<t.length){this.textBuffers+=t.charAt(n),this.element.value=this.textBuffers,this.element.textContent=this.textBuffers,this.playRandomSound(),n++,this.element.scrollTop=this.element.scrollHeight;const u=this.speed*.8,m=this.speed*.4,w=u+Math.random()*m;this.timer=setTimeout(o,w)}else this.finish()};o()}finish(){this.stop(),this.isFinished=!0,this.element.style.borderRight="none",this.onFinishCallback&&this.onFinishCallback()}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.abortController&&(this.abortController.abort(),this.abortController=null),this.isFinished=!1}clear(){this.element.value="",this.element.textContent="",this.textBuffers=""}checkFinished(){return this.isFinished}onFinish(t){this.onFinishCallback=t}}function Ba(s){const t=x(null),l=x(!1),a=()=>{s.value&&(t.value=new Ea(s.value))},n=async(u,m)=>{t.value||a(),l.value=!0,await t.value?.start(u,m),l.value=!1},o=()=>{t.value?.stop(),t.value?.clear(),l.value=!1};return Le(()=>{o()}),{startTyping:n,stopTyping:o,isTyping:l}}const Va={class:"chatbox-main"},Ra={class:"chatbox-title-part"},za={class:"chatbox-title"},Da={id:"character"},La={class:"chatbox-subtitle"},ja={id:"character-sub"},Oa={class:"chatbox-emotion"},Fa={id:"character-emotion"},Pa={class:"chatbox-inputbox"},Ua=["placeholder","onKeydown","readonly"],Na=["disabled"],Ha=ne({__name:"GameDialog",emits:["player-continued","dialog-proceed"],setup(s,{expose:t,emit:l}){const a=x(""),n=x(null),o=Ve(),u=ye(),m=x(!1),{startTyping:w,stopTyping:i}=Ba(n),d=K(()=>o.currentStatus==="thinking"),$=l,I=()=>{u.toggleSettings(!0),u.setSettingsTab("history")},p=C=>{o.command==="touch"&&(C.preventDefault(),b())},h=C=>{m.value&&(C.preventDefault(),m.value=!1)},f=()=>{o.command==="touch"?b():(document.body.style.cursor=`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='lucide lucide-hand-icon lucide-hand'%3E%3Cpath d='M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2'/%3E%3Cpath d='M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2'/%3E%3Cpath d='M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8'/%3E%3Cpath d='M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15'/%3E%3C/svg%3E") 0 0, auto`,o.command="touch",document.addEventListener("contextmenu",p))},b=()=>{document.body.style.cursor="default",o.command=null,document.removeEventListener("contextmenu",p)},T=K(()=>{switch(o.currentStatus){case"input":return u.showPlayerHintLine||"åœ¨è¿™é‡Œè¾“å…¥æ¶ˆæ¯...";case"thinking":const C=o.currentInteractRole;return C?C.thinkMessage:"ç­‰å¾…å›åº”ä¸­...";case"responding":case"presenting":return"";default:return"åœ¨è¿™é‡Œè¾“å…¥æ¶ˆæ¯..."}}),E=K(()=>o.currentStatus==="input");ae(()=>o.currentStatus,C=>{if(console.log("æ¸¸æˆçŠ¶æ€å˜ä¸º :",C),C==="thinking"){const _=o.currentInteractRole;_&&(_.emotion="AIæ€è€ƒ",u.showCharacterTitle=_.roleName,u.showCharacterSubtitle=_.roleSubTitle)}else C==="input"?(u.showCharacterTitle=o.userName,u.showCharacterSubtitle=o.userSubtitle,u.showCharacterEmotion=""):C==="presenting"&&(u.showCharacterTitle="",u.showCharacterSubtitle="",u.showCharacterEmotion="",u.showCharacterLine="")}),ae([()=>u.showCharacterLine,()=>o.currentStatus],([C,_])=>{C&&C!==""&&_==="responding"?(a.value="",w(C,u.typeWriterSpeed)):_==="input"&&(i(),a.value="")}),xe(()=>{document.addEventListener("contextmenu",h)}),Le(()=>{document.removeEventListener("contextmenu",h)});function V(){o.currentStatus==="input"?A():o.currentStatus==="responding"&&S(!0)}function A(){const C=a.value;C.trim()&&(C==="/å¼€å§‹å‰§æœ¬"||(o.currentStatus="thinking",o.appendGameMessage({type:"message",displayName:o.userName,content:C})),gt.sendMessage(C),a.value="")}function S(C){const _=Ft.continue();return _||(C&&$("player-continued"),$("dialog-proceed")),_}function z(C){m.value=!0}return t({continueDialog:S}),(C,_)=>(r(),v("div",{class:J(["chatbox-box",{"chatbox-hidden":m.value}])},[e("div",Va,[e("div",Ra,[e("div",za,[e("div",Da,B(c(u).showCharacterTitle),1)]),e("div",La,[e("div",ja,B(c(u).showCharacterSubtitle),1)]),e("div",Oa,[e("div",Fa,B(c(u).showCharacterEmotion),1)]),g(c(te),{type:"nav",icon:"hand",title:"",onClick:f,onContextmenu:Me(b,["prevent"])}),g(c(te),{type:"nav",icon:"history",title:"",onClick:I}),g(c(te),{type:"nav",icon:"close",title:"",onClick:z})]),_[1]||(_[1]=e("div",{class:"chatbox-line"},null,-1)),e("div",Pa,[Q(e("textarea",{id:"inputMessage",ref_key:"textareaRef",ref:n,placeholder:T.value,"onUpdate:modelValue":_[0]||(_[0]=k=>a.value=k),onKeydown:mt(Me(V,["exact","prevent"]),["enter"]),readonly:!E.value},null,40,Ua),[[we,a.value]]),e("button",{id:"sendButton",disabled:d.value,onClick:V},"â–¼",8,Na)])])],2))}}),Rt="/api/v1",me={AVATAR:{BASE:`${Rt}/chat/character/get_avatar`},VOICE:{BASE:`${Rt}/chat/sound/get_voice`}},Wa={åŒæ¶:"åŒæ¶",é«˜å…´:"é«˜å…´",æ‹…å¿ƒ:"æ‹…å¿ƒ",ç”Ÿæ°”:"ç”Ÿæ°”",ç´§å¼ :"ç´§å¼ ",å®³æ€•:"å®³æ€•",å®³ç¾:"å®³ç¾",æ…Œå¼ :"æ…Œå¼ ",è®¤çœŸ:"è®¤çœŸ",æ— å¥ˆ:"æ— å¥ˆ",å…´å¥‹:"å…´å¥‹",ç–‘æƒ‘:"ç–‘æƒ‘",å“­æ³£:"ä¼¤å¿ƒ",å¿ƒåŠ¨:"å¿ƒåŠ¨",è°ƒçš®:"è°ƒçš®",éš¾ä¸ºæƒ…:"ç¾è€»",è‡ªä¿¡:"è‡ªä¿¡",æƒŠè®¶:"æƒŠè®¶",æ­£å¸¸:"æ­£å¸¸",å¹³é™:"å¹³é™",AIæ€è€ƒ:"none"},Ga={åŒæ¶:{animation:"none",bubbleImage:"../pictures/animation/ç”Ÿæ°”.webp",bubbleClass:"angry",audio:"../audio_effects/åŒæ¶.wav",avatar:`${me.AVATAR.BASE}/åŒæ¶.png`},é«˜å…´:{animation:"happy-bounce",bubbleImage:"../pictures/animation/é«˜å…´.webp",bubbleClass:"happy",audio:"../audio_effects/å–œæ‚¦.wav",avatar:`${me.AVATAR.BASE}/é«˜å…´.png`},æ‹…å¿ƒ:{animation:"none",bubbleImage:"../pictures/animation/æµæ³ª.webp",bubbleClass:"none",audio:"../audio_effects/ä¼¤å¿ƒ.wav",avatar:`${me.AVATAR.BASE}/æ‹…å¿ƒ.png`},ç”Ÿæ°”:{animation:"angry-jump",bubbleImage:"../pictures/animation/ç”Ÿæ°”2.webp",bubbleClass:"angry",audio:"../audio_effects/ç”Ÿæ°”.wav",avatar:`${me.AVATAR.BASE}/ç”Ÿæ°”.png`},ç´§å¼ :{animation:"none",bubbleImage:"../pictures/animation/ç´§å¼ .webp",bubbleClass:"none",audio:"../audio_effects/å°´å°¬.wav",avatar:`${me.AVATAR.BASE}/ç´§å¼ .png`},å®³æ€•:{animation:"none",bubbleImage:"../pictures/animation/æƒŠè®¶.webp",bubbleClass:"none",audio:"../audio_effects/éœ‡æƒŠ.wav",avatar:`${me.AVATAR.BASE}/å®³æ€•.png`},å®³ç¾:{animation:"none",bubbleImage:"../pictures/animation/å®³ç¾.webp",bubbleClass:"shy",audio:"../audio_effects/å®³ç¾.wav",avatar:`${me.AVATAR.BASE}/å®³ç¾.png`},æ…Œå¼ :{animation:"none",bubbleImage:"../pictures/animation/æ…Œä¹±.webp",bubbleClass:"none",audio:"../audio_effects/éœ‡æƒŠ.wav",avatar:`${me.AVATAR.BASE}/æ…Œå¼ .png`},è®¤çœŸ:{animation:"serious-think",bubbleImage:"none",bubbleClass:"none",audio:"none",avatar:`${me.AVATAR.BASE}/è®¤çœŸ.png`},æ— å¥ˆ:{animation:"none",bubbleImage:"../pictures/animation/å¹æ°”.webp",bubbleClass:"none",audio:"../audio_effects/å¹æ°”.wav",avatar:`${me.AVATAR.BASE}/æ— å¥ˆ.png`},å…´å¥‹:{animation:"happy-bounce",bubbleImage:"../pictures/animation/èŠå¤©.webp",bubbleClass:"none",audio:"../audio_effects/èŠå¤©.wav",avatar:`${me.AVATAR.BASE}/å…´å¥‹.png`},ç–‘æƒ‘:{animation:"none",bubbleImage:"../pictures/animation/ç–‘é—®.webp",bubbleClass:"none",audio:"../audio_effects/ç–‘é—®.wav",avatar:`${me.AVATAR.BASE}/ç–‘æƒ‘.png`},å“­æ³£:{animation:"none",bubbleImage:"../pictures/animation/æµæ³ª.webp",bubbleClass:"none",audio:"../audio_effects/ä¼¤å¿ƒ.wav",avatar:`${me.AVATAR.BASE}/ä¼¤å¿ƒ.png`},å¿ƒåŠ¨:{animation:"heart-beat",bubbleImage:"../pictures/animation/å¿ƒåŠ¨.webp",bubbleClass:"none",audio:"../audio_effects/å–œçˆ±.wav",avatar:`${me.AVATAR.BASE}/å¿ƒåŠ¨.png`},è°ƒçš®:{animation:"naughty-bounce",bubbleImage:"../pictures/animation/é«˜å…´.webp",bubbleClass:"none",audio:"../audio_effects/æ„‰å¿«.wav",avatar:`${me.AVATAR.BASE}/è°ƒçš®.png`},éš¾ä¸ºæƒ…:{animation:"embarrassed-emo",bubbleImage:"../pictures/animation/éš¾ä¸ºæƒ….webp",bubbleClass:"none",audio:"../audio_effects/å¯Ÿè§‰.wav",avatar:`${me.AVATAR.BASE}/ç¾è€».png`},è‡ªä¿¡:{animation:"none",bubbleImage:"../pictures/animation/é«˜å…´.webp",bubbleClass:"none",audio:"../audio_effects/æ„‰å¿«.wav",avatar:`${me.AVATAR.BASE}/è‡ªä¿¡.png`},æƒŠè®¶:{animation:"none",bubbleImage:"../pictures/animation/æƒŠè®¶.webp",bubbleClass:"none",audio:"../audio_effects/å¯Ÿè§‰.wav",avatar:`${me.AVATAR.BASE}/æƒŠè®¶.png`},å¹³é™:{animation:"none",bubbleImage:"none",bubbleClass:"none",audio:"none",avatar:`${me.AVATAR.BASE}/å¹³é™.png`},æ­£å¸¸:{animation:"none",bubbleImage:"none",bubbleClass:"none",audio:"none",avatar:`${me.AVATAR.BASE}/æ­£å¸¸.png`},AIæ€è€ƒ:{animation:"none",bubbleImage:"../pictures/animation/AIæ€è€ƒ.webp",bubbleClass:"none",audio:"../audio_effects/æ— è¯­.wav",avatar:"none"}},Ya=["viewBox"],qa=["points"],Xa=300,Ja=ne({__name:"TouchAreas",props:{gameStore:{},part:{default:()=>({X:[],Y:[],windowWidth:1920,windowHeight:1200,message:""})},partKey:{default:""}},emits:["player-continued","dialog-proceed"],setup(s,{emit:t}){const l=s,a=Ve();ye();const n=t,o=x(!1),u=x(0),m=x(0),w=x(window.innerWidth),i=x(window.innerHeight),d=K(()=>{const f=i.value/l.part.windowHeight,b=w.value/2,T=i.value/2,E=l.part.windowWidth/2,V=l.part.windowHeight/2,A=[];for(let S=0;S<l.part.X.length;S++){const z=l.part.X[S]*l.part.windowWidth,C=l.part.Y[S]*l.part.windowHeight,_=z-E,k=C-V,y=_*f,F=k*f,ce=b+y,le=T+F;A.push(`${ce},${le}`)}return A.join(" ")}),$=K(()=>l.gameStore.command==="show"?1:(l.gameStore.command==="unshow",.001)),I=(f,b,T)=>{let E=!1;for(let V=0,A=T.length-1;V<T.length;A=V++)(T[V]?.[1]??0>b)!==(T[A]?.[1]??0>b)&&f<((T[A]?.[0]??0)-(T[V]?.[0]??0))*(b-(T[V]?.[1]??0))/((T[A]?.[1]??0)-(T[V]?.[1]??0))+(T[V]?.[0]??0)&&(E=!E);return E},p=f=>{if(a.command!=="touch")return;const b=Date.now();if(!(b-u.value<Xa)&&(u.value=b,a.command==="touch"&&f.target&&a.currentStatus=="input")){const T=f.target.getBoundingClientRect();f.clientX-T.left,f.clientY-T.top;const E=i.value/l.part.windowHeight,V=w.value/2,A=i.value/2,S=l.part.windowWidth/2,z=l.part.windowHeight/2,C=l.part.X.map((_,k)=>{const y=_*l.part.windowWidth,F=l.part.Y[k]*l.part.windowHeight,ce=y-S,le=F-z,N=ce*E,ue=le*E,pe=V+N,Y=A+ue;return[pe,Y]});if(o.value)Ft.continue()||(n("player-continued"),n("dialog-proceed")),o.value=!1;else{a.currentStatus="thinking",m.value++;const _=m.value===1?l.part.message:`${l.part.message},è¿™æ˜¯ç¬¬${m.value}æ¬¡`;`${a.userName}`,I(f.clientX,f.clientY,C),gt.sendMessage(_),o.value=!0}}},h=()=>{w.value=window.innerWidth,i.value=window.innerHeight};return xe(()=>{window.addEventListener("resize",h)}),Le(()=>{window.removeEventListener("resize",h)}),(f,b)=>(r(),v("div",{style:$e({opacity:$.value}),class:"touch-areas-container"},[(r(),v("svg",{class:"polygon-area",viewBox:`0 0 ${w.value} ${i.value}`,onClick:p},[e("polygon",{points:d.value,fill:"none",stroke:"white","stroke-width":"3","stroke-dasharray":"8,4",class:"polygon-shape"},null,8,qa)],8,Ya))],4))}}),Ka=ie(Ja,[["__scopeId","data-v-bd0caa41"]]),Za=ne({__name:"GameRoleAvatar",props:{role:{}},setup(s){const t=s,l=Ve(),{role:a}=Jt(t),n=x(null),o=x("normal"),u=x(""),m=x(""),w=x(!1),i=x(!1),d=x(""),$=x("");let I=null,p=null;const h=K(()=>{const C=l.presentRoleIds,_=C.indexOf(a.value.roleId),k=C.length;return _===-1?50:(_+1)/(k+1)*100}),f=K(()=>{const C=h.value,_=a.value.offsetX||0;return{left:`calc(${C}% + ${_}px)`,top:`${a.value.offsetY}px`,transform:`translateX(-50%) scale(${a.value.scale})`,opacity:`${a.value.show?1:0}`,zIndex:1}}),b=K(()=>({[o.value]:!0})),T=K(()=>({show:i.value,[$.value]:i.value&&$.value})),E=K(()=>({left:`${+a.value.bubbleLeft+5}%`,top:`${+a.value.bubbleTop-5}%`,backgroundImage:`url(${d.value})`})),V=K(()=>{const C=a.value,_=C.clothesName??"default",k=C.emotion,y=Wa[k]||"æ­£å¸¸";return k==="AIæ€è€ƒ"?"none":`/api/v1/chat/character/get_avatar/${C.roleId}/${y}/${_}`}),A=async C=>{if(!C||C==="none")return;let _;const k=new Promise(ce=>{_=ce});p=k;const y=`${C}`,F=new Image;F.src=y;try{await F.decode()}catch(ce){console.error(`è§’è‰²[${a.value.roleName}]åŠ è½½å¤´åƒå¤±è´¥: ${C}`,ce)}p===k&&(w.value&&(u.value=m.value,w.value=!1,await Te()),m.value=y,requestAnimationFrame(()=>{w.value=!0})),_()},S=()=>{w.value&&(u.value=m.value,w.value=!1)};ae(V,C=>A(C),{immediate:!0}),ae(()=>a.value.emotion,async C=>{await Te(),p&&await p;const _=Ga[C];if(_){if(_.animation&&_.animation!=="none"&&(o.value=_.animation),_.bubbleImage&&_.bubbleImage!=="none"){const k=Date.now();d.value=`${_.bubbleImage}?t=${k}#t=0.1`,$.value=_.bubbleClass,i.value=!1,Te(()=>{i.value=!0,I!==null&&window.clearTimeout(I),I=window.setTimeout(()=>{i.value=!1,I=null},2e3)})}_.audio&&_.audio!=="none"&&n.value&&(n.value.src=_.audio,n.value.load(),n.value.play())}},{immediate:!0});const z=()=>{o.value!=="normal"&&(o.value="normal")};return(C,_)=>(r(),de(Pe,{name:"character-fade"},{default:M(()=>[e("div",{class:"role-avatar-container absolute",style:$e(f.value),onAnimationend:z},[e("div",{class:J(["w-full h-full absolute",b.value])},[e("div",{class:"avatar-layer base-layer",style:$e({backgroundImage:`url(${u.value})`})},null,4),e("div",{class:J(["avatar-layer overlay-layer",{"is-fading-in":w.value}]),style:$e({backgroundImage:`url(${m.value})`}),onTransitionend:S},null,38)],2),(r(!0),v(X,null,re(c(a).bodyPart,(k,y)=>(r(),de(Ka,{key:y,"game-store":c(l),part:k,"part-key":String(y),"role-id":c(a).roleId},null,8,["game-store","part","part-key","role-id"]))),128)),e("div",{class:J([T.value,"bubble"]),style:$e(E.value)},null,6),e("audio",{ref_key:"bubbleAudio",ref:n},null,512)],36)]),_:1}))}}),Qa=ie(Za,[["__scopeId","data-v-3cbb1056"]]),el={class:"absolute w-full h-full overflow-hidden"},tl=ne({__name:"GameRolesStage",emits:["audio-ended"],setup(s,{emit:t}){const l=Ve(),a=ye(),n=t,o=x(null);ae(()=>a.currentAvatarAudio,m=>{o.value&&m&&m!=="None"&&(o.value.src=`${me.VOICE.BASE}/${m}`,o.value.load(),o.value.play().catch(w=>console.error("æ’­æ”¾å¤±è´¥",w)))}),ae(()=>a.characterVolume,m=>{o.value&&(o.value.volume=m/100)});const u=()=>{n("audio-ended")};return(m,w)=>(r(),v("div",el,[(r(!0),v(X,null,re(c(l).presentRolesList,(i,d)=>(r(),de(Qa,{key:i.roleId,role:i},null,8,["role"]))),128)),e("audio",{ref_key:"mainAudio",ref:o,onEnded:u},null,544)]))}}),sl={class:"main-box"},nl={id:"menu-panel"},Zc=ne({__name:"MainChat",setup(s){const t=ye(),l=Ve(),a=bt(),n=x(null),o=()=>{t.toggleSettings(!0),t.setSettingsTab("text")},u=()=>{t.autoMode=!t.autoMode},m=async()=>{try{await l.initializeGame(a.client_id,"1")}catch(h){console.log(h)}};xe(()=>{a.client_id!==""&&m()}),ae(()=>a.client_id,p=>{p&&m()});let w=null;const i=x(!1),d=()=>{i.value=!1,w&&(clearTimeout(w),w=null)},$=()=>{if(t.autoMode){if(i.value){console.log("çˆ¶ç»„ä»¶ï¼šéŸ³é¢‘ç»“æŸäº†ï¼Œä½†ç”¨æˆ·å·²æ‰‹åŠ¨ç»§ç»­ï¼Œä¸åšä»»ä½•äº‹ã€‚");return}l.currentStatus==="responding"&&(w&&clearTimeout(w),w=setTimeout(()=>{n.value?n.value.continueDialog(!1)&&$():console.error("æ— æ³•æ‰¾åˆ° GameDialog çš„å®ä¾‹ã€‚")},1e3))}},I=()=>{console.log("ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»äº†"),w&&(clearTimeout(w),w=null,console.log("çˆ¶ç»„ä»¶ï¼šå·²å–æ¶ˆè‡ªåŠ¨ç»§ç»­çš„å®šæ—¶å™¨ã€‚")),i.value?console.log("çˆ¶ç»„ä»¶ï¼šç”¨æˆ·é‡å¤ç‚¹å‡»ï¼Œä½†æ–¹æ³•å·²æ‰§è¡Œè¿‡ï¼Œä¸å†è°ƒç”¨ã€‚"):i.value=!0};return(p,h)=>(r(),v("div",sl,[g(ea),g(c(ba)),g(c(tl),{ref:"gameAvatarRef",onAudioEnded:$},null,512),g(c(Ha),{ref_key:"gameDialogRef",ref:n,onPlayerContinued:I,onDialogProceed:d},null,512),e("div",nl,[Q(g(c(te),{type:"nav",icon:"play",onClick:u,class:J([{active:c(t).autoMode}])},{default:M(()=>[...h[0]||(h[0]=[e("h3",null,"è‡ªåŠ¨",-1)])]),_:1},8,["class"]),[[Ce,c(t).showSettings!==!0]]),Q(g(c(te),{type:"nav",icon:"text",onClick:o},{default:M(()=>[...h[1]||(h[1]=[e("h3",null,"èœå•",-1)])]),_:1},512),[[Ce,c(t).showSettings!==!0]])])]))}}),ol={class:"w-full flex items-center pb-2 mb-4 border-b-2 border-brand space-x-2"},al={class:"title-wrapper"},ll={class:"content"},rl=ne({__name:"MenuItem",props:{title:{type:String,default:"é»˜è®¤æ ‡é¢˜"},size:{type:String,default:"large",validator:s=>["small","large"].includes(s)}},setup(s){return(t,l)=>(r(),v("section",{class:J(["menu-item",s.size])},[e("div",ol,[Ee(t.$slots,"header",{},void 0,!0),e("div",al,[e("h4",null,B(s.title),1)])]),e("div",ll,[Ee(t.$slots,"default",{},void 0,!0)])],2))}}),ve=ie(rl,[["__scopeId","data-v-d82055ab"]]),il={},cl={class:"flex flex-1 px-3 py-6 text-white text-shadow-2xs mx-auto items-start w-[70%] min-h-0 max-h-full overflow-y-auto flex-wrap gap-5"};function ul(s,t){return r(),v("div",cl,[Ee(s.$slots,"default")])}const ze=ie(il,[["render",ul]]),dl=async s=>{try{return await Be.get("/v1/chat/history/list",{params:s})}catch(t){throw new Error(t.response?.data?.message||"è·å–å­˜æ¡£åˆ—è¡¨å¤±è´¥")}},pl=async s=>{try{await Be.post("/v1/chat/history/create",s)}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£åˆ›å»ºå¤±è´¥")}},vl=async s=>{try{return await Be.get("/v1/chat/history/load",{params:s})}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£åŠ è½½å¤±è´¥")}},hl=async s=>{try{await Be.post("/v1/chat/history/save",s)}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£ä¿å­˜å¤±è´¥")}},fl=async s=>{try{await Be.post("/v1/chat/history/delete",s)}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£åˆ é™¤å¤±è´¥")}},ml={class:"new-save-form"},gl={class:"save-section"},bl={class:"save-list-container"},yl={key:0,class:"status-message"},xl={key:1,class:"status-message error"},wl={key:2,class:"status-message"},_l={key:3,class:"save-list"},kl={class:"save-info"},Cl={class:"save-title"},$l={class:"save-date"},Sl={class:"save-actions"},Ml=["onClick"],Il=["onClick"],Al=["onClick"],Oe="1",Tl=ne({__name:"SettingsSave",setup(s){const t=Ve(),l=bt(),a=x([]),n=x(""),o=x(!1),u=x(null),m=p=>{const h=new Date(p);return`${h.getFullYear()}.${h.getMonth()+1}.${h.getDate()}`},w=async()=>{o.value=!0,u.value=null;try{const p=await dl({user_id:Oe,page:1,page_size:10});console.log("è·å–å­˜æ¡£åˆ—è¡¨æˆåŠŸ:",p),a.value=p.saves}catch(p){console.error("è·å–å­˜æ¡£åˆ—è¡¨å¤±è´¥:",p),u.value=p.message||"æœªçŸ¥é”™è¯¯"}finally{o.value=!1}},i=async()=>{if(!n.value.trim()){alert("è¯·è¾“å…¥å­˜æ¡£åç§°ï¼");return}try{await pl({user_id:Oe,title:n.value.trim()}),n.value="",await w()}catch(p){console.error("åˆ›å»ºå­˜æ¡£å¤±è´¥:",p),alert(`åˆ›å»ºå¤±è´¥: ${p.message}`)}},d=async p=>{try{const h=await vl({user_id:Oe,conversation_id:p});alert(`å­˜æ¡£ [${p}] è¯»å–æˆåŠŸ!`),t.initializeGame(l.client_id,Oe)}catch(h){console.error("è¯»å–å­˜æ¡£å¤±è´¥:",h),alert(`è¯»å–å¤±è´¥: ${h.message}`)}},$=async p=>{try{await hl({user_id:Oe,conversation_id:p}),alert(`æˆåŠŸè¦†ç›–å­˜æ¡£ [${p}]!`),await w()}catch(h){console.error("ä¿å­˜æ¸¸æˆå¤±è´¥:",h),alert(`ä¿å­˜å¤±è´¥: ${h.message}`)}},I=async p=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­˜æ¡£å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"))try{await fl({user_id:Oe,conversation_id:p}),await w()}catch(h){console.error("åˆ é™¤å­˜æ¡£å¤±è´¥:",h),alert(`åˆ é™¤å¤±è´¥: ${h.message}`)}};return xe(()=>{w()}),(p,h)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"åˆ›å»ºæ–°å­˜æ¡£"},{default:M(()=>[e("div",ml,[g(c(ka),{type:"text",modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=f=>n.value=f),placeholder:"è¾“å…¥å­˜æ¡£åç§°",onKeyup:mt(i,["enter"])},null,8,["modelValue"]),e("button",{class:"glass-effect action-btn-create",onClick:i},"åˆ›å»º")])]),_:1}),g(c(ve),{title:"å­˜æ¡£åˆ—è¡¨"},{default:M(()=>[e("div",gl,[e("div",bl,[o.value?(r(),v("div",yl,"åŠ è½½ä¸­...")):u.value?(r(),v("div",xl,"åŠ è½½å¤±è´¥: "+B(u.value),1)):a.value.length===0?(r(),v("div",wl,"æš‚æ— å­˜æ¡£è®°å½•")):(r(),v("div",_l,[(r(!0),v(X,null,re(a.value,f=>(r(),v("div",{key:f.id,class:"save-card glass-effect"},[e("div",kl,[e("span",Cl,B(f.title||"æœªå‘½åå­˜æ¡£"),1),e("span",$l,B(m(f.update_date)),1)]),e("div",Sl,[e("button",{onClick:b=>d(f.id),class:"glass-effect action-btn-load"}," è¯»å– ",8,Ml),e("button",{onClick:b=>$(f.id),class:"action-btn-save glass-effect"}," ä¿å­˜ ",8,Il),e("button",{onClick:b=>I(f.id),class:"action-btn-delete glass-effect"}," åˆ é™¤ ",8,Al)])]))),128))]))])])]),_:1})]),_:1}))}}),El=ie(Tl,[["__scopeId","data-v-81a5d946"]]),Bl=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Vl=Object.prototype.toString,Rl=s=>Vl.call(s)==="[object Object]",zl=()=>{};function Dl(...s){if(s.length!==1)return Zt(...s);const t=s[0];return typeof t=="function"?Pt(Qt(()=>({get:t,set:zl}))):x(t)}function Ll(s,t){function l(...a){return new Promise((n,o)=>{Promise.resolve(s(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(n).catch(o)})}return l}const Gt=s=>s();function jl(s=Gt,t={}){const{initialState:l="active"}=t,a=Dl(l==="active");function n(){a.value=!1}function o(){a.value=!0}const u=(...m)=>{a.value&&s(...m)};return{isActive:Pt(a),pause:n,resume:o,eventFilter:u}}function vt(s){return Array.isArray(s)?s:[s]}function Ol(s){return Kt()}function Fl(s,t,l={}){const{eventFilter:a=Gt,...n}=l;return ae(s,Ll(a,t),n)}function Pl(s,t,l={}){const{eventFilter:a,initialState:n="active",...o}=l,{eventFilter:u,pause:m,resume:w,isActive:i}=jl(a,{initialState:n});return{stop:Fl(s,t,{...o,eventFilter:u}),pause:m,resume:w,isActive:i}}const Ul=Pl;function Nl(s,t=!0,l){Ol()?xe(s,l):t?s():Te(s)}function Hl(s,t,l){return ae(s,t,{...l,immediate:!0})}const Qe=Bl?window:void 0;function Wl(s){var t;const l=Fe(s);return(t=l?.$el)!==null&&t!==void 0?t:l}function zt(...s){const t=(a,n,o,u)=>(a.addEventListener(n,o,u),()=>a.removeEventListener(n,o,u)),l=K(()=>{const a=vt(Fe(s[0])).filter(n=>n!=null);return a.every(n=>typeof n!="string")?a:void 0});return Hl(()=>{var a,n;return[(a=(n=l.value)===null||n===void 0?void 0:n.map(o=>Wl(o)))!==null&&a!==void 0?a:[Qe].filter(o=>o!=null),vt(Fe(l.value?s[1]:s[0])),vt(c(l.value?s[2]:s[1])),Fe(l.value?s[3]:s[2])]},([a,n,o,u],m,w)=>{if(!a?.length||!n?.length||!o?.length)return;const i=Rl(u)?{...u}:u,d=a.flatMap($=>n.flatMap(I=>o.map(p=>t($,I,p,i))));w(()=>{d.forEach($=>$())})},{flush:"post"})}const st=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nt="__vueuse_ssr_handlers__",Gl=Yl();function Yl(){return nt in st||(st[nt]=st[nt]||{}),st[nt]}function ql(s,t){return Gl[s]||t}function Xl(s){return s==null?"any":s instanceof Set?"set":s instanceof Map?"map":s instanceof Date?"date":typeof s=="boolean"?"boolean":typeof s=="string"?"string":typeof s=="object"?"object":Number.isNaN(s)?"any":"number"}const Jl={boolean:{read:s=>s==="true",write:s=>String(s)},object:{read:s=>JSON.parse(s),write:s=>JSON.stringify(s)},number:{read:s=>Number.parseFloat(s),write:s=>String(s)},any:{read:s=>s,write:s=>String(s)},string:{read:s=>s,write:s=>String(s)},map:{read:s=>new Map(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s.entries()))},set:{read:s=>new Set(JSON.parse(s)),write:s=>JSON.stringify(Array.from(s))},date:{read:s=>new Date(s),write:s=>s.toISOString()}},Dt="vueuse-storage";function et(s,t,l,a={}){var n;const{flush:o="pre",deep:u=!0,listenToStorageChanges:m=!0,writeDefaults:w=!0,mergeDefaults:i=!1,shallow:d,window:$=Qe,eventFilter:I,onError:p=N=>{console.error(N)},initOnMounted:h}=a,f=(d?es:x)(t),b=K(()=>Fe(s));if(!l)try{l=ql("getDefaultStorage",()=>Qe?.localStorage)()}catch(N){p(N)}if(!l)return f;const T=Fe(t),E=Xl(T),V=(n=a.serializer)!==null&&n!==void 0?n:Jl[E],{pause:A,resume:S}=Ul(f,N=>y(N),{flush:o,deep:u,eventFilter:I});ae(b,()=>ce(),{flush:o});let z=!1;const C=N=>{h&&!z||ce(N)},_=N=>{h&&!z||le(N)};$&&m&&(l instanceof Storage?zt($,"storage",C,{passive:!0}):zt($,Dt,_)),h?Nl(()=>{z=!0,ce()}):ce();function k(N,ue){if($){const pe={key:b.value,oldValue:N,newValue:ue,storageArea:l};$.dispatchEvent(l instanceof Storage?new StorageEvent("storage",pe):new CustomEvent(Dt,{detail:pe}))}}function y(N){try{const ue=l.getItem(b.value);if(N==null)k(ue,null),l.removeItem(b.value);else{const pe=V.write(N);ue!==pe&&(l.setItem(b.value,pe),k(ue,pe))}}catch(ue){p(ue)}}function F(N){const ue=N?N.newValue:l.getItem(b.value);if(ue==null)return w&&T!=null&&l.setItem(b.value,V.write(T)),T;if(!N&&i){const pe=V.read(ue);return typeof i=="function"?i(pe,T):E==="object"&&!Array.isArray(pe)?{...T,...pe}:pe}else return typeof ue!="string"?ue:V.read(ue)}function ce(N){if(!(N&&N.storageArea!==l)){if(N&&N.key==null){f.value=T;return}if(!(N&&N.key!==b.value)){A();try{const ue=V.write(f.value);(N===void 0||N?.newValue!==ue)&&(f.value=F(N))}catch(ue){p(ue)}finally{N?Te(S):S()}}}}function le(N){ce(N.detail)}return f}const Kl={class:"settings-text-container"},Zl=ne({__name:"SettingsText",setup(s){const t=ts(),l=x(),a=ye(),n=()=>{a.toggleSettings(!1),t.push("/")},o=et("lingchat-text-speed",50);ae([o],([i])=>{a.typeWriterSpeed=i,l.value=i},{immediate:!0});const u=i=>{o.value=i,l.value=i,a.typeWriterSpeed=i},m=i=>{console.log(i)},w=i=>{a.enableChatEffectSound=i};return(i,d)=>(r(),v("div",Kl,[g(c(ze),null,{default:M(()=>[g(c(ve),{title:"æ–‡å­—æ˜¾ç¤ºé€Ÿåº¦"},{header:M(()=>[g(c(Ht),{size:20})]),default:M(()=>[g(c(Ze),{onChange:u,modelValue:c(o),"onUpdate:modelValue":d[0]||(d[0]=$=>Ke(o)?o.value=$:null)},{default:M(()=>[...d[1]||(d[1]=[W("æ…¢/å¿«",-1)])]),_:1},8,["modelValue"])]),_:1}),g(c(ve),{title:"æ˜¾ç¤ºæ–‡å­—æ ·æœ¬"},{header:M(()=>[g(c(Xs),{size:20})]),default:M(()=>[g(c(Ma),{speed:l.value},{default:M(()=>[...d[2]||(d[2]=[W("Ling Chat: æµ‹è¯•æ–‡æœ¬æ˜¾ç¤ºé€Ÿåº¦",-1)])]),_:1},8,["speed"])]),_:1}),g(c(ve),{title:"é¡µé¢åˆ‡æ¢åŠ¨ç”»",size:"small"},{header:M(()=>[g(c(ot),{size:20})]),default:M(()=>[g(c(Vt),{onChange:m},{default:M(()=>[...d[3]||(d[3]=[W("å¯ç”¨åŠ¨ç”»æ•ˆæœ",-1)])]),_:1})]),_:1}),g(c(ve),{title:"è¯­éŸ³éŸ³æ•ˆå¼€å…³",size:"small"},{header:M(()=>[g(c(Js),{size:20})]),default:M(()=>[g(c(Vt),{onChange:w},{default:M(()=>[...d[4]||(d[4]=[W("å¯ç”¨æ— vitsæ—¶çš„å¯¹è¯éŸ³æ•ˆ",-1)])]),_:1})]),_:1}),g(c(ve),{title:"WebSocketé€šä¿¡çŠ¶æ€",size:"small"},{header:M(()=>[g(c(sn),{size:20})]),default:M(()=>[d[5]||(d[5]=e("p",null,"âˆš è¿æ¥æ­£å¸¸",-1))]),_:1}),g(c(ve),{title:"å½“å‰ä½¿ç”¨çš„AIå¤§æ¨¡å‹",size:"small"},{header:M(()=>[g(c(nn),{size:20})]),default:M(()=>[d[6]||(d[6]=e("p",null,"DeepSeek V3",-1))]),_:1}),g(c(ve),{title:"è¿”å›ä¸»èœå•",size:"small"},{header:M(()=>[g(c(Ps),{size:20})]),default:M(()=>[g(c(te),{type:"big",onClick:n},{default:M(()=>[...d[7]||(d[7]=[W("è¿”å›ä¸»èœå•",-1)])]),_:1})]),_:1})]),_:1})]))}}),Ql=ie(Zl,[["__scopeId","data-v-0a65c60c"]]),er=async()=>{try{return await Be.get("/v1/chat/back-music/list")}catch(s){throw new Error(s.response?.data?.message||"è·å–éŸ³ä¹åˆ—è¡¨å¤±è´¥")}},tr=async s=>{try{await Be.post("/v1/chat/back-music/upload",s)}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£ä¸Šä¼ å¤±è´¥")}},sr=async s=>{try{await Be.delete("/v1/chat/back-music/delete",{params:{url:s}})}catch(t){throw new Error(t.response?.data?.detail||"å­˜æ¡£ä¸Šä¼ å¤±è´¥")}},nr={class:"sound-test"},or={class:"music-controls"},ar={class:"music-name"},lr={class:"music-list-container"},rr={key:0,class:"empty-list"},ir=["onClick"],cr={class:"music-item-name"},ur={class:"music-upload"},dr=ne({__name:"SettingsSound",setup(s){const t=ye(),l=et("lingchat-character-volume",50),a=et("lingchat-bubble-volume",50),n=et("lingchat-background-volume",50),o=et("lingchat-achievement-volume",50);ae([l,a,n,o],([Y,q,fe,Ie])=>{t.characterVolume=Y,t.bubbleVolume=q,t.backgroundVolume=fe,t.achievementVolume=Ie},{immediate:!0});const u=x(null),m=x(null),w=x(null),i=x(null),d=x([]),$=x("æœªé€‰æ‹©éŸ³ä¹"),I=x(!1),p=x(null),h=x(null),f=Y=>{l.value=Y,u.value&&(u.value.volume=Y/100)},b=Y=>{a.value=Y,m.value&&(m.value.volume=Y/100)},T=Y=>{n.value=Y,i.value&&(i.value.volume=Y/100)},E=Y=>{o.value=Y,w.value&&(w.value.volume=Y/100)};ae(()=>t.backgroundVolume,Y=>{n.value=Y,i.value&&(i.value.volume=Y/100)});const V=()=>{u.value&&(u.value.src="/audio_effects/è§’è‰²éŸ³é‡æµ‹è¯•.wav",u.value.play().catch(Y=>console.error("æµ‹è¯•è§’è‰²éŸ³é‡æ’­æ”¾å¤±è´¥:",Y)))},A=()=>{m.value&&(m.value.src="/audio_effects/ç–‘é—®.wav",m.value.play().catch(Y=>console.error("æµ‹è¯•æ°”æ³¡éŸ³é‡æ’­æ”¾å¤±è´¥:",Y)))},S=()=>{w.value&&(w.value.src="/audio_effects/achievement_common.wav",w.value.play().catch(Y=>console.error("æµ‹è¯•æˆå°±éŸ³é‡æ’­æ”¾å¤±è´¥:",Y)))},z=async()=>{d.value=await er()},C=async Y=>{if(!Y){console.log("musicå¯¹è±¡ä¸å­˜åœ¨");return}if(confirm(`ç¡®å®šè¦åˆ é™¤ã€Š${Y.name}ã€‹å—ï¼Ÿ`))try{await sr(Y.url),console.log(`æ­£åœ¨åˆ é™¤éŸ³ä¹: ${Y.url}`),alert(`ã€Š${Y.name}ã€‹åˆ é™¤æˆåŠŸ`),await z()}catch(q){console.error("åˆ é™¤éŸ³ä¹å¤±è´¥:",q),alert("åˆ é™¤éŸ³ä¹å¤±è´¥")}},_=async()=>{if(!p.value){alert("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªéŸ³ä¹æ–‡ä»¶");return}const Y=p.value,q=[".mp3",".wav",".flac",".webm",".weba",".ogg",".m4a"],fe=Y.name.slice(Y.name.lastIndexOf(".")).toLowerCase();if(!q.includes(fe)){alert("ä¸æ”¯æŒçš„éŸ³é¢‘æ ¼å¼ã€‚è¯·ä¸Šä¼ : "+q.join(", "));return}const Ie=new FormData;Ie.append("file",Y);try{await tr(Ie),console.log(`æ­£åœ¨ä¸Šä¼ æ–‡ä»¶: ${Y.name}`),alert("éŸ³ä¹ä¸Šä¼ æˆåŠŸ"),p.value=null,h.value&&(h.value.value=""),await z()}catch(je){console.error("ä¸Šä¼ éŸ³ä¹å¤±è´¥:",je),alert("éŸ³ä¹ä¸Šä¼ å¤±è´¥")}},k=K(()=>I.value?"â¸ æš‚åœ":"â–¶ æ’­æ”¾"),y=Y=>{if(!i.value)return;const q=`/api/v1/chat/back-music/music_file/${encodeURIComponent(Y.url)}`;i.value.src=q,i.value.play().catch(fe=>console.error("æ’­æ”¾éŸ³ä¹å¤±è´¥:",fe)),$.value=Y.name,I.value=!0},F=()=>{i.value&&(I.value?i.value.pause():!i.value.src&&d.value.length>0?y(d.value[0]||{name:"",url:""}):i.value.play().catch(Y=>console.error("æ¢å¤æ’­æ”¾å¤±è´¥:",Y)),I.value=!i.value.paused)},ce=()=>{i.value&&(i.value.pause(),i.value.currentTime=0,I.value=!1)},le=()=>{h.value?.click()},N=Y=>{const q=Y.target;q.files&&q.files.length>0?p.value=q.files?.[0]||null:p.value=null},ue=()=>{i.value&&(I.value=!i.value.paused)},pe=()=>{I.value=!1};return xe(()=>{z(),u.value&&(u.value.volume=l.value/100),m.value&&(m.value.volume=a.value/100),w.value&&(w.value.volume=o.value/100),i.value&&(i.value.volume=n.value/100)}),(Y,q)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"ğŸ‘© è§’è‰²éŸ³é‡",size:"small"},{default:M(()=>[g(c(Ze),{modelValue:c(l),"onUpdate:modelValue":q[0]||(q[0]=fe=>Ke(l)?l.value=fe:null),onChange:f},{default:M(()=>[...q[4]||(q[4]=[W(" å¼±/å¼º ",-1)])]),_:1},8,["modelValue"])]),_:1}),g(c(ve),{title:"ğŸ’¬ æ°”æ³¡éŸ³é‡",size:"small"},{default:M(()=>[g(c(Ze),{onChange:b,modelValue:c(a),"onUpdate:modelValue":q[1]||(q[1]=fe=>Ke(a)?a.value=fe:null)},{default:M(()=>[...q[5]||(q[5]=[W(" å¼±/å¼º ",-1)])]),_:1},8,["modelValue"])]),_:1}),g(c(ve),{title:"ğŸ¶ èƒŒæ™¯éŸ³é‡",size:"small"},{default:M(()=>[g(c(Ze),{onChange:T,modelValue:c(n),"onUpdate:modelValue":q[2]||(q[2]=fe=>Ke(n)?n.value=fe:null)},{default:M(()=>[...q[6]||(q[6]=[W(" å¼±/å¼º ",-1)])]),_:1},8,["modelValue"])]),_:1}),g(c(ve),{title:"ğŸ† æˆå°±éŸ³é‡",size:"small"},{default:M(()=>[g(c(Ze),{onChange:E,modelValue:c(o),"onUpdate:modelValue":q[3]||(q[3]=fe=>Ke(o)?o.value=fe:null)},{default:M(()=>[...q[7]||(q[7]=[W(" å¼±/å¼º ",-1)])]),_:1},8,["modelValue"])]),_:1}),g(c(ve),{title:"ğŸ”Š å£°éŸ³æµ‹è¯•",size:"small"},{default:M(()=>[e("div",nr,[g(c(te),{type:"big",onClick:V},{default:M(()=>[...q[8]||(q[8]=[W("æµ‹è¯•è§’è‰²éŸ³é‡",-1)])]),_:1}),g(c(te),{type:"big",onClick:A},{default:M(()=>[...q[9]||(q[9]=[W("æµ‹è¯•æ°”æ³¡éŸ³é‡",-1)])]),_:1}),g(c(te),{type:"big",onClick:S},{default:M(()=>[...q[10]||(q[10]=[W("æµ‹è¯•æˆå°±éŸ³é‡",-1)])]),_:1})])]),_:1}),g(c(ve),{title:"âš™ èƒŒæ™¯éŸ³ä¹è®¾ç½®"},{default:M(()=>[e("div",or,[g(c(te),{type:"big",onClick:F,class:"left-button"},{default:M(()=>[W(B(k.value),1)]),_:1}),g(c(te),{type:"big",onClick:ce,class:"left-button"},{default:M(()=>[...q[11]||(q[11]=[W("â–  åœæ­¢",-1)])]),_:1}),e("span",ar,"å½“å‰: "+B($.value),1)]),e("div",lr,[d.value.length===0?(r(),v("div",rr,"æš‚æ— éŸ³ä¹ï¼Œè¯·ä¸Šä¼ ")):G("",!0),(r(!0),v(X,null,re(d.value,fe=>(r(),v("div",{key:fe.url,class:"music-item",onClick:Ie=>y(fe)},[e("div",cr,B(fe.name),1),g(c(te),{onClick:Ie=>C(fe),class:"action-btn-delete glass-effect"},{default:M(()=>[...q[12]||(q[12]=[W("åˆ é™¤",-1)])]),_:1},8,["onClick"])],8,ir))),128))]),e("div",ur,[g(c(te),{type:"big",onClick:le},{default:M(()=>[...q[13]||(q[13]=[W("â• æ·»åŠ éŸ³ä¹",-1)])]),_:1}),e("input",{ref_key:"fileInput",ref:h,type:"file",onChange:N,accept:".mp3,.wav,.flac,.webm,.weba,.ogg,.m4a",style:{display:"none"}},null,544),g(c(te),{type:"big",onClick:_,disabled:!p.value},{default:M(()=>[...q[14]||(q[14]=[W("ç¡®è®¤ä¸Šä¼ ",-1)])]),_:1},8,["disabled"])])]),_:1}),e("audio",{ref_key:"characterTestPlayer",ref:u},null,512),e("audio",{ref_key:"bubbleTestPlayer",ref:m},null,512),e("audio",{ref_key:"achievementTestPlayer",ref:w},null,512),e("audio",{ref_key:"backgroundAudioPlayer",ref:i,loop:"",onTimeupdate:ue,onEnded:pe},null,544)]),_:1}))}}),pr=ie(dr,[["__scopeId","data-v-265768ff"]]),vr={class:"flex-1 h-[85vh] w-full bg-white/10 p-0 md:p-4 rounded-lg overflow-hidden"},hr={class:"block md:grid grid-cols-[280px_1fr] h-full min-h-0"},fr={key:0,class:"fixed inset-0 bg-white/80 flex justify-center items-center z-50"},mr={class:"text-base font-bold px-3.75 py-2.5 block rounded-lg mb-1 text-brand bg-white/10 backdrop-blur-xl backdrop-saturate-150 border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.1),inset_0_1px_1px_rgba(255,255,255,0.1)]"},gr=["onClick"],br={class:"flex justify-center h-full overflow-auto relative -top-full md:top-0 px-10 py-10 md:px-10 md:py-0"},yr={key:0,class:"w-full active"},xr={class:"pt-2.5 overflow-auto"},wr={class:"pb-4 mb-6 border-b border-brand"},_r={class:"m-0 text-2xl text-brand font-semibold"},kr={class:"mt-2 text-base"},Cr={class:"inline-flex items-center cursor-pointer font-medium text-brand"},$r=["id","checked","onChange"],Sr={class:"text-sm mt-1 mb-2 text-gray-300"},Mr=["for"],Ir={class:"text-sm mt-1 mb-2 text-gray-300"},Ar=["id","onUpdate:modelValue"],Tr=["for"],Er={class:"text-sm mt-1 mb-2 text-gray-300"},Br=["id","onUpdate:modelValue"],Vr={class:"w-18 px-5 py-2.5 bg-brand text-white border-none rounded-lg cursor-pointer text-sm font-medium transition-colors duration-200 hover:bg-[#0056b3]"},Rr={key:1,class:"w-full active"},zr=ne({__name:"SettingsAdvance",emits:["remove-more-menu-from-b"],setup(s,{expose:t,emit:l}){const a=x(!1),n=x({}),o=at({category:null,subcategory:null}),u=at({message:"",color:"var(--success-color)"}),m=l,w=x(null),i=x(null),d=K(()=>o.category&&o.subcategory?n.value[o.category]?.subcategories[o.subcategory]:null),$=(A,S)=>o.category===A&&o.subcategory===S,I=(A,S)=>{o.category=A,o.subcategory=S},p=(A,S)=>{A.value=S?"true":"false"},h=async()=>{if(!d.value)return;const A={};d.value.settings.forEach(S=>{A[S.key]=S.value}),a.value=!0,u.message="";try{const S=await fetch("/api/settings/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),z=await S.json();if(!S.ok)throw new Error(z.detail||"ä¿å­˜å¤±è´¥");u.message=z.message,u.color="var(--success-color)",await f(!1)}catch(S){u.message=`é”™è¯¯: ${S.message}`,u.color="red"}finally{a.value=!1,setTimeout(()=>{u.message=""},5e3)}},f=async(A=!0)=>{a.value=!0;try{const S=await fetch("/api/settings/config");if(!S.ok)throw new Error("æ— æ³•åŠ è½½é…ç½®");if(n.value=await S.json(),A&&Object.keys(n.value).length>0){const z=Object.keys(n.value)[0];if(z){const C=Object.keys(n.value[z]?.subcategories||{})[0];z&&C&&I(z,C)}}}catch(S){console.error(S),u.message=`åŠ è½½é…ç½®å¤±è´¥: ${S.message}`,u.color="red"}finally{a.value=!1}},b=()=>{if(!w.value||!i.value)return;const A=w.value.querySelector(".adv-nav-link.active");if(A){const S=A.offsetTop,z=A.offsetHeight;S&&(i.value.style.top=`${S}px`),z&&(i.value.style.height=`${z}px`)}},T=()=>{if(!w.value)return;new ResizeObserver(S=>{b()}).observe(w.value)};ae(o,async()=>{await Te(),b()},{deep:!0}),xe(async()=>{await f(),await Te(),b(),T()});const E=()=>{const A=w.value;A&&A.classList.add("moreMenu")},V=()=>{const A=w.value;A&&A.classList.remove("moreMenu"),m("remove-more-menu-from-b")};return t({addMoreMenu:E}),(A,S)=>(r(),de(c(ze),null,{default:M(()=>[e("div",vr,[e("div",hr,[a.value?(r(),v("div",fr,[...S[1]||(S[1]=[e("div",{class:"border-5 border-gray-200 border-t-brand rounded-full w-12 h-12 animate-spin"},null,-1)])])):G("",!0),e("nav",{ref_key:"navContainerRef",ref:w,onClick:S[0]||(S[0]=()=>V()),class:"-left-full md:left-0 blur transition-all duration-300 ease-[cubic-bezier(0.18,0.89,0.32,1.00)] md:blur-none h-full p-5 flex flex-col justify-start gap-6.25 overflow-y-auto relative border-r border-brand md:moreMenu:left-0"},[e("div",{ref_key:"indicatorRef",ref:i,class:"absolute left-5 w-[calc(100%-40px)] bg-brand rounded-lg z-0 transition-all duration-300 ease-[cubic-bezier(0.18,0.89,0.32,1.00)]"},null,512),(r(!0),v(X,null,re(n.value,(z,C)=>(r(),v("div",{key:C,class:"flex flex-col gap-1 w-full"},[e("span",mr,B(C),1),(r(!0),v(X,null,re(z.subcategories,(_,k)=>(r(),v("a",{key:k,href:"#",class:J(["block px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold",{active:$(C,k.toString())}]),onClick:Me(y=>I(C,k.toString()),["prevent"])},B(k),11,gr))),128))]))),128))],512),e("main",br,[d.value?(r(),v("div",yr,[e("div",xr,[e("header",wr,[e("h2",_r,B(o.subcategory),1),e("p",kr,B(d.value.description||`ä¿®æ”¹ ${o.subcategory} çš„ç›¸å…³é…ç½®`),1)]),e("form",{onSubmit:Me(h,["prevent"])},[(r(!0),v(X,null,re(d.value.settings,z=>(r(),v("div",{key:z.key,class:"mb-6"},[z.type==="bool"?(r(),v(X,{key:0},[e("label",Cr,[e("input",{class:"mr-2.5 w-4 h-4",type:"checkbox",id:z.key,checked:z.value.toLowerCase()==="true",onChange:C=>p(z,C.target.checked)},null,40,$r),W(" "+B(z.key),1)]),e("p",Sr,B(z.description||""),1)],64)):z.type==="textarea"?(r(),v(X,{key:1},[e("label",{class:"inline-flex items-center cursor-pointer font-medium text-brand",for:z.key},B(z.key),9,Mr),e("p",Ir,B(z.description||"æ”¯æŒå¤šè¡Œè¾“å…¥"),1),Q(e("textarea",{id:z.key,"onUpdate:modelValue":C=>z.value=C,class:"w-full px-3 py-2.5 border rounded-lg text-sm text-white bg-white/10 backdrop-blur-xl backdrop-saturate-150 border-white/10 shadow-glass focus:outline-none focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all duration-200",rows:"8"},null,8,Ar),[[we,z.value]])],64)):(r(),v(X,{key:2},[e("label",{class:"inline-flex items-center cursor-pointer font-medium text-brand",for:z.key},B(z.key),9,Tr),e("p",Er,B(z.description||""),1),Q(e("input",{type:"text",id:z.key,"onUpdate:modelValue":C=>z.value=C,class:"w-full px-3 py-2.5 border rounded-lg text-sm text-white bg-white/10 backdrop-blur-xl backdrop-saturate-150 border-white/10 shadow-glass focus:outline-none focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all duration-200"},null,8,Br),[[we,z.value]])],64))]))),128))],32),e("div",Vr,[e("button",{onClick:h},"ä¿å­˜"),e("p",{style:$e({color:u.color})},B(u.message),5)])])])):!a.value&&!Object.keys(n.value).length?(r(),v("div",Rr,[...S[2]||(S[2]=[e("div",{class:"advanced-settings-container"},[e("header",null,[e("h2",{class:"adv-title"},"åŠ è½½å¤±è´¥"),e("p",{class:"adv-description"},"æ— æ³•åŠ è½½é…ç½®æˆ–é…ç½®ä¸ºç©ºã€‚")])],-1)])])):G("",!0)])])])]),_:1}))}}),Dr={class:"name"},Lr={class:"content"},jr=ne({__name:"DialogUser",props:{name:{type:String,require:!0},content:{type:String,require:!0}},setup(s){return(t,l)=>(r(),v(X,null,[e("span",Dr,B(s.name),1),l[0]||(l[0]=e("span",null,": ",-1)),e("span",Lr,B(s.content),1)],64))}}),Or=ie(jr,[["__scopeId","data-v-83c8a706"]]),Fr=["title"],Pr={class:"name"},Ur={class:"content"},Nr={class:"icon"},Hr=ne({__name:"DialogCharacter",props:{name:{type:String,require:!0},content:{type:String,require:!0},emotionTag:{type:String,require:!0},emotionText:{type:String,require:!0}},emits:["click"],setup(s,{emit:t}){return(l,a)=>(r(),v("div",{class:"message",title:`æƒ…æ„Ÿ: ${s.emotionTag}`},[e("span",Pr,B(s.name),1),a[1]||(a[1]=e("span",{class:"symbol"},":Â ",-1)),e("span",Ur,B(s.content),1),a[2]||(a[2]=e("span",{class:"symbol"},"Â ",-1)),e("span",Nr,[g(c(Ue),{icon:"volume",onClick:a[0]||(a[0]=n=>l.$emit("click"))})])],8,Fr))}}),Wr=ie(Hr,[["__scopeId","data-v-19dcc4bc"]]),Gr={class:"message-item"},Yr={key:0,class:"player-message"},qr={key:1,class:"chararter-reply"},Xr={key:2,class:"final-spacer"},Jr=ne({__name:"DialogSession",props:{dialog:{type:Array,require:!0}},setup(s){const t=x(null);function l(a){t.value.src=`${me.VOICE.BASE}/${a}`,t.value.play()}return(a,n)=>(r(),v(X,null,[(r(!0),v(X,null,re(s.dialog,o=>(r(),v("div",Gr,[o.type==="message"?(r(),v("div",Yr,[g(Or,{name:o.displayName,content:o.content},null,8,["name","content"])])):o.type==="reply"?(r(),v("div",qr,[g(Wr,{name:o.displayName,content:o.content,emotionTag:o.originalTag,emotionText:o.motionText,onClick:u=>l(o.audioFile)},null,8,["name","content","emotionTag","emotionText","onClick"])])):G("",!0),o.isFinal?(r(),v("div",Xr)):G("",!0)]))),256)),e("audio",{ref_key:"audio",ref:t,autoplay:""},null,512)],64))}}),Kr=ie(Jr,[["__scopeId","data-v-dd17f913"]]),Zr={class:"history-container"},Qr={key:0,class:"status-message"},ei={key:1,class:"chat-history-container",ref:"chatContainer"},ti=ne({__name:"SettingsHistory",setup(s){const t=Ve(),l=K(()=>t.dialogHistory);return(a,n)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"â—ˆ å†å²å¯¹è¯"},{default:M(()=>[e("div",Zr,[l.value.length===0?(r(),v("div",Qr," æš‚æ— å†å²è®°å½•ï¼Œå»å’ŒtaèŠèŠå¤©å­(*^â–½^*) ")):(r(),v("div",ei,[g(Kr,{dialog:l.value},null,8,["dialog"])],512))])]),_:1})]),_:1}))}}),si=ie(ti,[["__scopeId","data-v-fbbd12a1"]]),ni={class:"flex bg-white/10 backdrop-blur-[20px] backdrop-saturate-180 rounded-2xl shadow-[0_4px_12px_rgba(0,0,0,0.08)] overflow-hidden transition-all duration-300 ease-[cubic-bezier(0.25,0.8,0.25,1)] border border-black/5 h-auto w-full hover:-translate-y-0.75 hover:shadow-[0_6px_16px_rgba(0,0,0,0.12)] min-h-[11rem]"},oi={class:"w-32 flex items-center justify-center bg-[#f8f9fa] border-r border-black/5 max-md:w-24 shrink-0 overflow-hidden"},ai=["src","alt"],li={class:"flex-1 flex flex-col p-4 relative overflow-hidden"},ri={key:0,class:"absolute top-2 right-2 z-10"},ii={class:"font-semibold text-white mb-2 text-[18px] md:text-[20px] pr-8 text-shadow"},ci={class:"text-[#f8f9fa] leading-[1.4] overflow-y-auto mb-2 text-[12px] h-10 md:text-[13px] md:h-15 opacity-90 whitespace-pre-wrap max-h-[80px]"},ui={class:"character-actions"},di=ne({__name:"CharacterCard",props:{avatar:{},name:{},info:{},clothes:{},selectClothes:{},isClothesSelected:{}},setup(s){return(t,l)=>(r(),v("div",ni,[e("div",oi,[e("img",{src:s.avatar,alt:s.name,class:"w-full h-full object-cover transition-transform duration-500 hover:scale-107"},null,8,ai)]),e("div",li,[t.$slots.settings?(r(),v("div",ri,[Ee(t.$slots,"settings",{},void 0,!0)])):G("",!0),e("h5",ii,B(s.name),1),e("p",ci,B(s.info),1),e("div",ui,[Ee(t.$slots,"actions",{},void 0,!0)])])]))}}),pi=ie(di,[["__scopeId","data-v-f07e3b1e"]]),vi={},hi={class:"grid grid-cols-1 gap-5"};function fi(s,t){return r(),v("div",hi,[Ee(s.$slots,"default")])}const mi=ie(vi,[["render",fi]]),gi={class:"flex items-center justify-between p-6 border-b border-white/10 bg-[linear-gradient(180deg,rgba(255,255,255,0.1)_0%,rgba(255,255,255,0.05)_100%)]"},bi={class:"flex items-center gap-4"},yi={class:"w-12 h-12 rounded-xl bg-white/10 flex items-center justify-center shadow-inner"},xi={class:"text-xl font-bold m-0 drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]"},wi={class:"flex-1 overflow-hidden flex flex-row"},_i={class:"w-48 bg-black/10 flex flex-col gap-2 p-4 border-r border-white/10"},ki=["onClick"],Ci={class:"flex-1 overflow-y-auto p-6 relative"},$i={key:0,class:"flex items-center justify-center h-full"},Si={key:1,class:"max-w-3xl mx-auto space-y-6"},Mi={key:0,class:"space-y-4"},Ii=["for"],Ai=["id","onUpdate:modelValue","type","step"],Ti=["id","onUpdate:modelValue","rows"],Ei=["id","onUpdate:modelValue"],Bi=["value"],Vi={key:0,class:"p-4 bg-white/5 rounded-xl border border-white/10 space-y-4 mt-4"},Ri={class:"grid grid-cols-2 gap-4"},zi=["for"],Di=["id","onUpdate:modelValue"],Li={class:"p-4 border-t border-white/10 flex justify-end gap-3 bg-[linear-gradient(180deg,rgba(255,255,255,0.05)_0%,rgba(255,255,255,0.1)_100%)]"},ji=["disabled"],Oi={key:0,class:"inline-block w-3.5 h-3.5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"},Fi=ne({__name:"SettingsCharacterInfo",props:{visible:{type:Boolean},roleId:{},title:{}},emits:["close","saved"],setup(s,{emit:t}){const l=s,a=t,n=x("basic"),o=x(!1),u=x(!1),m=x({}),w=[{id:"basic",label:"åŸºæœ¬ä¿¡æ¯"},{id:"prompts",label:"æç¤ºè¯"},{id:"visuals",label:"è§†è§‰æ•ˆæœ"},{id:"voice",label:"è¯­éŸ³è®¾ç½®"}],i={basic:[{key:"ai_name",label:"AI åç§°",type:"text"},{key:"ai_subtitle",label:"AI å‰¯æ ‡é¢˜",type:"text"},{key:"user_name",label:"ç”¨æˆ·åç§°",type:"text"},{key:"user_subtitle",label:"ç”¨æˆ·å‰¯æ ‡é¢˜",type:"text"},{key:"title",label:"è§’è‰²æ ‡é¢˜",type:"text"},{key:"info",label:"è§’è‰²ä»‹ç»",type:"textarea",rows:4}],prompts:[{key:"system_prompt",label:"ç³»ç»Ÿæç¤ºè¯",type:"textarea",rows:10},{key:"system_prompt_example",label:"å¯¹è¯ç¤ºä¾‹",type:"textarea",rows:6},{key:"system_prompt_example_old",label:"æ—§ç‰ˆå…¼å®¹å¯¹è¯ç¤ºä¾‹",type:"textarea",rows:4}],visuals:[{key:"scale",label:"ç¼©æ”¾",type:"number",step:"0.01"},{key:"offset",label:"åç§»",type:"number"},{key:"bubble_top",label:"æ°”æ³¡é¡¶éƒ¨è·ç¦»",type:"number"},{key:"bubble_left",label:"æ°”æ³¡å·¦ä¾§è·ç¦»",type:"number"},{key:"thinking_message",label:"æ€è€ƒæ¶ˆæ¯æ–‡æœ¬",type:"text"}],voice:[{key:"tts_type",label:"TTS ç±»å‹",type:"select",options:[{label:"sva",value:"sva"},{label:"sbv2",value:"sbv2"},{label:"bv2",value:"bv2"},{label:"sbv2api",value:"sbv2api"},{label:"gsv",value:"gsv"},{label:"aivis",value:"aivis"}]},{key:"sva_speaker_id",label:"sva_speaker_id",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="sva"},{key:"sbv2_name",label:"sbv2_name",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="sbv2"},{key:"sbv2_speaker_id",label:"sbv2_speaker_id",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="sbv2"},{key:"bv2_speaker_id",label:"bv2_speaker_id",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="bv2"},{key:"sbv2api_name",label:"sbv2api_name",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="sbv2api"},{key:"sbv2api_speaker_id",label:"sbv2api_speaker_id",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="sbv2api"},{key:"gsv_voice_text",label:"gsv_voice_text",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="gsv"},{key:"gsv_voice_filename",label:"gsv_voice_filename",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="gsv"},{key:"aivis_model_uuid",label:"aivis_model_uuid",type:"text",isVoiceModel:!0,visibleIf:b=>b.tts_type==="aivis"}]},d=K(()=>i[n.value]),$=K(()=>(d.value||[]).filter(b=>!b.isVoiceModel)),I=K(()=>n.value!=="voice"?[]:(i.voice||[]).filter(b=>b.isVoiceModel&&(b.visibleIf?b.visibleIf(m.value):!0))),p=b=>K({get:()=>m.value[b.key],set:T=>{m.value[b.key]=T}});ae(()=>l.visible,async b=>{if(b&&l.roleId){o.value=!0;try{const T=await os(l.roleId);m.value=JSON.parse(JSON.stringify(T)),m.value.voice_models||(m.value.voice_models={})}catch(T){console.error("Failed to load character settings",T),a("close")}finally{o.value=!1}}});const h=()=>{a("close")},f=async()=>{if(l.roleId){u.value=!0;try{await ns(l.roleId,m.value),a("saved"),a("close")}catch(b){console.error("Failed to save settings",b),alert("ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—")}finally{u.value=!1}}};return(b,T)=>(r(),de(Pe,{name:"modal"},{default:M(()=>[s.visible?(r(),v("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",onClick:h},[e("div",{class:"bg-[linear-gradient(135deg,rgba(255,255,255,0.15)_0%,rgba(255,255,255,0.05)_100%)] backdrop-blur-[30px] backdrop-saturate-180 rounded-3xl shadow-[0_20px_60px_rgba(0,0,0,0.4),inset_0_0_1px_rgba(255,255,255,0.3)] border border-white/20 w-full max-w-4xl h-[85vh] flex flex-col overflow-hidden text-white",onClick:T[0]||(T[0]=Me(()=>{},["stop"]))},[e("div",gi,[e("div",bi,[e("div",yi,[g(c(Ue),{icon:"setting"})]),e("div",null,[e("h2",xi,B(s.title)+" - é…ç½®ç¼–è¾‘ ",1),T[1]||(T[1]=e("p",{class:"text-sm text-white/50 m-0"},"ä¿®æ”¹è§’è‰²çš„è¯¦ç»†è®¾ç½®",-1))])]),e("button",{class:"w-9 h-9 rounded-full border-none bg-white/10 text-white flex items-center justify-center cursor-pointer transition-all duration-200 hover:bg-white/20 hover:rotate-90",onClick:h},[...T[2]||(T[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",wi,[e("div",_i,[(r(),v(X,null,re(w,E=>e("button",{key:E.id,class:J(["w-full text-left px-4 py-2.5 rounded-xl border-none bg-transparent text-white/60 cursor-pointer transition-all duration-200 font-medium hover:bg-white/5 hover:text-white",{"bg-[rgba(94,114,228,0.2)] !text-[#79d9ff] !font-semibold":n.value===E.id}]),onClick:V=>n.value=E.id},B(E.label),11,ki)),64))]),e("div",Ci,[o.value?(r(),v("div",$i,[...T[3]||(T[3]=[e("div",{class:"w-10 h-10 border-3 border-white/10 border-t-[#5e72e4] rounded-full animate-spin"},null,-1)])])):(r(),v("div",Si,[d.value?(r(),v("div",Mi,[(r(!0),v(X,null,re($.value,(E,V)=>(r(),v("div",{key:V,class:"flex flex-col gap-2"},[!E.visibleIf||E.visibleIf(m.value)?(r(),v(X,{key:0},[e("label",{for:E.key,class:"text-[13px] text-white/60 font-medium"},B(E.label)+" ("+B(E.key)+")",9,Ii),E.type==="text"||E.type==="number"?Q((r(),v("input",{key:0,id:E.key,"onUpdate:modelValue":A=>p(E).value=A,type:E.type,step:E.step,class:"form-control bg-black/20 border border-white/10 rounded-xl px-3.5 py-2.5 text-white text-sm outline-none transition-all duration-200"},null,8,Ai)),[[ss,p(E).value]]):E.type==="textarea"?Q((r(),v("textarea",{key:1,id:E.key,"onUpdate:modelValue":A=>p(E).value=A,rows:E.rows||4,class:"form-control bg-black/20 border border-white/10 rounded-xl px-3.5 py-2.5 text-white text-sm outline-none transition-all duration-200 font-mono leading-relaxed"},null,8,Ti)),[[we,p(E).value]]):E.type==="select"?Q((r(),v("select",{key:2,id:E.key,"onUpdate:modelValue":A=>p(E).value=A,class:"form-control bg-black/20 border border-white/10 rounded-xl px-3.5 py-2.5 text-white text-sm outline-none transition-all duration-200"},[(r(!0),v(X,null,re(E.options,A=>(r(),v("option",{key:A.value,value:A.value,class:"bg-[#333] text-white"},B(A.label),9,Bi))),128))],8,Ei)),[[Lt,p(E).value]]):G("",!0)],64)):G("",!0)]))),128)),n.value==="voice"&&I.value.length>0?(r(),v("div",Vi,[T[4]||(T[4]=e("h3",{class:"text-sm font-bold text-white/70 uppercase"},"å£°éŸ³æ¨¡å‹é…ç½®",-1)),e("div",Ri,[(r(!0),v(X,null,re(I.value,(E,V)=>(r(),v("div",{key:"vm-"+V,class:"flex flex-col gap-2"},[e("label",{for:E.key,class:"text-[13px] text-white/60 font-medium"},B(E.key),9,zi),Q(e("input",{id:E.key,"onUpdate:modelValue":A=>m.value.voice_models[E.key]=A,type:"text",class:"form-control bg-black/20 border border-white/10 rounded-xl px-3.5 py-2.5 text-white text-sm outline-none transition-all duration-200"},null,8,Di),[[we,m.value.voice_models[E.key]]])]))),128))])])):G("",!0)])):G("",!0)]))])]),e("div",Li,[e("button",{class:"px-5 py-2 rounded-[20px] text-sm font-medium cursor-pointer transition-all duration-200 border-none bg-white/10 text-white hover:bg-white/20",onClick:h}," å–æ¶ˆ "),e("button",{class:"px-5 py-2 rounded-[20px] text-sm font-medium cursor-pointer transition-all duration-200 border-none bg-[#5e72e4] text-white disabled:opacity-60 disabled:cursor-not-allowed hover:enabled:bg-[#4a5acf] hover:enabled:-translate-y-px hover:enabled:shadow-[0_4px_12px_rgba(94,114,228,0.3)]",disabled:u.value,onClick:f},[u.value?(r(),v("span",Oi)):G("",!0),W(" "+B(u.value?"ä¿å­˜ä¸­...":"ä¿å­˜æ›´æ”¹"),1)],8,ji)])])])):G("",!0)]),_:1}))}}),Pi=ie(Fi,[["__scopeId","data-v-8abf4f3a"]]),Ui={class:"character-list character-grid grid gap-5 p-3.75 w-full"},Ni=["onClick"],Hi={class:"p-[24px_30px] border-b border-white/10 flex items-center justify-between bg-[linear-gradient(180deg,rgba(255,255,255,0.1)_0%,rgba(255,255,255,0.05)_100%)] md:p-[16px_20px]"},Wi={class:"flex items-center gap-4 max-[480px]:gap-3"},Gi=["src","alt"],Yi={class:"text-[24px] font-bold text-white m-0 text-shadow-[0_2px_8px_rgba(0,0,0,0.3)] md:text-[20px]"},qi={class:"m p-7.5 overflow-y-auto flex-1 md:p-5"},Xi={key:0,class:"grid gap-5 grid-cols-[repeat(auto-fill,minmax(150px,1fr))] md:gap-3.75 md:grid-cols-[repeat(auto-fill,minmax(120px,1fr))] max-[480px]:grid-cols-2 max-[480px]:gap-3"},Ji=["onClick"],Ki={class:"relative w-full aspect-square rounded-xl overflow-hidden mb-2.5 bg-black/20"},Zi=["src","alt"],Qi={key:0,class:"clothes-checkmark absolute top-2 right-2 w-8 h-8 bg-[#79d9ff] rounded-full flex items-center justify-center text-black shadow-[0_4px_12px_rgba(121,217,255,0.6)]"},ec={class:"text-[14px] font-semibold text-white text-center m-0 whitespace-nowrap overflow-hidden text-ellipsis text-shadow-[0_2px_4px_rgba(0,0,0,0.3)] md:text-[12px]"},tc={key:1,class:"no-clothes-message flex flex-col items-center justify-center p-[60px_20px] text-white/60 text-center"},sc=ne({__name:"SettingsCharacter",setup(s){const t=x([]),l=x(1),a=x(!1),n=x(null),o=x(!1),u=x(null),m=x(""),w=Ve(),i=bt(),d=ye(),$=async()=>{try{const k=await as();return console.log("list:",k),k.map(y=>({id:parseInt(y.character_id),title:y.title,info:y.info||"æš‚æ— è§’è‰²æè¿°",avatar:y.avatar_path?`/api/v1/chat/character/character_file/${encodeURIComponent(y.avatar_path)}`:"../pictures/characters/default.png",clothes:y.clothes?y.clothes.map(F=>({title:F.title,avatar:F.avatar?`/api/v1/chat/character/clothes_file/${encodeURIComponent(`${F.avatar}\\æ­£å¸¸.png`)}`:"../pictures/characters/default.png"})):[]}))}catch(k){return console.error("è·å–è§’è‰²åˆ—è¡¨å¤±è´¥:",k),[]}},I=async()=>{try{const k=await $();t.value=k}catch(k){console.error("åŠ è½½è§’è‰²å¤±è´¥:",k)}},p=async()=>{await w.initializeGame(i.client_id,"1")},h=k=>{n.value=k,a.value=!0},f=()=>{a.value=!1,n.value=null},b=async k=>{try{const y=await ls({user_id:l.value.toString(),character_id:k.toString()});p();const F=y?.character?.folder_name;if(F)if(await d.loadCharacterTips(F),d.tipsAvailable){const ce=d.getSwitchTip("success");d.showSuccess({title:ce.title,message:ce.message})}else console.log(`è§’è‰² ${F} æ²¡æœ‰ tips.txtï¼Œä¸æ˜¾ç¤ºåˆ‡æ¢æˆåŠŸå¼¹çª—`)}catch(y){if(console.error("åˆ‡æ¢è§’è‰²å¤±è´¥:",y),d.tipsAvailable){const F=d.getSwitchTip("fail");d.showError({title:F.title,message:F.message})}}},T=async()=>{try{const k=await fetch("/api/v1/chat/character/refresh_characters",{method:"POST",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);await k.json(),await I();const y=d.getRefreshTip("success");d.showSuccess({title:y.title,message:y.message,duration:3e3})}catch(k){console.error("åˆ·æ–°å¤±è´¥:",k);const y=d.getRefreshTip("fail");d.showError({title:y.title,message:k?.message||y.message,duration:3e3})}},E=async k=>{w.mainRole&&(w.mainRole.clothesName=k)},V=async()=>{try{const k=await fetch("/api/v1/chat/character/open_web");if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);await k.json()}catch(k){alert("å¯åŠ¨å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å»lingchatçš„discussionç½‘é¡µ"),console.error("æ‰“å¼€åˆ›æ„å·¥åŠå¤±è´¥:",k)}},A=(k,y)=>{u.value=k,m.value=y,o.value=!0},S=()=>{o.value=!1,u.value=null},z=()=>{T()};function C(k){return w.mainRoleId===k}function _(k){return w.mainRole?w.mainRole.clothesName==k:!1}return xe(()=>{I()}),ae(()=>w.mainRoleId,()=>{I()}),(k,y)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"è§’è‰²åˆ—è¡¨"},{default:M(()=>[g(mi,null,{default:M(()=>[e("div",Ui,[(r(!0),v(X,null,re(t.value,F=>(r(),de(pi,{key:F.id,avatar:F.avatar,name:F.title,info:F.info,clothes:F.clothes||[],selectClothes:E,isClothesSelected:_},{settings:M(()=>[e("button",{class:"settings-icon-btn",onClick:Me(ce=>A(F.id,F.title),["stop"]),title:"è§’è‰²è®¾ç½®"},[g(c(Ue),{icon:"setting"})],8,Ni)]),actions:M(()=>[g(c(te),{type:"nav",class:J(["clothes-select-btn bottom-3.75 right-20 text-white border-none p-[6px_12px] rounded-[20px] cursor-pointer transition-all duration-200 ease-in font-medium hover:bg-[#4a5acf] hover:-translate-y-px hover:shadow-[0_2px_6px_rgba(94,114,228,0.3)]",{dim:!C(F.id)}]),onClick:()=>h(F)},{default:M(()=>[...y[1]||(y[1]=[W(B("é€‰æ‹©æœè£…"),-1)])]),_:1},8,["class","onClick"]),g(c(te),{type:"select",class:J(["character-select-btn bottom-3.75 right-3.75 text-white border-none p-[6px_12px] rounded-[20px] cursor-pointer transition-all duration-200 ease-in font-medium text-[13px] hover:bg-[#4a5acf] hover:-translate-y-px hover:shadow-[0_2px_6px_rgba(94,114,228,0.3)]",{selected:C(F.id)}]),onClick:ce=>b(F.id)},{default:M(()=>[W(B(C(F.id)?"âˆš é€‰ä¸­":"é€‰æ‹©"),1)]),_:2},1032,["class","onClick"])]),_:2},1032,["avatar","name","info","clothes"]))),128))])]),_:1})]),_:1}),g(c(ve),{title:"åˆ·æ–°äººç‰©åˆ—è¡¨",size:"small"},{default:M(()=>[g(c(te),{type:"big",onClick:T},{default:M(()=>[...y[2]||(y[2]=[W("ç‚¹æˆ‘åˆ·æ–°~",-1)])]),_:1})]),_:1}),g(c(ve),{title:"åˆ›æ„å·¥åŠ",size:"small"},{default:M(()=>[g(c(te),{type:"big",onClick:V},{default:M(()=>[...y[3]||(y[3]=[W("è¿›å…¥åˆ›æ„å·¥åŠ",-1)])]),_:1})]),_:1}),g(Pe,{name:"modal"},{default:M(()=>[a.value?(r(),v("div",{key:0,class:"fixed top-0 left-0 w-full h-full flex items-center justify-center z-20 p-5 backdrop-blur-sm",onClick:f},[e("div",{class:"modal-container bg-[linear-gradient(135deg,rgba(255,255,255,0.15)_0%,rgba(255,255,255,0.05)_100%)] backdrop-blur-[30px] backdrop-saturate-180 rounded-3xl shadow-[0_20px_60px_rgba(0,0,0,0.4),inset_0_0_1px_rgba(255,255,255,0.3)] border border-white/20 max-w-200 w-full max-h-[90vh] overflow-hidden flex flex-col md:rounded-2xl",onClick:y[0]||(y[0]=Me(()=>{},["stop"]))},[e("div",Hi,[e("div",Wi,[n.value?(r(),v("img",{key:0,src:n.value.avatar,alt:n.value.title,class:"w-14 h-14 rounded-xl object-cover border-2 border-white/30 shadow-[0_4px_12px_rgba(0,0,0,0.2)] md:w-12 md:h-12"},null,8,Gi)):G("",!0),e("div",null,[e("h2",Yi,B(n.value?.title),1),y[4]||(y[4]=e("p",{class:"text-[14px] text-white/70 m-0 mt-1"},"é€‰æ‹©æœè£…",-1))])]),e("button",{class:"w-10 h-10 rounded-full border-none bg-white/10 text-white cursor-pointer flex items-center justify-center transition-all duration-300 ease-in backdrop-blur-[10px] hover:bg-[rgba(255,86,86,0.8)] hover:rotate-90 hover:shadow-[0_4px_12px_rgba(255,86,86,0.4)] max-[480px]:w-9 max-[480px]:h-9",onClick:f},[...y[5]||(y[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",qi,[n.value?.clothes&&n.value.clothes.length>0?(r(),v("div",Xi,[(r(!0),v(X,null,re(n.value.clothes,F=>(r(),v("div",{key:F.title,class:J(["clothes-item bg-white/8 border-2 border-white/10 rounded-2xl p-3 cursor-pointer transition-all duration-300 ease-in-out relative overflow-hidden hover:-translate-y-1 hover:scale-[1.02] hover:border-[#79d9ff]/50 hover:shadow-[0_8px_24px_rgba(0,0,0,0.3),0_0_20px_rgba(121,217,255,0.2)] md:p-2.5",{"clothes-item-selected":_(F.title)}]),onClick:ce=>E(F.title)},[e("div",Ki,[e("img",{src:F.avatar,alt:F.title,class:"w-full h-full object-contain transition-transform duration-300 ease-in hover:scale-110"},null,8,Zi),_(F.title)?(r(),v("div",Qi,[...y[6]||(y[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"20 6 9 17 4 12"})],-1)])])):G("",!0)]),e("p",ec,B(F.title),1)],10,Ji))),128))])):(r(),v("div",tc,[...y[7]||(y[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— å¯ç”¨æœè£…",-1)])]))])])])):G("",!0)]),_:1}),g(Pi,{visible:o.value,"role-id":u.value,title:m.value,onClose:S,onSaved:z},null,8,["visible","role-id","title"])]),_:1}))}}),nc=ie(sc,[["__scopeId","data-v-8a4667df"]]),oc=async()=>{try{return await Be.get("/v1/chat/background/list",{})}catch(s){throw console.error("è·å–æ¸¸æˆèƒŒæ™¯åˆ—è¡¨ä¿¡æ¯é”™è¯¯:",s.message),s}},ac={class:"background-container"},lc={class:"background-list character-grid"},rc={class:"background-image-container"},ic=["src","alt"],cc=["data-title"],uc={class:"effect-list"},dc=ne({__name:"SettingsBackground",setup(s){const t=x([]),l=x(""),a=x(null),n=ye();xe(async()=>{try{await u();const I=localStorage.getItem("selectedBackground");if(I)w(I);else if(t.value.length>0){const p=Math.floor(Math.random()*t.value.length);w(t.value[p]?.url||""),console.log("å·²é€‰éšæœºèƒŒæ™¯")}}catch(I){console.error("åŠ è½½èƒŒæ™¯å›¾ç‰‡å¤±è´¥",I)}});async function o(){try{return(await oc()).map(p=>({title:p.title?p.title:"è‰æ³¥é©¬",url:p.url?`/api/v1/chat/background/background_file/${encodeURIComponent(p.url)}`:"../pictures/background/default.png",time:p.time}))}catch(I){return console.error("è·å–èƒŒæ™¯åˆ—è¡¨å¤±è´¥:",I),[]}}async function u(){t.value=await o()}function m(I){return l.value===I}function w(I){l.value=I,n.currentBackground=I,localStorage.setItem("selectedBackground",I)}function i(){a.value&&a.value.click()}async function d(I){const p=I.target,h=p.files?.[0];if(!h)return;const f=h.name,b=f.slice(f.lastIndexOf(".")).toLowerCase(),T=[".jpg",".png",".webp",".bmp",".svg",".tif",".gif"];if(!T.includes(b)){alert("è¯·ä¸Šä¼ æ”¯æŒçš„å›¾ç‰‡æ ¼å¼: "+T.join(", "));return}const E=new FormData;E.append("file",h),E.append("name",f);try{if(!(await fetch("/api/v1/chat/background/upload",{method:"POST",body:E})).ok)throw new Error("ä¸Šä¼ å¤±è´¥");await u(),p&&(p.value="")}catch(V){console.error("ä¸Šä¼ å¤±è´¥",V),alert("ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•")}}function $(I){n.currentBackgroundEffect=I}return(I,p)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"èƒŒæ™¯é€‰æ‹©"},{default:M(()=>[e("div",ac,[e("div",lc,[(r(!0),v(X,null,re(t.value,(h,f)=>(r(),v("div",{key:f,class:J(["background-card",{selected:m(h.url)}])},[e("div",rc,[e("img",{src:h.url,alt:h.title,class:"background-image"},null,8,ic)]),e("div",{class:"background-title","data-title":h.title},[g(c(te),{class:J(["background-select-btn",{selected:m(h.url)}]),onClick:b=>w(h.url)},{default:M(()=>[W(B(m(h.url)?"å·²é€‰ä¸­":"é€‰æ‹©"),1)]),_:2},1032,["class","onClick"])],8,cc)],2))),128))]),g(c(te),{type:"big",onClick:i},{default:M(()=>[...p[5]||(p[5]=[W("ä¸Šä¼ è‡ªå®šä¹‰èƒŒæ™¯",-1)])]),_:1}),e("input",{type:"file",ref_key:"uploadInput",ref:a,onChange:d,accept:".jpg,.png,.webp,.bmp,.svg,.tif,.gif",style:{display:"none"}},null,544)])]),_:1}),g(c(ve),{title:"ç²’å­é€‰æ‹©",size:"large"},{default:M(()=>[e("div",uc,[g(c(te),{type:"big",onClick:p[0]||(p[0]=h=>$("StarField"))},{default:M(()=>[...p[6]||(p[6]=[W("æ˜Ÿç©º",-1)])]),_:1}),g(c(te),{type:"big",onClick:p[1]||(p[1]=h=>$("Rain"))},{default:M(()=>[...p[7]||(p[7]=[W("é›¨æ°´",-1)])]),_:1}),g(c(te),{type:"big",onClick:p[2]||(p[2]=h=>$("Sakura"))},{default:M(()=>[...p[8]||(p[8]=[W("æ¨±èŠ±",-1)])]),_:1}),g(c(te),{type:"big",onClick:p[3]||(p[3]=h=>$("Snow"))},{default:M(()=>[...p[9]||(p[9]=[W("é›ªæ™¯",-1)])]),_:1}),g(c(te),{type:"big",onClick:p[4]||(p[4]=h=>$("Fireworks"))},{default:M(()=>[...p[10]||(p[10]=[W("çƒŸèŠ±",-1)])]),_:1})])]),_:1})]),_:1}))}}),pc=ie(dc,[["__scopeId","data-v-861b9992"]]),vc={name:"SettingsUpdate",components:{MenuPage:ze,MenuItem:ve,Button:te},data(){return{apiBaseUrl:"/api/v1/update",currentVersion:"æœªçŸ¥",updateAvailable:!1,updateStatus:"idle",updateInfo:null,updateChain:[],updateChainInfo:null,errorMessage:"",isChecking:!1,isDownloading:!1,isRollingBack:!1,progress:0,progressMessage:"",showProgress:!1,config:{auto_backup:!0},backendConnected:!1,connectionRetries:0,maxRetries:5,showRollbackDialog:!1,showBackupDialog:!1}},mounted(){this.checkBackendConnection()},beforeUnmount(){},computed:{isCheckingUpdates(){return this.updateStatus==="checking"},isDownloadingUpdates(){return this.updateStatus==="downloading"},isApplyingUpdates(){return this.updateStatus==="applying"},isRollingBackUpdates(){return this.updateStatus==="rolling_back"},displayVersion(){return this.updateInfo&&(this.updateInfo.target_version||this.updateInfo.version)||"æœªçŸ¥"}},methods:{async checkBackendConnection(){try{const s=await De.get(`${this.apiBaseUrl}/health`,{timeout:5e3});s.data&&s.data.status==="ok"&&(this.backendConnected=!0,this.connectionRetries=0,this.errorMessage="",this.loadAppInfo(),this.loadConfig(),await this.getUpdateStatus(),console.log("æˆåŠŸè¿æ¥åˆ°æ›´æ–°æœåŠ¡"))}catch(s){console.error("æ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡:",s),this.backendConnected=!1,this.connectionRetries<this.maxRetries?(this.connectionRetries++,console.log(`é‡è¯•è¿æ¥ (${this.connectionRetries}/${this.maxRetries})...`),setTimeout(()=>this.checkBackendConnection(),2e3)):this.errorMessage=`æ— æ³•è¿æ¥åˆ°æ›´æ–°æœåŠ¡ã€‚è¯·ç¡®ä¿ä¸»åº”ç”¨æœåŠ¡æ­£åœ¨è¿è¡Œã€‚é”™è¯¯: ${s.message}`}},async refreshUpdateStatus(){this.backendConnected&&await this.getUpdateStatus()},async loadAppInfo(){if(this.backendConnected)try{const s=await De.get(`${this.apiBaseUrl}/info`,{timeout:5e3});s.data&&(this.currentVersion=s.data.current_version||"æœªçŸ¥",this.updateAvailable=s.data.update_available||!1,this.updateChainInfo=s.data.update_chain_info||null)}catch(s){console.error("è·å–åº”ç”¨ä¿¡æ¯å¤±è´¥:",s),this.handleApiError(s,"è·å–åº”ç”¨ä¿¡æ¯")}},async loadConfig(){if(this.backendConnected)try{const s=await De.get(`${this.apiBaseUrl}/config`,{timeout:5e3});s.data&&(this.config.auto_backup=s.data.auto_backup||!0)}catch(s){console.error("è·å–é…ç½®å¤±è´¥:",s),this.handleApiError(s,"è·å–é…ç½®")}},async updateConfig(){if(this.backendConnected)try{await De.post(`${this.apiBaseUrl}/config`,this.config,{timeout:5e3})}catch(s){console.error("æ›´æ–°é…ç½®å¤±è´¥:",s),this.handleApiError(s,"æ›´æ–°é…ç½®")}},async getUpdateStatus(){if(this.backendConnected)try{const s=await De.get(`${this.apiBaseUrl}/status`,{timeout:5e3});if(s.data){const t=s.data;this.updateStatus=t.status||"idle",this.progress=t.progress||0,this.progressMessage=t.message||"",this.isChecking=this.updateStatus==="checking",this.isDownloading=["downloading","applying"].includes(this.updateStatus),this.isRollingBack=this.updateStatus==="rolling_back",t.error?this.errorMessage=t.error:this.updateStatus!=="error"&&(this.errorMessage=""),t.update_info&&(this.updateInfo=t.update_info,this.updateAvailable=!0,t.update_info.update_chain&&t.update_info.update_chain.length>0?this.updateChain=t.update_info.update_chain:this.updateChain=[]),this.showProgress=["checking","downloading","applying","rolling_back"].includes(this.updateStatus),this.updateStatus==="completed"&&setTimeout(()=>{this.loadAppInfo(),this.updateAvailable=!1,this.updateInfo=null,this.updateChain=[]},1e3)}}catch(s){console.error("è·å–æ›´æ–°çŠ¶æ€å¤±è´¥:",s),this.handleApiError(s,"è·å–æ›´æ–°çŠ¶æ€")}},handleApiError(s,t){s.code==="NETWORK_ERROR"||s.message.includes("Network Error")?(this.backendConnected=!1,this.errorMessage="ç½‘ç»œé”™è¯¯: æ— æ³•è¿æ¥åˆ°æ›´æ–°æœåŠ¡ã€‚è¯·ç¡®ä¿ä¸»åº”ç”¨æœåŠ¡æ­£åœ¨è¿è¡Œã€‚",this.stopStatusPolling()):s.response?this.errorMessage=`${t}å¤±è´¥: æœåŠ¡å™¨è¿”å›é”™è¯¯ ${s.response.status}`:s.request?(this.backendConnected=!1,this.errorMessage=`${t}å¤±è´¥: æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨`,this.stopStatusPolling()):this.errorMessage=`${t}å¤±è´¥: ${s.message}`},async checkForUpdates(){this.errorMessage="";try{const s=await De.post(`${this.apiBaseUrl}/check`,{},{timeout:1e4});s.data&&s.data.success?(this.progressMessage="æ­£åœ¨æ£€æŸ¥æ›´æ–°...",await this.getUpdateStatus()):this.errorMessage=s.data.error||"æ£€æŸ¥æ›´æ–°å¤±è´¥"}catch(s){console.error("æ£€æŸ¥æ›´æ–°å¤±è´¥:",s),this.handleApiError(s,"æ£€æŸ¥æ›´æ–°")}},async downloadAndApplyUpdate(){this.errorMessage="",this.updateChain&&this.updateChain.length>1?this.showBackupDialog=!0:await this.startUpdate(this.config.auto_backup)},async startUpdate(s){try{const t=await De.post(`${this.apiBaseUrl}/apply`,{backup:s},{timeout:3e4});t.data&&t.data.success?(this.progressMessage="å¼€å§‹ä¸‹è½½æ›´æ–°...",await this.getUpdateStatus()):this.errorMessage=t.data.error||"å¼€å§‹æ›´æ–°å¤±è´¥"}catch(t){console.error("å¼€å§‹æ›´æ–°å¤±è´¥:",t),this.handleApiError(t,"å¼€å§‹æ›´æ–°")}},confirmUpdateWithBackup(s){this.showBackupDialog=!1,this.startUpdate(s)},cancelUpdate(){this.showBackupDialog=!1},rollbackUpdate(){this.showRollbackDialog=!0},async confirmRollback(){this.showRollbackDialog=!1,this.errorMessage="";try{const s=await De.post(`${this.apiBaseUrl}/rollback`,{},{timeout:3e4});s.data&&s.data.success?(this.progressMessage="æ­£åœ¨å›æ»š...",await this.getUpdateStatus()):this.errorMessage=s.data.error||"å¼€å§‹å›æ»šå¤±è´¥"}catch(s){console.error("å¼€å§‹å›æ»šå¤±è´¥:",s),this.handleApiError(s,"å¼€å§‹å›æ»š")}},cancelRollback(){this.showRollbackDialog=!1}}},hc={key:0,class:"connection-status error"},fc={key:1,class:"connection-status success"},mc={class:"current-version"},gc={key:0,class:"update-chain-info"},bc={key:1,class:"error-message"},yc={class:"action-buttons"},xc={class:"update-info"},wc={key:0},_c={key:1},kc={class:"progress-container"},Cc={class:"progress-bar"},$c={class:"progress-text"},Sc={class:"config-item"},Mc={key:2,class:"dialog-overlay"},Ic={class:"dialog"},Ac={class:"dialog-actions"},Tc={key:3,class:"dialog-overlay"},Ec={class:"dialog"},Bc={class:"dialog-actions"};function Vc(s,t,l,a,n,o){const u=it("Button"),m=it("MenuItem"),w=it("MenuPage");return r(),de(w,null,{default:M(()=>[g(m,{title:"ğŸ”— æ›´æ–°æœåŠ¡è¿æ¥çŠ¶æ€",size:"small"},{default:M(()=>[n.backendConnected?(r(),v("div",fc,[t[8]||(t[8]=e("p",null,"âœ… å·²è¿æ¥åˆ°æ›´æ–°æœåŠ¡",-1)),g(u,{type:"big",onClick:o.refreshUpdateStatus},{default:M(()=>[...t[7]||(t[7]=[W("åˆ·æ–°æ›´æ–°çŠ¶æ€",-1)])]),_:1},8,["onClick"])])):(r(),v("div",hc,[t[5]||(t[5]=e("p",null,"âš ï¸ æœªè¿æ¥åˆ°æ›´æ–°æœåŠ¡",-1)),t[6]||(t[6]=e("p",null,"è¯·ç¡®ä¿ä¸»åº”ç”¨æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆä¸€èˆ¬ä¸å¯èƒ½åœ¨éè¿è¡ŒçŠ¶æ€ï¼‰",-1)),g(u,{type:"big",onClick:o.checkBackendConnection},{default:M(()=>[...t[4]||(t[4]=[W("é‡è¯•è¿æ¥",-1)])]),_:1},8,["onClick"])]))]),_:1}),g(m,{title:"ğŸ“‹ å½“å‰ç‰ˆæœ¬ä¿¡æ¯",size:"small"},{default:M(()=>[e("div",mc,[e("p",null,[t[9]||(t[9]=e("strong",null,"å½“å‰ç‰ˆæœ¬:",-1)),W(" "+B(n.currentVersion),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"æ›´æ–°çŠ¶æ€:",-1)),W(" "+B(n.updateStatus),1)]),n.updateChainInfo&&n.updateChainInfo.update_count>1?(r(),v("p",gc," å‘ç° "+B(n.updateChainInfo.update_count)+" ä¸ªå¾…æ›´æ–°ç‰ˆæœ¬: "+B(n.updateChainInfo.current_version)+" â†’ "+B(n.updateChainInfo.target_version),1)):G("",!0),n.errorMessage?(r(),v("p",bc,B(n.errorMessage),1)):G("",!0)])]),_:1}),g(m,{title:"ğŸ”„ æ›´æ–°æ“ä½œ",size:"large"},{default:M(()=>[e("div",yc,[g(u,{type:"big",onClick:o.checkForUpdates,disabled:!n.backendConnected||n.isChecking||n.isDownloading||n.isRollingBack,class:"left-button"},{default:M(()=>[W(B(n.isChecking?"â³ æ£€æŸ¥ä¸­...":"ğŸ” æ£€æŸ¥æ›´æ–°"),1)]),_:1},8,["onClick","disabled"]),g(u,{type:"big",onClick:o.downloadAndApplyUpdate,disabled:!n.backendConnected||!n.updateAvailable||n.isChecking||n.isDownloading||n.isRollingBack,class:"left-button"},{default:M(()=>[W(B(n.isDownloading?"â³ ä¸‹è½½ä¸­...":"ğŸ“¥ ä¸‹è½½å¹¶åº”ç”¨æ›´æ–°"),1)]),_:1},8,["onClick","disabled"]),g(u,{type:"big",onClick:o.rollbackUpdate,disabled:!n.backendConnected||n.isChecking||n.isDownloading||n.isRollingBack,class:"left-button danger"},{default:M(()=>[W(B(n.isRollingBack?"â³ å›æ»šä¸­...":"â†©ï¸ å›æ»šåˆ°ä¸Šæ¬¡å¤‡ä»½"),1)]),_:1},8,["onClick","disabled"])])]),_:1}),n.updateInfo?(r(),de(m,{key:0,title:"ğŸ†• å‘ç°æ–°ç‰ˆæœ¬",size:"small"},{default:M(()=>[e("div",xc,[n.updateChain&&n.updateChain.length>0?(r(),v("div",wc,[e("p",null,[e("strong",null,"å‘ç° "+B(n.updateChain.length)+" ä¸ªå¾…æ›´æ–°ç‰ˆæœ¬:",1)]),(r(!0),v(X,null,re(n.updateChain,(i,d)=>(r(),v("div",{key:d,class:"update-chain-item"},[e("p",null,[e("strong",null,"ç‰ˆæœ¬ "+B(i.version||"æœªçŸ¥"),1),W(" - "+B(i.changelog||"æ— æ›´æ–°è¯´æ˜"),1)])]))),128))])):(r(),v("div",_c,[e("p",null,[t[11]||(t[11]=e("strong",null,"ç‰ˆæœ¬:",-1)),W(" "+B(o.displayVersion),1)]),e("p",null,[t[12]||(t[12]=e("strong",null,"æ›´æ–°å†…å®¹:",-1)),W(" "+B(n.updateInfo.changelog||"æ— "),1)])]))])]),_:1})):G("",!0),n.showProgress?(r(),de(m,{key:1,title:"ğŸ“Š æ›´æ–°è¿›åº¦",size:"small"},{default:M(()=>[e("div",kc,[e("div",Cc,[e("div",{class:"progress-fill",style:$e({width:n.progress+"%"})},null,4)]),e("p",$c,B(n.progressMessage),1)])]),_:1})):G("",!0),g(m,{title:"âš™ æ›´æ–°é…ç½®"},{default:M(()=>[e("div",Sc,[e("label",null,[Q(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=i=>n.config.auto_backup=i),onChange:t[1]||(t[1]=(...i)=>o.updateConfig&&o.updateConfig(...i))},null,544),[[Ot,n.config.auto_backup]]),t[13]||(t[13]=W(" è‡ªåŠ¨åˆ›å»ºå¤‡ä»½ ",-1))]),t[14]||(t[14]=e("span",{class:"config-help"},"åº”ç”¨æ›´æ–°å‰è‡ªåŠ¨åˆ›å»ºå®Œæ•´å¤‡ä»½",-1))])]),_:1}),n.showRollbackDialog?(r(),v("div",Mc,[e("div",Ic,[t[17]||(t[17]=e("h3",null,"ç¡®è®¤å›æ»š",-1)),t[18]||(t[18]=e("p",null,"ç¡®è®¤å›æ»šåˆ°ä¸Šæ¬¡å¤‡ä»½å—ï¼Ÿ",-1)),e("div",Ac,[g(u,{type:"big",onClick:o.confirmRollback,class:"danger"},{default:M(()=>[...t[15]||(t[15]=[W("ç¡®è®¤å›æ»š",-1)])]),_:1},8,["onClick"]),g(u,{type:"big",onClick:o.cancelRollback,class:"left-button"},{default:M(()=>[...t[16]||(t[16]=[W("å–æ¶ˆ",-1)])]),_:1},8,["onClick"])])])])):G("",!0),n.showBackupDialog?(r(),v("div",Tc,[e("div",Ec,[t[22]||(t[22]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),t[23]||(t[23]=e("p",null,"æ˜¯å¦åœ¨åº”ç”¨å‰åˆ›å»ºå…¨é‡å¤‡ä»½ï¼Ÿ",-1)),e("div",Bc,[g(u,{type:"big",onClick:t[2]||(t[2]=i=>o.confirmUpdateWithBackup(!0)),class:"left-button"},{default:M(()=>[...t[19]||(t[19]=[W("æ˜¯",-1)])]),_:1}),g(u,{type:"big",onClick:t[3]||(t[3]=i=>o.confirmUpdateWithBackup(!1)),class:"left-button"},{default:M(()=>[...t[20]||(t[20]=[W("å¦",-1)])]),_:1}),g(u,{type:"big",onClick:o.cancelUpdate,class:"left-button"},{default:M(()=>[...t[21]||(t[21]=[W("å–æ¶ˆ",-1)])]),_:1},8,["onClick"])])])])):G("",!0)]),_:1})}const Rc=ie(vc,[["render",Vc],["__scopeId","data-v-2ccedd67"]]),zc={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5"},Dc={key:0,class:"absolute inset-0 bg-yellow-400/10 blur-2xl animate-pulse"},Lc={class:"relative flex-shrink-0 mr-4 z-10"},jc=["src"],Oc={class:"flex-1 min-w-0 z-10"},Fc={class:"flex items-center justify-between mb-1.5"},Pc={class:"relative h-1.5 w-full bg-white/30 rounded-full overflow-hidden backdrop-blur-sm border border-white/5"},Uc={key:0,class:"flex justify-end mt-1"},Nc=ne({__name:"SettingsAchievement",setup(s){const t=rs(),l=K(()=>Object.values(t.allAchievements||{}).sort((i,d)=>{if(i.unlocked&&!d.unlocked)return-1;if(!i.unlocked&&d.unlocked)return 1;if(i.unlocked&&d.unlocked){if(i.type==="rare"&&d.type!=="rare")return-1;if(i.type!=="rare"&&d.type==="rare")return 1}return 0})),a=i=>i.unlocked?i.type==="rare"?"bg-gradient-to-br from-yellow-700/30 to-black/60 border-yellow-400 shadow-[0_0_30px_rgba(234,179,8,0.25)] hover:shadow-[0_0_40px_rgba(234,179,8,0.4)] hover:-translate-y-1":"bg-black/30 border-white/20 hover:bg-white/5 hover:border-black/5 shadow-lg hover:shadow-emerald-500/10 hover:-translate-y-0.5":"bg-black/30 border-white/10 backdrop-blur-md opacity-90 hover:bg-white/5 transition-all",n=i=>i.unlocked?i.type==="rare"?"border-yellow-400 bg-yellow-400/20 text-yellow-400 shadow-[0_0_15px_rgba(250,204,21,0.4)]":"border-emerald-400 bg-emerald-400/20 text-emerald-400 shadow-[0_0_10px_rgba(52,211,153,0.3)]":"border-white/20 bg-white/5 text-white/30",o=i=>i.unlocked?i.type==="rare"?"text-yellow-400 drop-shadow-[0_0_4px_rgba(250,204,21,0.8)]":"text-emerald-400 drop-shadow-[0_0_4px_rgba(52,211,153,0.6)]":"text-white/40",u=i=>i.type==="rare"?"bg-yellow-500/30 text-yellow-200 border-yellow-400/50":"bg-emerald-500/30 text-emerald-200 border-emerald-400/50",m=i=>i.unlocked?i.type==="rare"?"bg-gradient-to-r from-yellow-600 to-yellow-300":"bg-gradient-to-r from-emerald-600 to-emerald-300":"bg-white/40",w=i=>{if(i.unlocked)return 100;const d=i.current_progress||0,$=i.target_progress||1;return Math.min(100,Math.max(0,d/$*100))};return xe(()=>{t.fetchAchievements()}),(i,d)=>(r(),de(c(ze),null,{default:M(()=>[g(c(ve),{title:"ğŸ† æˆå°±åˆ—è¡¨"},{default:M(()=>[e("div",zc,[(r(!0),v(X,null,re(l.value,$=>(r(),v("div",{key:$.id,class:J(["relative flex items-center p-4 rounded-xl border transition-all duration-300 group overflow-hidden",a($)])},[$.type==="rare"&&$.unlocked?(r(),v("div",Dc)):G("",!0),e("div",Lc,[e("div",{class:J(["w-16 h-16 rounded-full flex items-center justify-center border-2 transition-all duration-300 shadow-md",n($)])},[$.imgUrl?(r(),v("img",{key:0,src:$.imgUrl,class:J(["w-10 h-10 object-contain transition-all duration-300",{"opacity-40":!$.unlocked}])},null,10,jc)):(r(),de(Ue,{key:1,icon:"achievement",size:32,class:J(o($))},null,8,["class"]))],2)]),e("div",Oc,[e("div",Fc,[e("h3",{class:J(["text-base font-bold truncate tracking-wide",$.unlocked?"text-white text-shadow-sm":"text-white/90"])},B($.title),3),$.unlocked?(r(),v("span",{key:0,class:J(["text-[10px] px-2 py-0.5 rounded-full border backdrop-blur-md shadow-sm font-medium",u($)])},B($.type==="rare"?"ç¨€æœ‰":"æ™®é€š"),3)):G("",!0)]),e("p",{class:J(["text-xs line-clamp-2 h-8 leading-4 mb-2 transition-colors duration-300",$.unlocked?"text-gray-200":"text-white/70"])},B($.description),3),e("div",Pc,[e("div",{class:J(["absolute top-0 left-0 h-full transition-all duration-1000 ease-out shadow-[0_0_8px_currentColor]",m($)]),style:$e({width:w($)+"%"})},null,6)]),$.unlocked?G("",!0):(r(),v("div",Uc,[e("span",{class:J(["text-[10px] font-mono",$.unlocked?"text-gray-200":"text-white/60"])},B($.current_progress)+" / "+B($.target_progress),3)]))])],2))),128))])]),_:1})]),_:1}))}}),Hc=ie(Nc,[["__scopeId","data-v-d688c0b4"]]),Wc={class:"w-full h-full flex items-center justify-between relative px-5 py-2"},Gc=ne({__name:"SettingsNav",emits:["remove-more-menu-from-a"],setup(s,{expose:t,emit:l}){const a=l,n=ye(),o=x(null),u=x(null),m=x(null),w=x(null),i=x(null),d=x(null),$=x(null),I=x(null),p=x(null),h=x(null),f=x(null),b=x("textBtn"),T=k=>{const y={characterBtn:m,textBtn:w,backgroundBtn:i,soundBtn:d,historyBtn:$,achievementBtn:I,saveBtn:p,advanceBtn:h,updateBtn:f}[k];y?.value?.$el&&E(y.value.$el)},E=k=>{!o.value||!k||(o.value.style.left=`${k.offsetLeft}px`,o.value.style.width=`${k.offsetWidth}px`)},V=(k,y)=>{b.value=y,n.setSettingsTab(k),o.value&&(o.value.style.transition="left 0.3s cubic-bezier(0.18, 0.89, 0.32, 1), width 0.3s cubic-bezier(0.18, 0.89, 0.32, 1)",T(y),setTimeout(()=>{o.value&&(o.value.style.transition="unset")},400))},A=()=>{if(!u.value)return;new ResizeObserver(y=>{S()}).observe(u.value)},S=()=>{const k=n.currentSettingsTab;let y=null;switch(k){case"character":y=m.value;break;case"text":y=w.value;break;case"background":y=i.value;break;case"sound":y=d.value;break;case"history":y=$.value;break;case"achievement":y=I.value;break;case"save":y=p.value;break;case"advance":y=h.value;break;case"update":y=f.value;break}y?.$el&&E(y.$el)};xe(()=>{S(),A()}),ae(()=>n.currentSettingsTab,()=>{S()});const z=()=>{n.toggleSettings(!1),b.value="textBtn"},C=()=>{const k=h.value?.$el;k&&k.classList.add("moreMenu")},_=()=>{const k=h.value?.$el;k&&k.classList.remove("moreMenu"),a("remove-more-menu-from-a")};return t({addMoreMenu:C}),ae(()=>{},()=>{},{immediate:!0}),(k,y)=>(r(),v("div",Wc,[y[18]||(y[18]=e("img",{src:cs,alt:"Logo",class:"w-20 ml-5 hidden xl:block"},null,-1)),e("nav",{ref_key:"navContainer",ref:u,class:"relative w-full flex felx-row items-center justify-around h-full ease-in-out duration-100 xl:justify-center overflow-x-auto overflow-y-hidden"},[e("div",{ref_key:"indicator",ref:o,class:"absolute bottom-0 left-0 w-0 h-1 bg-brand rounded z-10 shadow-[0_0_10px_rgba(121,217,255,0.4)]"},null,512),g(c(te),{ref_key:"characterBtn",ref:m,type:"nav",icon:"character",onClick:y[0]||(y[0]=()=>V("character","characterBtn")),class:J({active:c(n).currentSettingsTab==="character"})},{default:M(()=>[...y[9]||(y[9]=[e("p",{class:"hidden xl:block"},"è§’è‰²",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"textBtn",ref:w,type:"nav",icon:"text",onClick:y[1]||(y[1]=()=>V("text","textBtn")),class:J({active:c(n).currentSettingsTab==="text"})},{default:M(()=>[...y[10]||(y[10]=[e("p",{class:"hidden xl:block"},"é€šç”¨",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"backgroundBtn",ref:i,type:"nav",icon:"background",onClick:y[2]||(y[2]=()=>V("background","backgroundBtn")),class:J({active:c(n).currentSettingsTab==="background"})},{default:M(()=>[...y[11]||(y[11]=[e("p",{class:"hidden xl:block"},"èƒŒæ™¯",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"soundBtn",ref:d,type:"nav",icon:"sound",onClick:y[3]||(y[3]=()=>V("sound","soundBtn")),class:J({active:c(n).currentSettingsTab==="sound"})},{default:M(()=>[...y[12]||(y[12]=[e("p",{class:"hidden xl:block"},"å£°éŸ³",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"historyBtn",ref:$,type:"nav",icon:"history",onClick:y[4]||(y[4]=()=>V("history","historyBtn")),class:J({active:c(n).currentSettingsTab==="history"})},{default:M(()=>[...y[13]||(y[13]=[e("p",{class:"hidden xl:block"},"å¯¹è¯å†å²",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"achievementBtn",ref:I,type:"nav",icon:"achievement",onClick:y[5]||(y[5]=()=>V("achievement","achievementBtn")),class:J({active:c(n).currentSettingsTab==="achievement"})},{default:M(()=>[...y[14]||(y[14]=[e("p",{class:"hidden xl:block"},"æˆå°±",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"saveBtn",ref:p,type:"nav",icon:"save",onClick:y[6]||(y[6]=()=>V("save","saveBtn")),class:J({active:c(n).currentSettingsTab==="save"})},{default:M(()=>[...y[15]||(y[15]=[e("p",{class:"hidden xl:block"},"å­˜æ¡£",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"advanceBtn",ref:h,type:"nav",icon:"advance",onClick:y[7]||(y[7]=()=>{V("advance","advanceBtn"),_()}),class:J({active:c(n).currentSettingsTab==="advance"})},{default:M(()=>[...y[16]||(y[16]=[e("p",{class:"hidden xl:block"},"é«˜çº§è®¾ç½®",-1)])]),_:1},8,["class"]),g(c(te),{ref_key:"updateBtn",ref:f,type:"nav",icon:"update",onClick:y[8]||(y[8]=()=>V("update","updateBtn")),class:J({active:c(n).currentSettingsTab==="update"})},{default:M(()=>[...y[17]||(y[17]=[e("p",{class:"hidden xl:block"},"æ£€æŸ¥æ›´æ–°",-1)])]),_:1},8,["class"])],512),g(Ue,{icon:"close",class:"bg-transparent border-none p-1.5 rounded-full cursor-pointer flex items-center justify-center text-white transition-all duration-300 ease-in-out hover:text-accent hover:bg-white/10 hover:rotate-90",size:40,onClick:z})]))}}),Yc={class:"settings-panel flex flex-col h-full"},qc={class:"flex-shrink-0 w-full"},Xc={class:"w-full flex-1 overflow-auto"},Qc=ne({__name:"SettingsPanel",setup(s){const t=ye(),l=x(null),a=x(null),n=x(!1),o=x(0);ae(()=>t.showSettings,w=>{w?(n.value=!0,setTimeout(()=>{o.value=1},10)):(o.value=0,setTimeout(()=>{n.value=!1},100))},{immediate:!0});const u=()=>{a.value?.addMoreMenu()},m=()=>{l.value?.addMoreMenu()};return(w,i)=>(r(),v(X,null,[n.value?(r(),v("div",{key:0,class:"blur-overlay",style:$e({opacity:o.value})},null,4)):G("",!0),Q(e("div",Yc,[e("div",qc,[g(Gc,{ref_key:"settingsNavRef",ref:l,onRemoveMoreMenuFromA:u},null,512)]),e("div",Xc,[Q(g(c(El),null,null,512),[[Ce,c(t).currentSettingsTab==="save"]]),Q(g(c(Ql),null,null,512),[[Ce,c(t).currentSettingsTab==="text"]]),Q(g(c(pr),null,null,512),[[Ce,c(t).currentSettingsTab==="sound"]]),Q(g(c(zr),{ref_key:"settingsAdvanceRef",ref:a,onRemoveMoreMenuFromB:m},null,512),[[Ce,c(t).currentSettingsTab==="advance"]]),Q(g(c(si),null,null,512),[[Ce,c(t).currentSettingsTab==="history"]]),Q(g(c(Hc),null,null,512),[[Ce,c(t).currentSettingsTab==="achievement"]]),Q(g(c(nc),null,null,512),[[Ce,c(t).currentSettingsTab==="character"]]),Q(g(c(pc),null,null,512),[[Ce,c(t).currentSettingsTab==="background"]]),Q(g(c(Rc),null,null,512),[[Ce,c(t).currentSettingsTab==="update"]])])],512),[[Ce,c(t).showSettings]])],64))}});export{Zc as _,Qc as a};
