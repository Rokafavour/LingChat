import{d as C,c as n,F as y,f as x,g as t,a as m,t as v,_ as $,h as z,i as P,j as G,u as T,n as V,r as k,s as F,k as N,l as A,m as D,p as O,b as h,q as M,e as _,x as B,T as I}from"./index-BtkkAI57.js";import{_ as E}from"./StarField-pir-WA6x.js";import{_ as j,a as L}from"./SettingsPanel.vue_vue_type_style_index_0_lang-CwpE4Uvp.js";const q={class:"flex flex-col items-stretch w-87.5"},H=["onClick"],R=C({__name:"MainMenuOptions",emits:["start-game","open-settings","open-credits"],setup(l,{emit:d}){const e=d,a=[{label:"开始游戏",action:()=>e("start-game")},{label:"继续游戏",action:()=>e("open-settings","save")},{label:"设置",action:()=>e("open-settings")},{label:"致谢",action:()=>e("open-credits")},{label:"退出游戏",action:()=>window.close()}];return(r,u)=>(t(),n("nav",q,[(t(),n(y,null,x(a,s=>m("button",{key:s.label,class:"menu-item",onClick:s.action},v(s.label),9,H)),64))]))}}),U=$(R,[["__scopeId","data-v-cf9f2784"]]),J=async()=>{try{return await z.get("/v1/chat/script/list")}catch(l){throw console.error("获取剧本列表错误:",l.message),l}},K={class:"flex flex-col items-stretch w-[350px]"},Q=["disabled","onClick"],W=C({__name:"GameModeOptions",props:{scripts:{type:Array,default:[]},loadingScripts:{type:Boolean,default:!1}},emits:["back","open-scripts"],setup(l,{emit:d}){const e=d,a=l,r=T(),u=P(),s=()=>{u.exitStoryMode(),r.push("/chat")},p=async()=>{e("open-scripts")},g=G(()=>[{label:"自由对话模式",action:s},{label:"剧情模式",action:p,disabled:a.loadingScripts||a.scripts.length===0},{label:"小游戏",action:()=>{},disabled:!0},{label:"返回",action:()=>e("back")}]);return(b,f)=>(t(),n("nav",K,[(t(!0),n(y,null,x(g.value,o=>(t(),n("button",{key:o.label,class:V(["menu-item",{"menu-item--disabled":o.disabled}]),disabled:o.disabled,onClick:o.action},v(o.label),11,Q))),128))]))}}),X=$(W,[["__scopeId","data-v-98dd285d"]]),Y={class:"flex flex-col items-stretch w-87.5"},Z=["onClick"],ee={class:"pagination-controls"},te=["disabled"],se={class:"menu-item",style:{"font-size":"28px"}},ae=["disabled"],S=3,ne=C({__name:"ScriptModeOptions",props:{scripts:{type:Array,default:[]}},emits:["back"],setup(l,{emit:d}){const e=d,a=l,r=T(),u=P(),s=k(1),p=async o=>{await r.push("/chat");const c=`/开始剧本 ${o.script_name}`;u.enterStoryMode(o.script_name),F.sendMessage(c)},g=()=>{e("back")},b=G(()=>Math.ceil(a.scripts.length/S)),f=G(()=>{const o=(s.value-1)*S,c=o+S;return a.scripts.slice(o,c)});return(o,c)=>(t(),n("nav",Y,[(t(!0),n(y,null,x(f.value,(i,w)=>(t(),n("button",{key:i.script_name,class:"menu-item",onClick:de=>p(i)},v(i.script_name),9,Z))),128)),(t(!0),n(y,null,x(S-f.value.length,i=>(t(),n("button",{key:"placeholder-"+i,class:"menu-item menu-item--disabled",disabled:""},v(" ")))),128)),m("div",ee,[m("button",{class:"menu-item",disabled:s.value===1,onClick:c[0]||(c[0]=i=>s.value--)},"<",8,te),m("span",se,v(s.value)+" / "+v(b.value),1),m("button",{class:"menu-item",disabled:s.value===b.value,onClick:c[1]||(c[1]=i=>s.value++)}," > ",8,ae),m("button",{key:"back",class:"menu-item",onClick:g},"返回")])]))}}),oe=$(ne,[["__scopeId","data-v-1e48c00c"]]),ie={key:3,class:"main-menu-page__container"},ce={key:0,class:"main-menu-page__menu"},le={key:0,class:"main-menu-page__menu"},re={key:0,class:"main-menu-page__menu"},ue=C({__name:"MainMenu",setup(l){const d=T(),e=k("mainMenu"),a=k("main"),r=k([]),u=k(!1),s=N();function p(){a.value="gameMode"}function g(){d.push("/credit")}function b(){a.value="main"}function f(){a.value="scriptMode"}function o(i){s.toggleSettings(!0),i==="save"?(e.value="save",s.setSettingsTab("save")):e.value="settings"}A(()=>s.showSettings,i=>{!i&&(e.value==="settings"||e.value==="save")&&(e.value="mainMenu",a.value="main")}),D(async()=>{u.value=!0;try{r.value=await J()}catch{s.showError({errorCode:"script_list_failed",message:"获取剧本列表失败：请确认后端已启动"}),r.value=[]}finally{u.value=!1}});const c=L;return(i,w)=>(t(),n("div",{class:V(["main-menu-page",{"main-menu-page--panel-active":e.value!=="mainMenu"}])},[e.value==="gameMainView"?(t(),O(M(j),{key:0})):e.value==="settings"?(t(),O(M(L),{key:1})):e.value==="save"?(t(),O(M(c),{key:2})):h("",!0),e.value==="mainMenu"?(t(),n("div",ie,[_(I,{name:"slide-left"},{default:B(()=>[a.value==="main"?(t(),n("div",ce,[_(M(U),{onStartGame:p,onOpenSettings:o,onOpenCredits:g})])):h("",!0)]),_:1}),_(I,{name:"slide-right"},{default:B(()=>[a.value==="gameMode"?(t(),n("div",le,[_(M(X),{onBack:b,onOpenScripts:f,loadingScripts:u.value,scripts:r.value},null,8,["loadingScripts","scripts"])])):h("",!0)]),_:1}),_(I,{name:"slide-right"},{default:B(()=>[a.value==="scriptMode"?(t(),n("div",re,[_(oe,{onBack:p,scripts:r.value},null,8,["scripts"])])):h("",!0)]),_:1}),w[0]||(w[0]=m("img",{src:E,alt:"LingChatLogo",class:"main-menu-page__logo"},null,-1))])):h("",!0)],2))}}),ve=$(ue,[["__scopeId","data-v-abb18331"]]);export{ve as default};
